<!doctype html><html lang=en><head><script async defer data-website-id=08a754c4-6690-46d7-bb80-8ff93cfa232f src=https://umami.oldwinter.top/umami.js></script><meta charset=utf-8><meta name=description content="çº¢å®ä¹¦ç¬¬å››ç‰ˆ æ•°ç»„  array.keys() array.values() array.entries() array.fill(0) array.copyWithin() // æ‰¹é‡å¤åˆ¶ slice() concat() splice() every() filter() find() findIndex() forEach() indexOf() join() lastIndexOf() length map() reduce() reduceRight() reverse() some() sort() toLocaleString() toString()  Map api  get set has size delete  object å’Œ map  å†…å­˜å¤§å°  ç»™å®šå›ºå®šå¤§å°çš„å†…å­˜ï¼ŒMap å¤§çº¦å¯ä»¥æ¯” Object å¤šå­˜å‚¨ 50%çš„é”®/å€¼å¯¹ã€‚"><title>çº¢å®ä¹¦ç¬¬å››ç‰ˆ</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://note.xiaopang.fun//icon.png><link href=https://note.xiaopang.fun/styles.b3e1e36b0403ac565c9392b3e23ef3b6.min.css rel=stylesheet><link href=https://note.xiaopang.fun/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://note.xiaopang.fun/js/darkmode.660407930f154820c5998c99422c74bb.min.js></script>
<script src=https://note.xiaopang.fun/js/util.9825137f5e7825e8553c68ce39ac9e44.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script src=https://note.xiaopang.fun/js/popover.abe6a51cc7138c5dff00f151dd627ad1.min.js></script>
<script src=https://note.xiaopang.fun/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script>
<script src=https://note.xiaopang.fun/js/clipboard.c20857734e53a3fb733b7443879efa61.min.js></script>
<script src=https://note.xiaopang.fun/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const BASE_URL="https://note.xiaopang.fun/",fetchData=Promise.all([fetch("https://note.xiaopang.fun/indices/linkIndex.642f1fb3658247c9d3b5ef1ded7c18a0.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://note.xiaopang.fun/indices/contentIndex.7c09fb8b4c920981de846429d882ec58.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addCollapsibleCallouts(),initPopover("https://note.xiaopang.fun",!0,!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://note.xiaopang.fun",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!1})}</script><script>window.Million={navigate:e=>window.location.href=e,prefetch:()=>{}},window.addEventListener("DOMContentLoaded",()=>{init(),render()})</script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-11MD77L81V"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-11MD77L81V",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=search placeholder=æ”¯æŒæ ‡é¢˜åŠå…¨æ–‡æœç´¢...><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://note.xiaopang.fun/js/full-text-search.24827f874defbbc6d529926cbfcfb493.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://note.xiaopang.fun/>ğŸŒ¿æ•°å­—èŠ±å›­ğŸŒ¸</a></h1><div class=spacer></div><div id=search-icon><p>search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>çº¢å®ä¹¦ç¬¬å››ç‰ˆ</h1><p class=meta>æœ€è¿‘ç¼–è¾‘äº
Apr 7, 2023</p><ul class=tags></ul><aside class=mainTOC><details><summary>ç›®å½•</summary><nav id=TableOfContents><ol><li><a href=#æ•°ç»„>æ•°ç»„</a></li><li><a href=#map>Map</a><ol><li><a href=#api>api</a></li><li><a href=#object-å’Œ-map>object å’Œ map</a></li></ol></li><li><a href=#weakmap>WeakMap</a><ol><li><a href=#å¼±é”®>å¼±é”®</a></li></ol></li><li><a href=#set>Set</a></li><li><a href=#è¿­ä»£å™¨ä¸ç”Ÿæˆå™¨>è¿­ä»£å™¨ä¸ç”Ÿæˆå™¨</a><ol><li><a href=#è‡ªå®šä¹‰è¿­ä»£å™¨>è‡ªå®šä¹‰è¿­ä»£å™¨</a></li><li><a href=#generator>generator</a></li></ol></li><li><a href=#å¯¹è±¡>å¯¹è±¡</a><ol><li><a href=#å±æ€§çš„ç±»å‹>å±æ€§çš„ç±»å‹</a></li><li><a href=#api-1>API</a></li><li><a href=#åˆ›å»ºå¯¹è±¡>åˆ›å»ºå¯¹è±¡</a></li></ol></li><li><a href=#proxy>Proxy</a><ol><li></li></ol></li><li><a href=#å‡½æ•°>å‡½æ•°</a><ol><li><a href=#ç®­å¤´å‡½æ•°>ç®­å¤´å‡½æ•°</a></li><li><a href=#å‡½æ•°å£°æ˜å’Œå‡½æ•°è¡¨è¾¾å¼>å‡½æ•°å£°æ˜å’Œå‡½æ•°è¡¨è¾¾å¼</a></li><li><a href=#å‡½æ•°å†…éƒ¨>å‡½æ•°å†…éƒ¨</a></li><li><a href=#å‡½æ•°å±æ€§ä¸æ–¹æ³•>å‡½æ•°å±æ€§ä¸æ–¹æ³•</a></li><li><a href=#å°¾è°ƒç”¨ä¼˜åŒ–>å°¾è°ƒç”¨ä¼˜åŒ–</a></li><li><a href=#é—­åŒ…>é—­åŒ…</a></li></ol></li><li><a href=#promise>Promise</a><ol><li><a href=#promisesaè§„èŒƒ>Promises/A+è§„èŒƒ</a></li><li><a href=#promise-çŠ¶æ€æœº>promise çŠ¶æ€æœº</a></li><li><a href=#åŒæ­¥å¼‚æ­¥æ‰§è¡Œçš„äºŒå…ƒæ€§>åŒæ­¥/å¼‚æ­¥æ‰§è¡Œçš„äºŒå…ƒæ€§</a></li><li><a href=#æ‹’ç»-promise-ä¸æ‹’ç»é”™è¯¯å¤„ç†>æ‹’ç» Promise ä¸æ‹’ç»é”™è¯¯å¤„ç†</a></li><li><a href=#promise-å–æ¶ˆ>Promise å–æ¶ˆ</a></li><li><a href=#promise-è¿›åº¦é€šçŸ¥>Promise è¿›åº¦é€šçŸ¥</a></li></ol></li><li><a href=#asyncawait>async/await</a><ol><li><a href=#æŠ›å‡ºé”™è¯¯>æŠ›å‡ºé”™è¯¯</a></li><li><a href=#å¼‚æ­¥ç­–ç•¥>å¼‚æ­¥ç­–ç•¥</a></li></ol></li><li><a href=#bom>BOM</a><ol><li><a href=#window-å¯¹è±¡>Window å¯¹è±¡</a></li><li><a href=#location-å¯¹è±¡>location å¯¹è±¡</a></li><li><a href=#navigator-å¯¹è±¡>navigator å¯¹è±¡</a></li><li><a href=#screen-å¯¹è±¡>screen å¯¹è±¡</a></li><li><a href=#history-å¯¹è±¡>history å¯¹è±¡</a></li></ol></li><li><a href=#å®¢æˆ·ç«¯æ£€æµ‹>å®¢æˆ·ç«¯æ£€æµ‹</a><ol><li><a href=#æµè§ˆå™¨æ£€æµ‹>æµè§ˆå™¨æ£€æµ‹</a></li><li><a href=#ç½‘ç»œæ£€æµ‹>ç½‘ç»œæ£€æµ‹</a></li><li><a href=#ç”µæ± æ£€æµ‹>ç”µæ± æ£€æµ‹</a></li><li><a href=#ç¡¬ä»¶æ£€æµ‹>ç¡¬ä»¶æ£€æµ‹</a></li></ol></li><li><a href=#dom>DOM</a><ol><li><a href=#æ“çºµèŠ‚ç‚¹>æ“çºµèŠ‚ç‚¹</a></li><li><a href=#documentfragment-ç±»å‹>DocumentFragment ç±»å‹</a></li><li><a href=#åŠ¨æ€è„šæœ¬>åŠ¨æ€è„šæœ¬</a></li><li><a href=#åŠ¨æ€-css>åŠ¨æ€ css</a></li><li><a href=#mutationobserver-æ¥å£>MutationObserver æ¥å£</a></li><li><a href=#dom2>DOM2</a></li><li><a href=#dom3>DOM3</a></li></ol></li><li><a href=#äº‹ä»¶>äº‹ä»¶</a><ol><li><a href=#äº‹ä»¶å†’æ³¡>äº‹ä»¶å†’æ³¡</a></li><li><a href=#äº‹ä»¶æ•è·>äº‹ä»¶æ•è·</a></li><li><a href=#dom-äº‹ä»¶æµ>DOM äº‹ä»¶æµ</a></li><li><a href=#dom2-äº‹ä»¶å¤„ç†ç¨‹åº>DOM2 äº‹ä»¶å¤„ç†ç¨‹åº</a></li><li><a href=#äº‹ä»¶ç±»å‹>äº‹ä»¶ç±»å‹</a></li><li><a href=#äº‹ä»¶å§”æ‰˜>äº‹ä»¶å§”æ‰˜</a></li></ol></li><li><a href=#åŠ¨ç”»ä¸-canvas-å›¾å½¢>åŠ¨ç”»ä¸ Canvas å›¾å½¢</a><ol><li><a href=#requestanimationframe>requestAnimationFrame</a></li><li><a href=#canvas>Canvas</a></li><li><a href=#webgl>WebGL</a></li></ol></li><li><a href=#javascript-api>JavaScript API</a><ol><li><a href=#streams-api>Streams API</a></li><li><a href=#performance-timeline-api>Performance Timeline API</a></li><li><a href=#web-ç»„ä»¶>Web ç»„ä»¶</a></li><li><a href=#web-cryptography-api>Web Cryptography API</a></li><li><a href=#å°ç»“>å°ç»“</a></li></ol></li><li><a href=#é”™è¯¯å¤„ç†å’Œè°ƒè¯•>é”™è¯¯å¤„ç†å’Œè°ƒè¯•</a><ol><li><a href=#trycatch>try/catch</a></li><li><a href=#æŠ›å‡ºé”™è¯¯-1>æŠ›å‡ºé”™è¯¯</a></li><li><a href=#error-äº‹ä»¶>error äº‹ä»¶</a></li><li><a href=#è¯†åˆ«é”™è¯¯>è¯†åˆ«é”™è¯¯</a></li></ol></li><li><a href=#json>JSON</a><ol><li><a href=#json-å¯¹è±¡>JSON å¯¹è±¡</a></li></ol></li><li><a href=#ç½‘ç»œè¯·æ±‚ä¸è¿œç¨‹èµ„æº>ç½‘ç»œè¯·æ±‚ä¸è¿œç¨‹èµ„æº</a><ol><li><a href=#xhr--xmlhttprequest--å¯¹è±¡>XHR ( XMLHttpRequest ) å¯¹è±¡</a></li><li><a href=#è¿›åº¦äº‹ä»¶>è¿›åº¦äº‹ä»¶</a></li><li><a href=#è·¨æºèµ„æºå…±äº«>è·¨æºèµ„æºå…±äº«</a></li><li><a href=#fetch-è¯·æ±‚>fetch è¯·æ±‚</a></li><li><a href=#beacon-api>Beacon API</a></li><li><a href=#web-socket>Web Socket</a></li></ol></li><li><a href=#å®¢æˆ·ç«¯å­˜å‚¨>å®¢æˆ·ç«¯å­˜å‚¨</a><ol><li><a href=#cookie>cookie</a></li><li><a href=#sessionstorage>sessionStorage</a></li><li><a href=#localstorage>localStorage</a></li><li><a href=#indexdb>indexDB</a></li></ol></li><li><a href=#æ¨¡å—>æ¨¡å—</a><ol><li><a href=#å‡‘åˆçš„æ¨¡å—ç³»ç»Ÿ-iife>å‡‘åˆçš„æ¨¡å—ç³»ç»Ÿ-IIFE</a></li><li><a href=#es6-ä¹‹å‰çš„æ¨¡å—ç³»ç»Ÿ>ES6 ä¹‹å‰çš„æ¨¡å—ç³»ç»Ÿ</a></li><li><a href=#es6-æ¨¡å—>ES6 æ¨¡å—</a></li></ol></li><li><a href=#web-worker>Web Worker</a><ol><li><a href=#ç®€ä»‹>ç®€ä»‹</a></li><li><a href=#ä½¿ç”¨-2>ä½¿ç”¨</a></li></ol></li><li><a href=#æœ€ä½³å®è·µ>æœ€ä½³å®è·µ</a><ol><li><a href=#ç¼–ç è§„èŒƒ>ç¼–ç è§„èŒƒ</a></li><li><a href=#æ€§èƒ½>æ€§èƒ½</a></li><li><a href=#éƒ¨ç½²>éƒ¨ç½²</a></li></ol></li><li><a href=#es2019>ES2019</a></li></ol></nav></details></aside><a href=#çº¢å®ä¹¦ç¬¬å››ç‰ˆ><h1 id=çº¢å®ä¹¦ç¬¬å››ç‰ˆ><span class=hanchor arialabel=Anchor># </span>çº¢å®ä¹¦ç¬¬å››ç‰ˆ</h1></a><a href=#æ•°ç»„><h2 id=æ•°ç»„><span class=hanchor arialabel=Anchor># </span>æ•°ç»„</h2></a><ul><li>array.keys()</li><li>array.values()</li><li>array.entries()</li><li>array.fill(0)</li><li>array.copyWithin() // æ‰¹é‡å¤åˆ¶</li><li>slice()</li><li>concat()</li><li>splice()</li><li>every()</li><li>filter()</li><li>find()</li><li>findIndex()</li><li>forEach()</li><li>indexOf()</li><li>join()</li><li>lastIndexOf()</li><li>length</li><li>map()</li><li>reduce()</li><li>reduceRight()</li><li>reverse()</li><li>some()</li><li>sort()</li><li>toLocaleString()</li><li>toString()</li></ul><a href=#map><h2 id=map><span class=hanchor arialabel=Anchor># </span>Map</h2></a><a href=#api><h3 id=api><span class=hanchor arialabel=Anchor># </span>api</h3></a><ul><li>get</li><li>set</li><li>has</li><li>size</li><li>delete</li></ul><a href=#object-å’Œ-map><h3 id=object-å’Œ-map><span class=hanchor arialabel=Anchor># </span>object å’Œ map</h3></a><ul><li>å†…å­˜å¤§å°</li></ul><p>ç»™å®šå›ºå®šå¤§å°çš„å†…å­˜ï¼ŒMap å¤§çº¦å¯ä»¥æ¯” Object å¤šå­˜å‚¨ 50%çš„é”®/å€¼å¯¹ã€‚</p><ul><li>æ’å…¥æ€§èƒ½</li></ul><p>Map ç¨å¿«</p><ul><li>æŸ¥æ‰¾é€Ÿåº¦</li></ul><p>Object ç¨å¿«</p><ul><li>åˆ é™¤æ€§èƒ½</li></ul><p>object çš„ delete ä¸€ç›´å€¼å¾—è¯Ÿç—…ï¼Œæ‰€ä»¥ map å®Œèƒœ</p><a href=#weakmap><h2 id=weakmap><span class=hanchor arialabel=Anchor># </span>WeakMap</h2></a><p>å¼±æ˜ å°„ä¸­çš„é”®åªèƒ½æ˜¯ Object æˆ–è€…ç»§æ‰¿è‡ª Object çš„ç±»å‹ï¼Œå°è¯•ä½¿ç”¨éå¯¹è±¡è®¾ç½®é”®ä¼šæŠ›å‡º TypeErrorã€‚å€¼çš„ç±»å‹æ²¡æœ‰é™åˆ¶ã€‚</p><a href=#å¼±é”®><h3 id=å¼±é”®><span class=hanchor arialabel=Anchor># </span>å¼±é”®</h3></a><p>WeakMap ä¸­â€œweakâ€è¡¨ç¤ºå¼±æ˜ å°„çš„é”®æ˜¯â€œå¼±å¼±åœ°æ‹¿ç€â€çš„ã€‚æ„æ€å°±æ˜¯ï¼Œè¿™äº›é”®ä¸å±äºæ­£å¼çš„å¼•ç”¨ï¼Œ ä¸ä¼šé˜»æ­¢åƒåœ¾å›æ”¶ã€‚ä½†è¦æ³¨æ„çš„æ˜¯ï¼Œå¼±æ˜ å°„ä¸­å€¼çš„å¼•ç”¨å¯ä¸æ˜¯â€œå¼±å¼±åœ°æ‹¿ç€â€çš„ã€‚<strong>åªè¦é”®å­˜åœ¨ï¼Œé”®/å€¼ å¯¹å°±ä¼šå­˜åœ¨äºæ˜ å°„ä¸­</strong>ï¼Œå¹¶è¢«å½“ä½œå¯¹å€¼çš„å¼•ç”¨ï¼Œå› æ­¤å°±ä¸ä¼šè¢«å½“ä½œåƒåœ¾å›æ”¶ã€‚</p><p>å¯ä»¥ç”¨æ¥åˆ›å»ºä¸€äº› <strong>ç§æœ‰å˜é‡</strong></p><a href=#set><h2 id=set><span class=hanchor arialabel=Anchor># </span>Set</h2></a><p>æ·»åŠ å…ƒç´  set.add()</p><p>å…¶ä»–éƒ½å’Œ mapï¼Œweakmap ç±»ä¼¼</p><a href=#è¿­ä»£å™¨ä¸ç”Ÿæˆå™¨><h2 id=è¿­ä»£å™¨ä¸ç”Ÿæˆå™¨><span class=hanchor arialabel=Anchor># </span>è¿­ä»£å™¨ä¸ç”Ÿæˆå™¨</h2></a><p><strong>è¿­ä»£å™¨æ¨¡å¼</strong>ï¼ˆç‰¹åˆ«æ˜¯åœ¨ ECMAScript è¿™ä¸ªè¯­å¢ƒä¸‹ï¼‰æè¿°äº†ä¸€ä¸ªæ–¹æ¡ˆï¼Œå³å¯ä»¥æŠŠæœ‰äº›ç»“æ„ç§°ä¸ºâ€œå¯è¿­ä»£å¯¹è±¡â€ï¼ˆiterableï¼‰ï¼Œå› ä¸ºå®ƒä»¬å®ç°äº†æ­£å¼çš„ Iterable æ¥å£ï¼Œè€Œä¸”å¯ä»¥é€šè¿‡è¿­ä»£å™¨ <code>Iterator</code>æ¶ˆè´¹</p><p>å¾ˆå¤šå†…ç½®ç±»å‹éƒ½å®ç°äº† Iterable æ¥å£ï¼š</p><ul><li>å­—ç¬¦ä¸²</li><li>æ•°ç»„</li><li>æ˜ å°„</li><li>é›†åˆ</li><li>arguments å¯¹è±¡</li><li>NodeList ç­‰ DOM é›†åˆç±»å‹</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=c1>// è¿™ä¸¤ç§ç±»å‹æ²¡æœ‰å®ç°è¿­ä»£å™¨å·¥å‚å‡½æ•°
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>num</span><span class=p>[</span><span class=nx>Symbol</span><span class=p>.</span><span class=nx>iterator</span><span class=p>]);</span> <span class=c1>// undefined
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>obj</span><span class=p>[</span><span class=nx>Symbol</span><span class=p>.</span><span class=nx>iterator</span><span class=p>]);</span> <span class=c1>// undefined
</span></span></span></code></pre></td></tr></table></div></div><a href=#è‡ªå®šä¹‰è¿­ä»£å™¨><h3 id=è‡ªå®šä¹‰è¿­ä»£å™¨><span class=hanchor arialabel=Anchor># </span>è‡ªå®šä¹‰è¿­ä»£å™¨</h3></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kr>class</span> <span class=nx>Counter</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>constructor</span><span class=p>(</span><span class=nx>limit</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>limit</span> <span class=o>=</span> <span class=nx>limit</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=nx>Symbol</span><span class=p>.</span><span class=nx>iterator</span><span class=p>]()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>let</span> <span class=nx>count</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>limit</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>limit</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>next</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>count</span> <span class=o>&lt;=</span> <span class=nx>limit</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=k>return</span> <span class=p>{</span> <span class=nx>done</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span> <span class=nx>value</span><span class=o>:</span> <span class=nx>count</span><span class=o>++</span> <span class=p>};</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=k>return</span> <span class=p>{</span> <span class=nx>done</span><span class=o>:</span> <span class=kc>true</span> <span class=p>};</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Exiting early&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span> <span class=nx>done</span><span class=o>:</span> <span class=kc>true</span> <span class=p>};</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><a href=#generator><h3 id=generator><span class=hanchor arialabel=Anchor># </span>generator</h3></a><p>generator å°±æ˜¯ä¸€ä¸ªå®ç°äº† Iterator æ¥å£çš„å‡½æ•°ï¼Œå› æ­¤å…·æœ‰ next æ–¹æ³•</p><a href=#yield-ä¸­æ–­æ‰§è¡Œ><h4 id=yield-ä¸­æ–­æ‰§è¡Œ><span class=hanchor arialabel=Anchor># </span>yield ä¸­æ–­æ‰§è¡Œ</h4></a><p>yield å…³é”®å­—å¯ä»¥è®©ç”Ÿæˆå™¨åœæ­¢å’Œå¼€å§‹æ‰§è¡Œï¼Œä¹Ÿæ˜¯ç”Ÿæˆå™¨æœ€æœ‰ç”¨çš„åœ°æ–¹ã€‚</p><a href=#ä½¿ç”¨-yield-å®ç°è¾“å…¥å’Œè¾“å‡º><h4 id=ä½¿ç”¨-yield-å®ç°è¾“å…¥å’Œè¾“å‡º><span class=hanchor arialabel=Anchor># </span>ä½¿ç”¨ yield å®ç°è¾“å…¥å’Œè¾“å‡º</h4></a><p>é™¤äº†å¯ä»¥ä½œä¸ºå‡½æ•°çš„ä¸­é—´è¿”å›è¯­å¥ä½¿ç”¨ï¼Œyield å…³é”®å­—è¿˜å¯ä»¥ä½œä¸ºå‡½æ•°çš„ä¸­é—´å‚æ•°ä½¿ç”¨ã€‚ä¸Šä¸€æ¬¡è®© ç”Ÿæˆå™¨å‡½æ•°æš‚åœçš„ yield å…³é”®å­—ä¼šæ¥æ”¶åˆ°ä¼ ç»™ next()æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå€¼ã€‚</p><a href=#throw><h4 id=throw><span class=hanchor arialabel=Anchor># </span>throw</h4></a><a href=#å¯¹è±¡><h2 id=å¯¹è±¡><span class=hanchor arialabel=Anchor># </span>å¯¹è±¡</h2></a><a href=#å±æ€§çš„ç±»å‹><h3 id=å±æ€§çš„ç±»å‹><span class=hanchor arialabel=Anchor># </span>å±æ€§çš„ç±»å‹</h3></a><ul><li><a class="internal-link broken">Configurable</a>ï¼šè¡¨ç¤ºå±æ€§æ˜¯å¦å¯ä»¥é€šè¿‡ delete åˆ é™¤å¹¶é‡æ–°å®šä¹‰ï¼Œæ˜¯å¦å¯ä»¥ä¿®æ”¹å®ƒçš„ç‰¹æ€§ï¼Œä»¥åŠæ˜¯å¦å¯ä»¥æŠŠå®ƒæ”¹ä¸ºè®¿é—®å™¨å±æ€§ã€‚é»˜è®¤ä¸º trueï¼Œ</li><li><a class="internal-link broken">Enumerable</a>ï¼šè¡¨ç¤ºå±æ€§æ˜¯å¦å¯ä»¥é€šè¿‡ for-in å¾ªç¯è¿”å›ã€‚é»˜è®¤ä¸º trueï¼Œ</li><li><a class="internal-link broken">Writable</a>ï¼šè¡¨ç¤ºå±æ€§çš„å€¼æ˜¯å¦å¯ä»¥è¢«ä¿®æ”¹ã€‚é»˜è®¤ä¸º trueï¼Œ</li><li><a class="internal-link broken">Value</a>ï¼šåŒ…å«å±æ€§å®é™…çš„å€¼ã€‚è¿™å°±æ˜¯å‰é¢æåˆ°çš„é‚£ä¸ªè¯»å–å’Œå†™å…¥å±æ€§å€¼çš„ä½ç½®ã€‚è¿™ä¸ªç‰¹æ€§ çš„é»˜è®¤å€¼ä¸º undefinedã€‚</li></ul><a href=#api-1><h3 id=api-1><span class=hanchor arialabel=Anchor># </span>API</h3></a><ul><li>Object.getOwnPropertyDescriptors() ï¼šä¼šåœ¨æ¯ä¸ªè‡ªæœ‰å±æ€§ä¸Šè°ƒç”¨ Object.getOwnPropertyDescriptor()å¹¶åœ¨ä¸€ä¸ªæ–°å¯¹è±¡ä¸­è¿”å›å®ƒä»¬</li><li>Object.assign()ï¼šå°†æ¯ä¸ªæºå¯¹è±¡ä¸­å¯æšä¸¾ï¼ˆObject.propertyIsEnumerable()è¿”å› trueï¼‰ å’Œè‡ªæœ‰ï¼ˆObject.hasOwnProperty()è¿”å› trueï¼‰å±æ€§å¤åˆ¶åˆ°ç›®æ ‡å¯¹è±¡ã€‚å¯¹æ¯ä¸ªç¬¦åˆæ¡ä»¶çš„å±æ€§ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šä½¿ç”¨æºå¯¹è±¡ä¸Šçš„<a class="internal-link broken">Get</a>å–å¾—å±æ€§çš„å€¼ï¼Œç„¶åä½¿ç”¨ç›®æ ‡ å¯¹è±¡ä¸Šçš„<a class="internal-link broken">Set</a>è®¾ç½®å±æ€§çš„å€¼ã€‚</li><li>Object.is() æ­£ç¡®çš„ -0,0ï¼Œ+0 å’Œ NaN åˆ¤æ–­</li></ul><a href=#åˆ›å»ºå¯¹è±¡><h3 id=åˆ›å»ºå¯¹è±¡><span class=hanchor arialabel=Anchor># </span>åˆ›å»ºå¯¹è±¡</h3></a><a href=#å·¥å‚æ¨¡å¼><h4 id=å·¥å‚æ¨¡å¼><span class=hanchor arialabel=Anchor># </span>å·¥å‚æ¨¡å¼</h4></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>createPerson</span><span class=p>(</span><span class=nx>name</span><span class=p>,</span> <span class=nx>age</span><span class=p>,</span> <span class=nx>job</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=kd>let</span> <span class=nx>o</span> <span class=o>=</span> <span class=k>new</span> <span class=nb>Object</span><span class=p>();</span>
</span></span><span class=line><span class=cl> <span class=nx>o</span><span class=p>.</span><span class=nx>name</span> <span class=o>=</span> <span class=nx>name</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=nx>o</span><span class=p>.</span><span class=nx>age</span> <span class=o>=</span> <span class=nx>age</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=nx>o</span><span class=p>.</span><span class=nx>job</span> <span class=o>=</span> <span class=nx>job</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=nx>o</span><span class=p>.</span><span class=nx>sayName</span> <span class=o>=</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>name</span><span class=p>);</span>
</span></span><span class=line><span class=cl> <span class=p>};</span>
</span></span><span class=line><span class=cl> <span class=k>return</span> <span class=nx>o</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nx>person1</span> <span class=o>=</span> <span class=nx>createPerson</span><span class=p>(</span><span class=s2>&#34;Nicholas&#34;</span><span class=p>,</span> <span class=mi>29</span><span class=p>,</span> <span class=s2>&#34;Software Engineer&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nx>person2</span> <span class=o>=</span> <span class=nx>createPerson</span><span class=p>(</span><span class=s2>&#34;Greg&#34;</span><span class=p>,</span> <span class=mi>27</span><span class=p>,</span> <span class=s2>&#34;Doctor&#34;</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><a href=#æ„é€ å‡½æ•°æ¨¡å¼><h4 id=æ„é€ å‡½æ•°æ¨¡å¼><span class=hanchor arialabel=Anchor># </span>æ„é€ å‡½æ•°æ¨¡å¼</h4></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>Person</span><span class=p>(</span><span class=nx>name</span><span class=p>,</span> <span class=nx>age</span><span class=p>,</span> <span class=nx>job</span><span class=p>){</span>
</span></span><span class=line><span class=cl> <span class=k>this</span><span class=p>.</span><span class=nx>name</span> <span class=o>=</span> <span class=nx>name</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=k>this</span><span class=p>.</span><span class=nx>age</span> <span class=o>=</span> <span class=nx>age</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=k>this</span><span class=p>.</span><span class=nx>job</span> <span class=o>=</span> <span class=nx>job</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=k>this</span><span class=p>.</span><span class=nx>sayName</span> <span class=o>=</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>name</span><span class=p>);</span>
</span></span><span class=line><span class=cl> <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nx>person1</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Person</span><span class=p>(</span><span class=s2>&#34;Nicholas&#34;</span><span class=p>,</span> <span class=mi>29</span><span class=p>,</span> <span class=s2>&#34;Software Engineer&#34;</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>Person()æ„é€ å‡½æ•°ä»£æ›¿äº† createPerson()å·¥å‚å‡½æ•°ã€‚</p><p>ä½†æ˜¯æœ‰ä»¥ä¸‹åŒºåˆ«ï¼š</p><ul><li>æ²¡æœ‰æ˜¾æ€§åˆ›é€ å¯¹è±¡</li><li>å±æ€§å’Œæ–¹æ³•ç›´æ¥èµ‹å€¼ç»™äº† thisã€‚</li><li>æ²¡æœ‰ returnã€‚</li></ul><p>new çš„æ“ä½œè¿‡ç¨‹ï¼š</p><ul><li>(1)åœ¨å†…å­˜ä¸­åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ã€‚</li><li>(2) è¿™ä¸ªæ–°å¯¹è±¡å†…éƒ¨çš„<a class="internal-link broken">Prototype</a>ç‰¹æ€§è¢«èµ‹å€¼ä¸ºæ„é€ å‡½æ•°çš„ prototype å±æ€§ã€‚</li><li>(3) æ„é€ å‡½æ•°å†…éƒ¨çš„ this è¢«èµ‹å€¼ä¸ºè¿™ä¸ªæ–°å¯¹è±¡ï¼ˆå³ this æŒ‡å‘æ–°å¯¹è±¡ï¼‰ã€‚</li><li>(4) æ‰§è¡Œæ„é€ å‡½æ•°å†…éƒ¨çš„ä»£ç ï¼ˆç»™æ–°å¯¹è±¡æ·»åŠ å±æ€§ï¼‰ã€‚</li><li>(5) å¦‚æœæ„é€ å‡½æ•°è¿”å›éç©ºå¯¹è±¡ï¼Œåˆ™è¿”å›è¯¥å¯¹è±¡ï¼›å¦åˆ™ï¼Œè¿”å›åˆšåˆ›å»ºçš„æ–°å¯¹è±¡ã€‚</li></ul><p>ç¼ºç‚¹ï¼šæ¯ä¸€ä¸ªæ„é€ å‡½æ•° éƒ½ä¼šé‡æ–°åˆ›é€ ä¸€ä¸ª sayName æ–¹æ³•ï¼Œ</p><a href=#åŸå‹æ¨¡å¼><h4 id=åŸå‹æ¨¡å¼><span class=hanchor arialabel=Anchor># </span>åŸå‹æ¨¡å¼</h4></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>Person</span> <span class=p>()</span> <span class=p>{</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=nx>Person</span><span class=p>.</span><span class=nx>prototype</span><span class=p>.</span><span class=nx>name</span> <span class=o>=</span> <span class=s2>&#34;Nicholas&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nx>Person</span><span class=p>.</span><span class=nx>prototype</span><span class=p>.</span><span class=nx>age</span> <span class=o>=</span> <span class=mi>29</span>
</span></span><span class=line><span class=cl>  <span class=nx>Person</span><span class=p>.</span><span class=nx>prototype</span><span class=p>.</span><span class=nx>job</span> <span class=o>=</span> <span class=s2>&#34;Software Engineer&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nx>Person</span><span class=p>.</span><span class=nx>prototype</span><span class=p>.</span><span class=nx>sayName</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>name</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><p>ç¼ºç‚¹ï¼šè™½ç„¶åŸå‹æ¨¡å¼å°†æ–¹æ³•å…¬ç”¨äº†ï¼Œä½†æ˜¯åŒæ—¶ä¹Ÿå°†å±æ€§å…±ç”¨ï¼Œè¿™ä¼šå¯¼è‡´å±æ€§æ··ä¹±ï¼Œ</p><a href=#ç»„åˆç»§æ‰¿><h4 id=ç»„åˆç»§æ‰¿><span class=hanchor arialabel=Anchor># </span>ç»„åˆç»§æ‰¿</h4></a><p><strong>ç»„åˆç»§æ‰¿</strong>ï¼ˆæœ‰æ—¶å€™ä¹Ÿå«ä¼ªç»å…¸ç»§æ‰¿ï¼‰ç»¼åˆäº†åŸå‹é“¾å’Œç›—ç”¨æ„é€ å‡½æ•°ï¼Œå°†ä¸¤è€…çš„ä¼˜ç‚¹é›†ä¸­äº†èµ·æ¥ã€‚åŸº æœ¬çš„æ€è·¯æ˜¯ä½¿ç”¨åŸå‹é“¾ç»§æ‰¿åŸå‹ä¸Šçš„å±æ€§å’Œæ–¹æ³•ï¼Œè€Œé€šè¿‡ç›—ç”¨æ„é€ å‡½æ•°ç»§æ‰¿å®ä¾‹å±æ€§ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>SuperType</span><span class=p>(</span><span class=nx>name</span><span class=p>){</span>
</span></span><span class=line><span class=cl> <span class=k>this</span><span class=p>.</span><span class=nx>name</span> <span class=o>=</span> <span class=nx>name</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=k>this</span><span class=p>.</span><span class=nx>colors</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;red&#34;</span><span class=p>,</span> <span class=s2>&#34;blue&#34;</span><span class=p>,</span> <span class=s2>&#34;green&#34;</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>SuperType</span><span class=p>.</span><span class=nx>prototype</span><span class=p>.</span><span class=nx>sayName</span> <span class=o>=</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>name</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>SubType</span><span class=p>(</span><span class=nx>name</span><span class=p>,</span> <span class=nx>age</span><span class=p>){</span>
</span></span><span class=line><span class=cl> <span class=c1>// ç»§æ‰¿å±æ€§
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=nx>SuperType</span><span class=p>.</span><span class=nx>call</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=nx>name</span><span class=p>);</span>  <span class=c1>// ç¬¬äºŒæ¬¡è°ƒç”¨
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=k>this</span><span class=p>.</span><span class=nx>age</span> <span class=o>=</span> <span class=nx>age</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// ç»§æ‰¿æ–¹æ³•
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>SubType</span><span class=p>.</span><span class=nx>prototype</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>SuperType</span><span class=p>();</span> <span class=c1>// ç¬¬ä¸€æ¬¡è°ƒç”¨
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>SubType</span><span class=p>.</span><span class=nx>prototype</span><span class=p>.</span><span class=nx>sayAge</span> <span class=o>=</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>age</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nx>instance1</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>SubType</span><span class=p>(</span><span class=s2>&#34;Nicholas&#34;</span><span class=p>,</span> <span class=mi>29</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>instance1</span><span class=p>.</span><span class=nx>colors</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=s2>&#34;black&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>instance1</span><span class=p>.</span><span class=nx>colors</span><span class=p>);</span> <span class=c1>// &#34;red,blue,green,black&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>instance1</span><span class=p>.</span><span class=nx>sayName</span><span class=p>();</span> <span class=c1>// &#34;Nicholas&#34;;
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>instance1</span><span class=p>.</span><span class=nx>sayAge</span><span class=p>();</span> <span class=c1>// 29
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nx>instance2</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>SubType</span><span class=p>(</span><span class=s2>&#34;Greg&#34;</span><span class=p>,</span> <span class=mi>27</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>instance2</span><span class=p>.</span><span class=nx>colors</span><span class=p>);</span> <span class=c1>// &#34;red,blue,green&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>instance2</span><span class=p>.</span><span class=nx>sayName</span><span class=p>();</span> <span class=c1>// &#34;Greg&#34;;
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>instance2</span><span class=p>.</span><span class=nx>sayAge</span><span class=p>();</span> <span class=c1>// 27
</span></span></span></code></pre></td></tr></table></div></div><a href=#åŸå‹å¼ç»§æ‰¿><h4 id=åŸå‹å¼ç»§æ‰¿><span class=hanchor arialabel=Anchor># </span>åŸå‹å¼ç»§æ‰¿</h4></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>object</span><span class=p>(</span><span class=nx>o</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=kd>function</span> <span class=nx>F</span><span class=p>()</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl> <span class=nx>F</span><span class=p>.</span><span class=nx>prototype</span> <span class=o>=</span> <span class=nx>o</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=k>return</span> <span class=k>new</span> <span class=nx>F</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>åŸå‹å¼ç»§æ‰¿éå¸¸é€‚åˆä¸éœ€è¦å•ç‹¬åˆ›å»ºæ„é€ å‡½æ•°ï¼Œä½†ä»ç„¶éœ€è¦åœ¨å¯¹è±¡é—´å…±äº«ä¿¡æ¯çš„åœºåˆã€‚ä½†è¦è®°ä½ï¼Œ å±æ€§ä¸­åŒ…å«çš„å¼•ç”¨å€¼å§‹ç»ˆä¼šåœ¨ç›¸å…³å¯¹è±¡é—´å…±äº«ï¼Œè·Ÿä½¿ç”¨åŸå‹æ¨¡å¼æ˜¯ä¸€æ ·çš„ã€‚</p><a href=#å¯„ç”Ÿå¼ç»§æ‰¿><h4 id=å¯„ç”Ÿå¼ç»§æ‰¿><span class=hanchor arialabel=Anchor># </span>å¯„ç”Ÿå¼ç»§æ‰¿</h4></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>createAnother</span><span class=p>(</span><span class=nx>original</span><span class=p>){</span>
</span></span><span class=line><span class=cl> <span class=kd>let</span> <span class=nx>clone</span> <span class=o>=</span> <span class=nx>object</span><span class=p>(</span><span class=nx>original</span><span class=p>);</span> <span class=c1>// é€šè¿‡è°ƒç”¨å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=nx>clone</span><span class=p>.</span><span class=nx>sayHi</span> <span class=o>=</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span> <span class=c1>// ä»¥æŸç§æ–¹å¼å¢å¼ºè¿™ä¸ªå¯¹è±¡
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;hi&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl> <span class=p>};</span>
</span></span><span class=line><span class=cl> <span class=k>return</span> <span class=nx>clone</span><span class=p>;</span> <span class=c1>// è¿”å›è¿™ä¸ªå¯¹è±¡
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>å¯„ç”Ÿå¼ç»§æ‰¿åŒæ ·é€‚åˆä¸»è¦å…³æ³¨å¯¹è±¡ï¼Œè€Œä¸åœ¨ä¹ç±»å‹å’Œæ„é€ å‡½æ•°çš„åœºæ™¯ã€‚object()å‡½æ•°ä¸æ˜¯å¯„ç”Ÿå¼ ç»§æ‰¿æ‰€å¿…éœ€çš„ï¼Œä»»ä½•è¿”å›æ–°å¯¹è±¡çš„å‡½æ•°éƒ½å¯ä»¥åœ¨è¿™é‡Œä½¿ç”¨</p><a href=#å¯„ç”Ÿå¼ç»„åˆç»§æ‰¿><h4 id=å¯„ç”Ÿå¼ç»„åˆç»§æ‰¿><span class=hanchor arialabel=Anchor># </span>å¯„ç”Ÿå¼ç»„åˆç»§æ‰¿</h4></a><p>ç»„åˆç»§æ‰¿å…¶å®ä¹Ÿå­˜åœ¨æ•ˆç‡é—®é¢˜ã€‚æœ€ä¸»è¦çš„æ•ˆç‡é—®é¢˜å°±æ˜¯çˆ¶ç±»æ„é€ å‡½æ•°å§‹ç»ˆä¼šè¢«è°ƒç”¨ä¸¤æ¬¡ï¼šä¸€æ¬¡åœ¨æ˜¯ åˆ›å»ºå­ç±»åŸå‹æ—¶è°ƒç”¨ï¼Œå¦ä¸€æ¬¡æ˜¯åœ¨å­ç±»æ„é€ å‡½æ•°ä¸­è°ƒç”¨ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>inheritPrototype</span><span class=p>(</span><span class=nx>subType</span><span class=p>,</span> <span class=nx>superType</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=kd>let</span> <span class=nx>prototype</span> <span class=o>=</span> <span class=nx>object</span><span class=p>(</span><span class=nx>superType</span><span class=p>.</span><span class=nx>prototype</span><span class=p>);</span> <span class=c1>// åˆ›å»ºå¯¹è±¡
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=nx>prototype</span><span class=p>.</span><span class=nx>constructor</span> <span class=o>=</span> <span class=nx>subType</span><span class=p>;</span> <span class=c1>// å¢å¼ºå¯¹è±¡
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=nx>subType</span><span class=p>.</span><span class=nx>prototype</span> <span class=o>=</span> <span class=nx>prototype</span><span class=p>;</span> <span class=c1>// èµ‹å€¼å¯¹è±¡
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ä½¿ç”¨</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>SuperType</span><span class=p>(</span><span class=nx>name</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=k>this</span><span class=p>.</span><span class=nx>name</span> <span class=o>=</span> <span class=nx>name</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=k>this</span><span class=p>.</span><span class=nx>colors</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;red&#34;</span><span class=p>,</span> <span class=s2>&#34;blue&#34;</span><span class=p>,</span> <span class=s2>&#34;green&#34;</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>SuperType</span><span class=p>.</span><span class=nx>prototype</span><span class=p>.</span><span class=nx>sayName</span> <span class=o>=</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>name</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>SubType</span><span class=p>(</span><span class=nx>name</span><span class=p>,</span> <span class=nx>age</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>SuperType</span><span class=p>.</span><span class=nx>call</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=nx>name</span><span class=p>);</span>
</span></span><span class=line><span class=cl> <span class=k>this</span><span class=p>.</span><span class=nx>age</span> <span class=o>=</span> <span class=nx>age</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>inheritPrototype</span><span class=p>(</span><span class=nx>SubType</span><span class=p>,</span> <span class=nx>SuperType</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>SubType</span><span class=p>.</span><span class=nx>prototype</span><span class=p>.</span><span class=nx>sayAge</span> <span class=o>=</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>age</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><a href=#ç±»æ„é€ å‡½æ•°><h4 id=ç±»æ„é€ å‡½æ•°><span class=hanchor arialabel=Anchor># </span>ç±»æ„é€ å‡½æ•°</h4></a><p>constructor å…³é”®å­—ç”¨äºåœ¨ç±»å®šä¹‰å—å†…éƒ¨åˆ›å»ºç±»çš„æ„é€ å‡½æ•°ã€‚æ–¹æ³•å constructor ä¼šå‘Šè¯‰è§£é‡Šå™¨ åœ¨ä½¿ç”¨ new æ“ä½œç¬¦åˆ›å»ºç±»çš„æ–°å®ä¾‹æ—¶ï¼Œåº”è¯¥è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚æ„é€ å‡½æ•°çš„å®šä¹‰ä¸æ˜¯å¿…éœ€çš„ï¼Œä¸å®šä¹‰æ„é€ å‡½æ•°ç›¸å½“äºå°†æ„é€ å‡½æ•°å®šä¹‰ä¸ºç©ºå‡½æ•°ã€‚</p><a href=#proxy><h2 id=proxy><span class=hanchor arialabel=Anchor># </span>Proxy</h2></a><a href=#å¯æ’¤é”€><h4 id=å¯æ’¤é”€><span class=hanchor arialabel=Anchor># </span>å¯æ’¤é”€</h4></a><p>revocable()</p><a href=#åå°„-api><h4 id=åå°„-api><span class=hanchor arialabel=Anchor># </span>åå°„ API</h4></a><p>å¯¹è±¡çš„æ–¹æ³• å¯¹åº”çš„åå°„ API æ–¹æ³•åœ¨ Reflect éƒ½æœ‰ç›¸åº”çš„å®ç°</p><a href=#æ•°æ®ç»‘å®šä¸å¯è§‚å¯Ÿå¯¹è±¡><h4 id=æ•°æ®ç»‘å®šä¸å¯è§‚å¯Ÿå¯¹è±¡><span class=hanchor arialabel=Anchor># </span>æ•°æ®ç»‘å®šä¸å¯è§‚å¯Ÿå¯¹è±¡</h4></a><p>é€šè¿‡ä»£ç†å¯ä»¥æŠŠè¿è¡Œæ—¶ä¸­åŸæœ¬ä¸ç›¸å…³çš„éƒ¨åˆ†è”ç³»åˆ°ä¸€èµ·ã€‚è¿™æ ·å°±å¯ä»¥å®ç°å„ç§æ¨¡å¼ï¼Œä»è€Œè®©ä¸åŒçš„ ä»£ç äº’æ“ä½œã€‚ æ¯”å¦‚ï¼Œå¯ä»¥å°†è¢«ä»£ç†çš„ç±»ç»‘å®šåˆ°ä¸€ä¸ªå…¨å±€å®ä¾‹é›†åˆï¼Œè®©æ‰€æœ‰åˆ›å»ºçš„å®ä¾‹éƒ½è¢«æ·»åŠ åˆ°è¿™ä¸ªé›†åˆä¸­ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>userList</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl><span class=kr>class</span> <span class=nx>User</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>constructor</span><span class=p>(</span><span class=nx>name</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=k>this</span><span class=p>.</span><span class=nx>name_</span> <span class=o>=</span> <span class=nx>name</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>proxy</span> <span class=o>=</span> <span class=k>new</span> <span class=nb>Proxy</span><span class=p>(</span><span class=nx>User</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>construct</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=kr>const</span> <span class=nx>newUser</span> <span class=o>=</span> <span class=nx>Reflect</span><span class=p>.</span><span class=nx>construct</span><span class=p>(...</span><span class=nx>arguments</span><span class=p>);</span>
</span></span><span class=line><span class=cl> <span class=nx>userList</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>newUser</span><span class=p>);</span>
</span></span><span class=line><span class=cl> <span class=k>return</span> <span class=nx>newUser</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl><span class=k>new</span> <span class=nx>proxy</span><span class=p>(</span><span class=s1>&#39;John&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>new</span> <span class=nx>proxy</span><span class=p>(</span><span class=s1>&#39;Jacob&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>new</span> <span class=nx>proxy</span><span class=p>(</span><span class=s1>&#39;Jingleheimerschmidt&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>userList</span><span class=p>);</span> <span class=c1>// [User {}, User {}, User{}]
</span></span></span></code></pre></td></tr></table></div></div><a href=#ç”¨é€”><h4 id=ç”¨é€”><span class=hanchor arialabel=Anchor># </span>ç”¨é€”</h4></a><p>ä»£ç†çš„åº”ç”¨åœºæ™¯æ˜¯ä¸å¯é™é‡çš„ã€‚å¼€å‘è€…ä½¿ç”¨å®ƒå¯ä»¥åˆ›å»ºå‡ºå„ç§ç¼–ç æ¨¡å¼ï¼Œæ¯”å¦‚ï¼ˆä½†è¿œè¿œä¸é™äºï¼‰è·Ÿ è¸ªå±æ€§è®¿é—®ã€éšè—å±æ€§ã€é˜»æ­¢ä¿®æ”¹æˆ–åˆ é™¤å±æ€§ã€å‡½æ•°å‚æ•°éªŒè¯ã€æ„é€ å‡½æ•°å‚æ•°éªŒè¯ã€æ•°æ®ç»‘å®šï¼Œä»¥åŠå¯ è§‚å¯Ÿå¯¹è±¡ã€‚</p><a href=#å‡½æ•°><h2 id=å‡½æ•°><span class=hanchor arialabel=Anchor># </span>å‡½æ•°</h2></a><p>**å‡½æ•°å®é™…ä¸Šæ˜¯å¯¹è±¡ã€‚**æ¯ä¸ªå‡½æ•°éƒ½æ˜¯ Function ç±»å‹çš„å®ä¾‹ï¼Œè€Œ Function ä¹Ÿæœ‰å±æ€§å’Œæ–¹æ³•ï¼Œè·Ÿå…¶ä»–å¼•ç”¨ç±»å‹ä¸€æ ·ã€‚</p><a href=#ç®­å¤´å‡½æ•°><h3 id=ç®­å¤´å‡½æ•°><span class=hanchor arialabel=Anchor># </span>ç®­å¤´å‡½æ•°</h3></a><p>ç®­å¤´å‡½æ•°è™½ç„¶è¯­æ³•ç®€æ´ï¼Œä½†ä¹Ÿæœ‰å¾ˆå¤šåœºåˆä¸é€‚ç”¨ã€‚ç®­å¤´å‡½æ•°ä¸èƒ½ä½¿ç”¨ argumentsã€super å’Œ new.targetï¼Œä¹Ÿä¸èƒ½ç”¨ä½œæ„é€ å‡½æ•°ã€‚æ­¤å¤–ï¼Œç®­å¤´å‡½æ•°ä¹Ÿæ²¡æœ‰ prototype å±æ€§ã€‚</p><a href=#å‡½æ•°å£°æ˜å’Œå‡½æ•°è¡¨è¾¾å¼><h3 id=å‡½æ•°å£°æ˜å’Œå‡½æ•°è¡¨è¾¾å¼><span class=hanchor arialabel=Anchor># </span>å‡½æ•°å£°æ˜å’Œå‡½æ•°è¡¨è¾¾å¼</h3></a><p><strong>åœ¨æ‰§è¡Œä»£ç æ—¶ï¼ŒJavaScript å¼•æ“ä¼šå…ˆæ‰§è¡Œä¸€éæ‰«æï¼Œ æŠŠå‘ç°çš„å‡½æ•°å£°æ˜æå‡åˆ°æºä»£ç æ ‘çš„é¡¶éƒ¨ã€‚å› æ­¤å³ä½¿å‡½æ•°å®šä¹‰å‡ºç°åœ¨è°ƒç”¨å®ƒä»¬çš„ä»£ç ä¹‹åï¼Œå¼•æ“ä¹Ÿä¼šæŠŠå‡½æ•°å£°æ˜æå‡åˆ°é¡¶éƒ¨ã€‚</strong></p><a href=#å‡½æ•°å†…éƒ¨><h3 id=å‡½æ•°å†…éƒ¨><span class=hanchor arialabel=Anchor># </span>å‡½æ•°å†…éƒ¨</h3></a><p>åœ¨ ECMAScript 5 ä¸­ï¼Œå‡½æ•°å†…éƒ¨å­˜åœ¨ä¸¤ä¸ªç‰¹æ®Šçš„å¯¹è±¡ï¼šarguments å’Œ thisã€‚ECMAScript 6 åˆæ–°å¢ äº† new.target å±æ€§ã€‚</p><a href=#arguments><h4 id=arguments><span class=hanchor arialabel=Anchor># </span>arguments</h4></a><p>å®ƒæ˜¯ä¸€ä¸ªç±»æ•°ç»„å¯¹è±¡ï¼ŒåŒ…å«è°ƒç”¨å‡½æ•°æ—¶ä¼ å…¥çš„æ‰€æœ‰å‚æ•°ã€‚</p><p>è™½ç„¶ä¸»è¦ç”¨äºåŒ…å«å‡½æ•°å‚æ•°ï¼Œä½† arguments å¯¹è±¡å…¶å®è¿˜æœ‰ä¸€ä¸ª <strong>callee</strong> å±æ€§ï¼Œæ˜¯ä¸€ä¸ªæŒ‡å‘ arguments å¯¹è±¡æ‰€åœ¨å‡½æ•°çš„æŒ‡é’ˆã€‚</p><a href=#this><h4 id=this><span class=hanchor arialabel=Anchor># </span>this</h4></a><p>åœ¨æ ‡å‡†å‡½æ•°ä¸­ï¼Œthis å¼•ç”¨çš„æ˜¯æŠŠå‡½æ•°å½“æˆæ–¹æ³•è°ƒç”¨çš„ä¸Šä¸‹æ–‡å¯¹è±¡ã€‚</p><p>this åˆ°åº•å¼•ç”¨å“ªä¸ªå¯¹è±¡å¿…é¡»åˆ° <strong>å‡½æ•°è¢«è°ƒç”¨æ—¶æ‰èƒ½ç¡®å®š</strong>ã€‚å› æ­¤è¿™ä¸ªå€¼åœ¨ä»£ç æ‰§è¡Œçš„è¿‡ç¨‹ä¸­å¯èƒ½ä¼šå˜ã€‚</p><a href=#newtarget><h4 id=newtarget><span class=hanchor arialabel=Anchor># </span>new.target</h4></a><p>ECMAScript 6 æ–°å¢äº†æ£€æµ‹å‡½æ•°æ˜¯å¦ä½¿ç”¨ new å…³é”®å­—è°ƒç”¨çš„ new.target å±æ€§ã€‚å¦‚æœå‡½æ•°æ˜¯æ­£å¸¸è°ƒç”¨çš„ï¼Œåˆ™ new.target çš„å€¼æ˜¯ <strong>undefined</strong>ï¼›å¦‚æœæ˜¯ä½¿ç”¨ new å…³é”®å­—è°ƒç”¨çš„ï¼Œåˆ™ new.target å°†å¼•ç”¨è¢«è°ƒç”¨çš„ <strong>æ„é€ å‡½æ•°</strong>ã€‚</p><a href=#å‡½æ•°å±æ€§ä¸æ–¹æ³•><h3 id=å‡½æ•°å±æ€§ä¸æ–¹æ³•><span class=hanchor arialabel=Anchor># </span>å‡½æ•°å±æ€§ä¸æ–¹æ³•</h3></a><ul><li>length :ä¿å­˜å‡½æ•°å®šä¹‰çš„å‘½åå‚æ•°ä¸ªæ•°</li><li>prototype:ä¿å­˜å¼•ç”¨ç±»å‹æ‰€æœ‰å®ä¾‹ æ–¹æ³•çš„åœ°æ–¹<ul><li>apply: æ”¹å˜ this æŒ‡å‘çš„æ–¹æ³•, åªæ¥å—ä¸¤ä¸ªå‚æ•°</li><li>call : æ”¹å˜ this æŒ‡å‘çš„æ–¹æ³•, å¯ä»¥æ¥å—æ— é™å¤šçš„å‚æ•°</li><li>bind:åˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°å®ä¾‹ï¼Œ å…¶ this å€¼ä¼šè¢«ç»‘å®šåˆ°ä¼ ç»™ bind()çš„å¯¹è±¡</li></ul></li></ul><a href=#å°¾è°ƒç”¨ä¼˜åŒ–><h3 id=å°¾è°ƒç”¨ä¼˜åŒ–><span class=hanchor arialabel=Anchor># </span>å°¾è°ƒç”¨ä¼˜åŒ–</h3></a><p>å¦‚æœå‡½æ•°çš„é€»è¾‘å…è®¸åŸºäºå°¾è°ƒç”¨å°†å…¶é”€æ¯ï¼Œåˆ™å¼•æ“å°±ä¼šæ— è®ºè°ƒç”¨å¤šå°‘æ¬¡åµŒå¥—å‡½æ•°ï¼Œéƒ½åªç»´æŠ¤ä¸€ä¸ªæ ˆå¸§ã€‚</p><p>æ¡ä»¶å¦‚ä¸‹ï¼š</p><ul><li>ä»£ç åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹æ‰§è¡Œï¼›</li><li>å¤–éƒ¨å‡½æ•°çš„è¿”å›å€¼æ˜¯å¯¹å°¾è°ƒç”¨å‡½æ•°çš„è°ƒç”¨ï¼›</li><li>å°¾è°ƒç”¨å‡½æ•°è¿”å›åä¸éœ€è¦æ‰§è¡Œé¢å¤–çš„é€»è¾‘ï¼›</li><li>å°¾è°ƒç”¨å‡½æ•°ä¸æ˜¯å¼•ç”¨å¤–éƒ¨å‡½æ•°ä½œç”¨åŸŸä¸­è‡ªç”±å˜é‡çš„é—­åŒ…</li></ul><a href=#ä¸¾ä¸ªæ —å­><h4 id=ä¸¾ä¸ªæ —å­><span class=hanchor arialabel=Anchor># </span>ä¸¾ä¸ªæ —å­</h4></a><p>ä¼˜åŒ–å‰ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>fib</span><span class=p>(</span><span class=nx>n</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=k>if</span> <span class=p>(</span><span class=nx>n</span> <span class=o>&lt;</span> <span class=mi>2</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=k>return</span> <span class=nx>n</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=p>}</span>
</span></span><span class=line><span class=cl> <span class=k>return</span> <span class=nx>fib</span><span class=p>(</span><span class=nx>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=nx>fib</span><span class=p>(</span><span class=nx>n</span> <span class=o>-</span> <span class=mi>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ä¼˜åŒ–å:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=c1>// åŸºç¡€æ¡†æ¶
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>fib</span><span class=p>(</span><span class=nx>n</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=k>return</span> <span class=nx>fibImpl</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=nx>n</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// æ‰§è¡Œé€’å½’
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>fibImpl</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>n</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=k>if</span> <span class=p>(</span><span class=nx>n</span> <span class=o>===</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=k>return</span> <span class=nx>a</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=p>}</span>
</span></span><span class=line><span class=cl> <span class=k>return</span> <span class=nx>fibImpl</span><span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=nx>a</span> <span class=o>+</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><a href=#é—­åŒ…><h3 id=é—­åŒ…><span class=hanchor arialabel=Anchor># </span>é—­åŒ…</h3></a><p>é—­åŒ…æŒ‡çš„æ˜¯é‚£äº›<strong>å¼•ç”¨äº†å¦ä¸€ä¸ªå‡½æ•°ä½œç”¨åŸŸä¸­å˜é‡</strong>çš„å‡½æ•°ï¼Œé€šå¸¸æ˜¯åœ¨åµŒå¥—å‡½æ•°ä¸­å®ç°çš„</p><p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œå‡½æ•°å†…éƒ¨çš„ä»£ç åœ¨è®¿é—®å˜é‡æ—¶ï¼Œå°±ä¼šä½¿ç”¨ç»™å®šçš„åç§°ä»ä½œç”¨åŸŸé“¾ä¸­æŸ¥æ‰¾å˜é‡ã€‚å‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼Œå±€éƒ¨æ´»åŠ¨å¯¹è±¡ä¼šè¢«é”€æ¯ï¼Œå†…å­˜ä¸­å°±åªå‰©ä¸‹å…¨å±€ä½œç”¨åŸŸã€‚ä¸è¿‡ï¼Œé—­åŒ…å°±ä¸ä¸€æ ·äº†ã€‚å› ä¸ºå‡½æ•°è¿˜ä¿å­˜ç€å¤–éƒ¨ä½œç”¨åŸŸé“¾ä¸­çš„å˜é‡çš„å¼•ç”¨ï¼Œå®ƒå°±ä¸èƒ½ç›´æ¥é”€æ¯ï¼Œå°†å®ƒçš„æ´»åŠ¨å¯¹è±¡ä»ç„¶ä¼šä¿ç•™åœ¨å†…å­˜ä¸­ï¼Œç›´åˆ°å‡½æ•°é”€æ¯ã€‚</p><a href=#this-å¯¹è±¡><h4 id=this-å¯¹è±¡><span class=hanchor arialabel=Anchor># </span>this å¯¹è±¡</h4></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=nb>window</span><span class=p>.</span><span class=nx>identity</span> <span class=o>=</span> <span class=s1>&#39;The Window&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nx>object</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>identity</span><span class=o>:</span> <span class=s1>&#39;My Object&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>getIdentityFunc</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=k>this</span><span class=p>.</span><span class=nx>identity</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>object</span><span class=p>.</span><span class=nx>getIdentityFunc</span><span class=p>()());</span> <span class=c1>// &#39;The Window&#39;
</span></span></span></code></pre></td></tr></table></div></div><p>å› ä¸º object.getIdentityFunc() æ‰§è¡Œè¿”å›äº† ä¸€ä¸ªåŒ¿åå‡½æ•° ï¼Œè€Œå½“è¿™ä¸ªåŒ¿åå‡½æ•°æ‰§è¡Œæ—¶ï¼Œä»–çš„ this æ‰ç”Ÿæˆï¼Œä¹Ÿå°±æ˜¯è¿™é‡Œçš„ window</p><a href=#promise><h2 id=promise><span class=hanchor arialabel=Anchor># </span>Promise</h2></a><a href=#promisesaè§„èŒƒ><h3 id=promisesaè§„èŒƒ><span class=hanchor arialabel=Anchor># </span>Promises/A+è§„èŒƒ</h3></a><p>ä¸ºå¼¥åˆç°æœ‰å®ç°ä¹‹é—´çš„å·®å¼‚ï¼Œ2012 å¹´ Promises/A+ç»„ç»‡åˆ†å‰ï¼ˆforkï¼‰ äº† CommonJS çš„ Promises/A å»ºè®®ï¼Œå¹¶ä»¥ç›¸åŒçš„åå­—åˆ¶å®šäº† Promises/A+è§„èŒƒã€‚è¿™ä¸ªè§„èŒƒæœ€ç»ˆæˆä¸ºäº† ECMAScript 6 è§„èŒƒå®ç°çš„èŒƒæœ¬ã€‚</p><a href=#promise-çŠ¶æ€æœº><h3 id=promise-çŠ¶æ€æœº><span class=hanchor arialabel=Anchor># </span>promise çŠ¶æ€æœº</h3></a><ul><li>pending</li><li>resolved</li><li>rejected</li></ul><p>é‡è¦çš„æ˜¯ï¼ŒPromise çš„çŠ¶æ€æ˜¯ç§æœ‰çš„ï¼Œä¸èƒ½ç›´æ¥é€šè¿‡ JavaScript æ£€æµ‹åˆ°ã€‚è¿™ä¸»è¦æ˜¯ä¸ºäº†é¿å…æ ¹æ®è¯»å–åˆ° çš„æœŸçº¦çŠ¶æ€ï¼Œä»¥åŒæ­¥æ–¹å¼å¤„ç† Promise å¯¹è±¡ã€‚å¦å¤–ï¼ŒPromise çš„çŠ¶æ€ä¹Ÿä¸èƒ½è¢«å¤–éƒ¨ JavaScript ä»£ç ä¿®æ”¹ã€‚è¿™ä¸ä¸ èƒ½è¯»å–è¯¥çŠ¶æ€çš„åŸå› æ˜¯ä¸€æ ·çš„ï¼šPromise æ•…æ„å°†å¼‚æ­¥è¡Œä¸ºå°è£…èµ·æ¥ï¼Œä»è€Œéš”ç¦»å¤–éƒ¨çš„åŒæ­¥ä»£ç ã€‚</p><p>å› ä¸º Promise çš„çŠ¶æ€åªèƒ½æ”¹å˜ä¸€æ¬¡ï¼Œæ‰€ä»¥è¿™é‡Œçš„è¶…æ—¶æ‹’ç»é€»è¾‘ä¸­å¯ä»¥æ”¾å¿ƒåœ°è®¾ç½®è®© Promise å¤„äºå¾…å®šçŠ¶æ€çš„ æœ€é•¿æ—¶é—´ã€‚å¦‚æœæ‰§è¡Œå™¨ä¸­çš„ä»£ç åœ¨è¶…æ—¶ä¹‹å‰å·²ç»è§£å†³æˆ–æ‹’ç»ï¼Œé‚£ä¹ˆè¶…æ—¶å›è°ƒå†å°è¯•æ‹’ç»ä¹Ÿä¼šé™é»˜å¤±è´¥ã€‚</p><a href=#åŒæ­¥å¼‚æ­¥æ‰§è¡Œçš„äºŒå…ƒæ€§><h3 id=åŒæ­¥å¼‚æ­¥æ‰§è¡Œçš„äºŒå…ƒæ€§><span class=hanchor arialabel=Anchor># </span>åŒæ­¥/å¼‚æ­¥æ‰§è¡Œçš„äºŒå…ƒæ€§</h3></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=k>throw</span> <span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=s1>&#39;foo&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>catch</span><span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>e</span><span class=p>);</span> <span class=c1>// Error: foo
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nb>Promise</span><span class=p>.</span><span class=nx>reject</span><span class=p>(</span><span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=s1>&#39;bar&#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>catch</span><span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>e</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// Uncaught (in promise) Error: bar
</span></span></span></code></pre></td></tr></table></div></div><p>è¿™é‡Œçš„åŒæ­¥ä»£ç ä¹‹æ‰€ä»¥æ²¡æœ‰æ•è·æœŸçº¦æŠ›å‡ºçš„é”™è¯¯ï¼Œæ˜¯å› ä¸ºå®ƒæ²¡æœ‰é€šè¿‡å¼‚æ­¥æ¨¡å¼æ•è·é”™è¯¯ã€‚ä»è¿™ é‡Œå°±å¯ä»¥çœ‹å‡º Promise çœŸæ­£çš„å¼‚æ­¥ç‰¹æ€§ï¼šå®ƒä»¬æ˜¯<strong>åŒæ­¥å¯¹è±¡</strong>ï¼ˆåœ¨åŒæ­¥æ‰§è¡Œæ¨¡å¼ä¸­ä½¿ç”¨ï¼‰ï¼Œä½†ä¹Ÿæ˜¯<strong>å¼‚æ­¥æ‰§è¡Œæ¨¡å¼ çš„åª’ä»‹</strong>ã€‚</p><p>åœ¨å‰é¢çš„ä¾‹å­ä¸­ï¼Œæ‹’ç» Promise çš„é”™è¯¯å¹¶æ²¡æœ‰æŠ›åˆ°æ‰§è¡ŒåŒæ­¥ä»£ç çš„çº¿ç¨‹é‡Œï¼Œè€Œæ˜¯é€šè¿‡æµè§ˆå™¨å¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ—æ¥å¤„ç†çš„ã€‚å› æ­¤ï¼Œtry/catch å—å¹¶ä¸èƒ½æ•è·è¯¥é”™è¯¯ã€‚<strong>ä»£ç ä¸€æ—¦å¼€å§‹ä»¥å¼‚æ­¥æ¨¡å¼æ‰§è¡Œï¼Œåˆ™å”¯ä¸€ä¸ä¹‹äº¤äº’ çš„æ–¹å¼å°±æ˜¯ä½¿ç”¨å¼‚æ­¥ç»“æ„â€”â€”æ›´å…·ä½“åœ°è¯´ï¼Œå°±æ˜¯ Promise çš„æ–¹æ³•ã€‚</strong></p><a href=#æ‹’ç»-promise-ä¸æ‹’ç»é”™è¯¯å¤„ç†><h3 id=æ‹’ç»-promise-ä¸æ‹’ç»é”™è¯¯å¤„ç†><span class=hanchor arialabel=Anchor># </span>æ‹’ç» Promise ä¸æ‹’ç»é”™è¯¯å¤„ç†</h3></a><p>æ‹’ç» Promise ç±»ä¼¼äº throw()è¡¨è¾¾å¼ï¼Œå› ä¸ºå®ƒä»¬éƒ½ä»£è¡¨ä¸€ç§ç¨‹åºçŠ¶æ€ï¼Œå³éœ€è¦ä¸­æ–­æˆ–è€…ç‰¹æ®Šå¤„ç†ã€‚åœ¨ Promise çš„æ‰§è¡Œå‡½æ•°æˆ–å¤„ç†ç¨‹åºä¸­æŠ›å‡ºé”™è¯¯ä¼šå¯¼è‡´æ‹’ç»ï¼Œå¯¹åº”çš„é”™è¯¯å¯¹è±¡ä¼šæˆä¸ºæ‹’ç»çš„ç†ç”±ã€‚å› æ­¤ä»¥ä¸‹è¿™äº› Promise éƒ½ä¼šä»¥ä¸€ä¸ªé”™è¯¯å¯¹è±¡ä¸ºç”±è¢«æ‹’ç»ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kd>let</span> <span class=nx>p1</span> <span class=o>=</span> <span class=k>new</span> <span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span> <span class=nx>reject</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>reject</span><span class=p>(</span><span class=nb>Error</span><span class=p>(</span><span class=s1>&#39;foo&#39;</span><span class=p>)));</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nx>p2</span> <span class=o>=</span> <span class=k>new</span> <span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span> <span class=nx>reject</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span> <span class=k>throw</span> <span class=nb>Error</span><span class=p>(</span><span class=s1>&#39;foo&#39;</span><span class=p>);</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nx>p3</span> <span class=o>=</span> <span class=nb>Promise</span><span class=p>.</span><span class=nx>resolve</span><span class=p>().</span><span class=nx>then</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span> <span class=k>throw</span> <span class=nb>Error</span><span class=p>(</span><span class=s1>&#39;foo&#39;</span><span class=p>);</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nx>p4</span> <span class=o>=</span> <span class=nb>Promise</span><span class=p>.</span><span class=nx>reject</span><span class=p>(</span><span class=nb>Error</span><span class=p>(</span><span class=s1>&#39;foo&#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=nx>setTimeout</span><span class=p>(</span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>p1</span><span class=p>);</span> <span class=c1>// Promise &lt;rejected&gt;: Error: foo
</span></span></span></code></pre></td></tr></table></div></div><p><strong>åœ¨ Promise ä¸­æŠ›å‡ºé”™è¯¯æ—¶ï¼Œå› ä¸ºé”™è¯¯å®é™…ä¸Šæ˜¯ä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­å¼‚æ­¥æŠ›å‡ºçš„ï¼Œæ‰€ä»¥å¹¶ä¸ä¼šé˜»æ­¢è¿è¡Œæ—¶ç»§ç»­æ‰§è¡ŒåŒæ­¥æŒ‡ä»¤ï¼š</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=nb>Promise</span><span class=p>.</span><span class=nx>reject</span><span class=p>(</span><span class=nb>Error</span><span class=p>(</span><span class=s1>&#39;foo&#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;bar&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>// bar
</span></span></span><span class=line><span class=cl><span class=c1>// Uncaught (in promise) Error: foo
</span></span></span></code></pre></td></tr></table></div></div><p><strong>onRejected å¤„ç†ç¨‹åºçš„ä»»åŠ¡åº”è¯¥æ˜¯åœ¨æ•è·å¼‚æ­¥é”™è¯¯ä¹‹åè¿”å›ä¸€ä¸ªè§£å†³çš„ Promiseã€‚</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=k>new</span> <span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span> <span class=nx>reject</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;begin asynchronous execution&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl> <span class=nx>reject</span><span class=p>(</span><span class=nb>Error</span><span class=p>(</span><span class=s1>&#39;bar&#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=p>}).</span><span class=k>catch</span><span class=p>((</span><span class=nx>e</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;caught error&#39;</span><span class=p>,</span> <span class=nx>e</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}).</span><span class=nx>then</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;continue asynchronous execution&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl><span class=c1>// begin asynchronous execution
</span></span></span><span class=line><span class=cl><span class=c1>// caught error Error: bar
</span></span></span><span class=line><span class=cl><span class=c1>// continue asynchronous execution
</span></span></span></code></pre></td></tr></table></div></div><a href=#promise-å–æ¶ˆ><h3 id=promise-å–æ¶ˆ><span class=hanchor arialabel=Anchor># </span>Promise å–æ¶ˆ</h3></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kr>class</span> <span class=nx>CancelToken</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>constructor</span><span class=p>(</span><span class=nx>cancelFn</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>promise</span> <span class=o>=</span> <span class=k>new</span> <span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span> <span class=nx>reject</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>cancelFn</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>setTimeout</span><span class=p>(</span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=s2>&#34;delay cancelled&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>resolve</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>startButton</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s1>&#39;#start&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>cancelButton</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s1>&#39;#cancel&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>cancellableDelayedResolve</span> <span class=p>(</span><span class=nx>delay</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>setTimeout</span><span class=p>(</span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=s2>&#34;set delay&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=k>new</span> <span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span> <span class=nx>reject</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>id</span> <span class=o>=</span> <span class=nx>setTimeout</span><span class=p>((()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>setTimeout</span><span class=p>(</span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=s2>&#34;delayed resolve&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nx>resolve</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}),</span> <span class=nx>delay</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>cancelToken</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>CancelToken</span><span class=p>((</span><span class=nx>cancelCallback</span><span class=p>)</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nx>cancelButton</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&#34;click&#34;</span><span class=p>,</span> <span class=nx>cancelCallback</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=nx>cancelToken</span><span class=p>.</span><span class=nx>promise</span><span class=p>.</span><span class=nx>then</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=nx>clearTimeout</span><span class=p>(</span><span class=nx>id</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>startButton</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&#34;click&#34;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=nx>cancellableDelayedResolve</span><span class=p>(</span><span class=mi>1000</span><span class=p>));</span>
</span></span></code></pre></td></tr></table></div></div><a href=#promise-è¿›åº¦é€šçŸ¥><h3 id=promise-è¿›åº¦é€šçŸ¥><span class=hanchor arialabel=Anchor># </span>Promise è¿›åº¦é€šçŸ¥</h3></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kr>class</span> <span class=nx>TrackablePromise</span> <span class=kr>extends</span> <span class=nb>Promise</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>constructor</span><span class=p>(</span><span class=nx>executor</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>notifyHandlers</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>    <span class=kr>super</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span> <span class=nx>reject</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>executor</span><span class=p>(</span><span class=nx>resolve</span><span class=p>,</span> <span class=nx>reject</span><span class=p>,</span> <span class=p>(</span><span class=nx>status</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>notifyHandlers</span><span class=p>.</span><span class=nx>map</span><span class=p>((</span><span class=nx>handler</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>handler</span><span class=p>(</span><span class=nx>status</span><span class=p>));</span>
</span></span><span class=line><span class=cl>      <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>notifyHandlers</span> <span class=o>=</span> <span class=nx>notifyHandlers</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=nx>notify</span> <span class=p>(</span><span class=nx>notifyHandler</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>notifyHandlers</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>notifyHandler</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>this</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nx>p</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>TrackablePromise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span> <span class=nx>reject</span><span class=p>,</span> <span class=nx>notify</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=nx>countdown</span> <span class=p>(</span><span class=nx>x</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>x</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>notify</span><span class=p>(</span><span class=sb>`</span><span class=si>${</span><span class=mi>20</span> <span class=o>*</span> <span class=nx>x</span><span class=si>}</span><span class=sb>% remaining`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nx>setTimeout</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=nx>countdown</span><span class=p>(</span><span class=nx>x</span> <span class=o>-</span> <span class=mi>1</span><span class=p>),</span> <span class=mi>1000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>resolve</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=nx>countdown</span><span class=p>(</span><span class=mi>5</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl><span class=nx>p</span><span class=p>.</span><span class=nx>notify</span><span class=p>((</span><span class=nx>x</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>setTimeout</span><span class=p>(</span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;progress:&#39;</span><span class=p>,</span> <span class=nx>x</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=nx>p</span><span class=p>.</span><span class=nx>then</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=nx>setTimeout</span><span class=p>(</span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;completed&#39;</span><span class=p>));</span>
</span></span></code></pre></td></tr></table></div></div><a href=#asyncawait><h2 id=asyncawait><span class=hanchor arialabel=Anchor># </span>async/await</h2></a><a href=#æŠ›å‡ºé”™è¯¯><h3 id=æŠ›å‡ºé”™è¯¯><span class=hanchor arialabel=Anchor># </span>æŠ›å‡ºé”™è¯¯</h3></a><p>ç­‰å¾…ä¼šæŠ›å‡ºé”™è¯¯çš„åŒæ­¥æ“ä½œï¼Œä¼šè¿”å›æ‹’ç»çš„æœŸçº¦ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>foo</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl> <span class=kr>await</span> <span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span> <span class=k>throw</span> <span class=mi>3</span><span class=p>;</span> <span class=p>})();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// ç»™è¿”å›çš„æœŸçº¦æ·»åŠ ä¸€ä¸ªæ‹’ç»å¤„ç†ç¨‹åº
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>foo</span><span class=p>().</span><span class=k>catch</span><span class=p>(</span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=mi>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>// 1
</span></span></span><span class=line><span class=cl><span class=c1>// 2
</span></span></span><span class=line><span class=cl><span class=c1>// 3
</span></span></span></code></pre></td></tr></table></div></div><p>å•ç‹¬çš„ Promise.reject()ä¸ä¼šè¢«å¼‚æ­¥å‡½æ•°æ•è·ï¼Œè€Œä¼šæŠ›å‡ºæœªæ•è·é”™è¯¯ã€‚ä¸ è¿‡ï¼Œå¯¹æ‹’ç»çš„æœŸçº¦ä½¿ç”¨ await åˆ™ä¼šé‡Šæ”¾ï¼ˆunwrapï¼‰é”™è¯¯å€¼ï¼ˆå°†æ‹’ç» Promise è¿”å›ï¼‰ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>foo</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl> <span class=kr>await</span> <span class=nb>Promise</span><span class=p>.</span><span class=nx>reject</span><span class=p>(</span><span class=mi>3</span><span class=p>);</span>
</span></span><span class=line><span class=cl> <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=mi>4</span><span class=p>);</span> <span class=c1>// è¿™è¡Œä»£ç ä¸ä¼šæ‰§è¡Œ
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// ç»™è¿”å›çš„æœŸçº¦æ·»åŠ ä¸€ä¸ªæ‹’ç»å¤„ç†ç¨‹åº
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>foo</span><span class=p>().</span><span class=k>catch</span><span class=p>(</span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=mi>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>// 1
</span></span></span><span class=line><span class=cl><span class=c1>// 2
</span></span></span><span class=line><span class=cl><span class=c1>// 3
</span></span></span></code></pre></td></tr></table></div></div><a href=#å¼‚æ­¥ç­–ç•¥><h3 id=å¼‚æ­¥ç­–ç•¥><span class=hanchor arialabel=Anchor># </span>å¼‚æ­¥ç­–ç•¥</h3></a><a href=#å®ç°-sleep><h4 id=å®ç°-sleep><span class=hanchor arialabel=Anchor># </span>å®ç° sleep</h4></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>sleep</span><span class=p>(</span><span class=nx>delay</span><span class=p>){</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>new</span> <span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>)=&gt;</span> <span class=nx>setTimeout</span><span class=p>(</span><span class=nx>resolve</span><span class=p>,</span> <span class=nx>delay</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><a href=#åˆ©ç”¨å¹³è¡Œæ‰§è¡Œ><h4 id=åˆ©ç”¨å¹³è¡Œæ‰§è¡Œ><span class=hanchor arialabel=Anchor># </span>åˆ©ç”¨å¹³è¡Œæ‰§è¡Œ</h4></a><p>æ­£å¸¸ä¸²è¡Œå†™æ³•ï¼Œåœ¨ä¸éœ€è¦ä¿è¯é¡ºåºçš„æƒ…å†µä¸‹å±äºéœ€è¦ä¼˜åŒ–çš„åœ°æ–¹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>randomDelay</span> <span class=p>(</span><span class=nx>id</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// å»¶è¿Ÿ 0~1000 æ¯«ç§’
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>delay</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>()</span> <span class=o>*</span> <span class=mi>1000</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=k>new</span> <span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>setTimeout</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`</span><span class=si>${</span><span class=nx>id</span><span class=si>}</span><span class=sb> finished`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>resolve</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span> <span class=nx>delay</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>foo</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>t0</span> <span class=o>=</span> <span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=kr>await</span> <span class=nx>randomDelay</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>await</span> <span class=nx>randomDelay</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>await</span> <span class=nx>randomDelay</span><span class=p>(</span><span class=mi>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>await</span> <span class=nx>randomDelay</span><span class=p>(</span><span class=mi>3</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>await</span> <span class=nx>randomDelay</span><span class=p>(</span><span class=mi>4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`</span><span class=si>${</span><span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>()</span> <span class=o>-</span> <span class=nx>t0</span><span class=si>}</span><span class=sb>ms elapsed`</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>foo</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 0 finished
</span></span></span><span class=line><span class=cl><span class=c1>// 1 finished
</span></span></span><span class=line><span class=cl><span class=c1>// 2 finished
</span></span></span><span class=line><span class=cl><span class=c1>// 3 finished
</span></span></span><span class=line><span class=cl><span class=c1>// 4 finished
</span></span></span><span class=line><span class=cl><span class=c1>// 1570ms elapsed
</span></span></span></code></pre></td></tr></table></div></div><p><em>for å¾ªç¯å†™æ³•</em></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>foo</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>t0</span> <span class=o>=</span> <span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=kd>let</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=mi>5</span><span class=p>;</span> <span class=o>++</span><span class=nx>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>await</span> <span class=nx>randomDelay</span><span class=p>(</span><span class=nx>i</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`</span><span class=si>${</span><span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>()</span> <span class=o>-</span> <span class=nx>t0</span><span class=si>}</span><span class=sb>ms elapsed`</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>foo</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 0 finished
</span></span></span><span class=line><span class=cl><span class=c1>// 1 finished
</span></span></span><span class=line><span class=cl><span class=c1>// 2 finished
</span></span></span><span class=line><span class=cl><span class=c1>// 3 finished
</span></span></span><span class=line><span class=cl><span class=c1>// 4 finished
</span></span></span><span class=line><span class=cl><span class=c1>// 2494ms elapsed
</span></span></span></code></pre></td></tr></table></div></div><p>å°±ç®—è¿™äº›æœŸçº¦ä¹‹é—´æ²¡æœ‰ä¾èµ–ï¼Œå¼‚æ­¥å‡½æ•°ä¹Ÿä¼šä¾æ¬¡æš‚åœï¼Œç­‰å¾…æ¯ä¸ªè¶…æ—¶å®Œæˆã€‚è¿™æ ·å¯ä»¥ä¿è¯æ‰§è¡Œé¡ºåºï¼Œ ä½†æ€»æ‰§è¡Œæ—¶é—´ä¼šå˜é•¿ã€‚</p><p><strong>å¦‚æœé¡ºåºä¸æ˜¯å¿…éœ€ä¿è¯çš„ï¼Œé‚£ä¹ˆå¯ä»¥å…ˆä¸€æ¬¡æ€§åˆå§‹åŒ–æ‰€æœ‰æœŸçº¦</strong>ï¼Œç„¶åå†åˆ†åˆ«ç­‰å¾…å®ƒä»¬çš„ç»“æœã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>foo</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>t0</span> <span class=o>=</span> <span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>promises</span> <span class=o>=</span> <span class=nb>Array</span><span class=p>(</span><span class=mi>5</span><span class=p>).</span><span class=nx>fill</span><span class=p>(</span><span class=kc>null</span><span class=p>).</span><span class=nx>map</span><span class=p>((</span><span class=nx>_</span><span class=p>,</span> <span class=nx>i</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>randomDelay</span><span class=p>(</span><span class=nx>i</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=kr>const</span> <span class=nx>p</span> <span class=k>of</span> <span class=nx>promises</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>await</span> <span class=nx>p</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`</span><span class=si>${</span><span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>()</span> <span class=o>-</span> <span class=nx>t0</span><span class=si>}</span><span class=sb>ms elapsed`</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>foo</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>è™½ç„¶ Promise æ²¡æœ‰æŒ‰ç…§é¡ºåºæ‰§è¡Œï¼Œä½† await æŒ‰é¡ºåºæ”¶åˆ°äº†æ¯ä¸ª Promise çš„å€¼</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl> <span class=kd>function</span> <span class=nx>foo</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>t0</span> <span class=o>=</span> <span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>promises</span> <span class=o>=</span> <span class=nb>Array</span><span class=p>(</span><span class=mi>5</span><span class=p>).</span><span class=nx>fill</span><span class=p>(</span><span class=kc>null</span><span class=p>).</span><span class=nx>map</span><span class=p>((</span><span class=nx>_</span><span class=p>,</span> <span class=nx>i</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>randomDelay</span><span class=p>(</span><span class=nx>i</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=kr>const</span> <span class=nx>p</span> <span class=k>of</span> <span class=nx>promises</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`awaited </span><span class=si>${</span><span class=kr>await</span> <span class=nx>p</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`</span><span class=si>${</span><span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>()</span> <span class=o>-</span> <span class=nx>t0</span><span class=si>}</span><span class=sb>ms elapsed`</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>foo</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 1 finished
</span></span></span><span class=line><span class=cl><span class=c1>// 3 finished
</span></span></span><span class=line><span class=cl><span class=c1>// 0 finished
</span></span></span><span class=line><span class=cl><span class=c1>// awaited 0
</span></span></span><span class=line><span class=cl><span class=c1>// awaited 1
</span></span></span><span class=line><span class=cl><span class=c1>// 2 finished
</span></span></span><span class=line><span class=cl><span class=c1>// awaited 2
</span></span></span><span class=line><span class=cl><span class=c1>// awaited 3
</span></span></span><span class=line><span class=cl><span class=c1>// 4 finished
</span></span></span><span class=line><span class=cl><span class=c1>// awaited 4
</span></span></span><span class=line><span class=cl><span class=c1>// 958ms elapsed
</span></span></span></code></pre></td></tr></table></div></div><a href=#bom><h2 id=bom><span class=hanchor arialabel=Anchor># </span>BOM</h2></a><p>BOM çš„æ ¸å¿ƒæ˜¯ window å¯¹è±¡ï¼Œè¡¨ç¤ºæµè§ˆå™¨çš„å®ä¾‹ã€‚window å¯¹è±¡åœ¨æµè§ˆå™¨ä¸­æœ‰ä¸¤é‡èº«ä»½ï¼Œä¸€ä¸ªæ˜¯ ECMAScript ä¸­çš„ Global å¯¹è±¡ï¼Œå¦ä¸€ä¸ªå°±æ˜¯æµè§ˆå™¨çª—å£çš„ JavaScript æ¥å£ã€‚è¿™æ„å‘³ç€ç½‘é¡µä¸­å®šä¹‰çš„æ‰€æœ‰ å¯¹è±¡ã€å˜é‡å’Œå‡½æ•°éƒ½ä»¥ window ä½œä¸ºå…¶ Global å¯¹è±¡ï¼Œéƒ½å¯ä»¥è®¿é—®å…¶ä¸Šå®šä¹‰çš„ parseInt()ç­‰å…¨å±€æ–¹æ³•</p><a href=#window-å¯¹è±¡><h3 id=window-å¯¹è±¡><span class=hanchor arialabel=Anchor># </span>Window å¯¹è±¡</h3></a><a href=#çª—å£å…³ç³»><h4 id=çª—å£å…³ç³»><span class=hanchor arialabel=Anchor># </span>çª—å£å…³ç³»</h4></a><p>top å¯¹è±¡å§‹ç»ˆæŒ‡å‘æœ€ä¸Šå±‚ï¼ˆæœ€å¤–å±‚ï¼‰çª—å£ï¼Œå³æµè§ˆå™¨çª—å£æœ¬èº«ã€‚è€Œ parent å¯¹è±¡åˆ™å§‹ç»ˆæŒ‡å‘å½“å‰çª— å£çš„çˆ¶çª—å£ã€‚å¦‚æœå½“å‰çª—å£æ˜¯æœ€ä¸Šå±‚çª—å£ï¼Œåˆ™ parent ç­‰äº topï¼ˆéƒ½ç­‰äº windowï¼‰ã€‚</p><a href=#åƒç´ æ¯”><h4 id=åƒç´ æ¯”><span class=hanchor arialabel=Anchor># </span>åƒç´ æ¯”</h4></a><p>window.devicePixelRatio å®é™…ä¸Šä¸æ¯è‹±å¯¸åƒç´ æ•°ï¼ˆDPIï¼Œdots per inchï¼‰æ˜¯å¯¹åº”çš„ã€‚DPI è¡¨ç¤ºå• ä½åƒç´ å¯†åº¦ï¼Œè€Œ window.devicePixelRatio è¡¨ç¤ºç‰©ç†åƒç´ ä¸é€»è¾‘åƒç´ ä¹‹é—´çš„ç¼©æ”¾ç³»æ•°ã€‚</p><a href=#çª—å£å¤§å°><h4 id=çª—å£å¤§å°><span class=hanchor arialabel=Anchor># </span>çª—å£å¤§å°</h4></a><p>æ‰€æœ‰ç°ä»£æµè§ˆå™¨éƒ½æ”¯æŒ 4 ä¸ªå±æ€§ï¼š innerWidthã€innerHeightã€outerWidth å’Œ outerHeightã€‚</p><p>outerWidth å’Œ outerHeight è¿”å›æµè§ˆå™¨çª—å£è‡ªèº«çš„å¤§å°</p><p>innerWidth å’Œ innerHeight è¿”å›æµè§ˆå™¨çª—å£ä¸­é¡µé¢è§†å£çš„å¤§å°ï¼ˆä¸åŒ…å«æµè§ˆå™¨è¾¹æ¡†å’Œå·¥å…·æ ï¼‰ã€‚</p><p>document.documentElement.clientWidth å’Œ document.documentElement.clientHeight è¿”å›é¡µé¢è§†å£çš„å®½åº¦å’Œé«˜åº¦ã€‚</p><p>å› ä¸ºæ¡Œé¢æµè§ˆå™¨çš„å·®å¼‚ï¼Œæ‰€ä»¥éœ€è¦å…ˆç¡®å®šç”¨æˆ·æ˜¯ä¸æ˜¯åœ¨ä½¿ç”¨ç§»åŠ¨è®¾å¤‡ï¼Œç„¶åå†å†³å®šä½¿ç”¨å“ªä¸ªå±æ€§ã€‚</p><a href=#è§†å£ä½ç½®><h4 id=è§†å£ä½ç½®><span class=hanchor arialabel=Anchor># </span>è§†å£ä½ç½®</h4></a><p>åº¦é‡æ–‡æ¡£ç›¸å¯¹äºè§†å£æ»šåŠ¨è·ç¦»çš„å±æ€§æœ‰ä¸¤å¯¹ï¼Œè¿”å›ç›¸ç­‰çš„å€¼ï¼šwindow.pageXoffset/window. scrollX å’Œ window.pageYoffset/window.scrollYã€‚</p><p>å¯ä»¥ä½¿ç”¨ scroll()ã€scrollTo()å’Œ scrollBy()æ–¹æ³•æ»šåŠ¨é¡µé¢ã€‚è¿™ 3 ä¸ªæ–¹æ³•éƒ½æ¥æ”¶è¡¨ç¤ºç›¸å¯¹è§†å£è· ç¦»çš„ x å’Œ y åæ ‡ï¼Œè¿™ä¸¤ä¸ªå‚æ•°åœ¨å‰ä¸¤ä¸ªæ–¹æ³•ä¸­è¡¨ç¤ºè¦æ»šåŠ¨åˆ°çš„åæ ‡ï¼Œåœ¨æœ€åä¸€ä¸ªæ–¹æ³•ä¸­è¡¨ç¤ºæ»šåŠ¨çš„è·ç¦»ã€‚</p><a href=#å®šæ—¶å™¨><h4 id=å®šæ—¶å™¨><span class=hanchor arialabel=Anchor># </span>å®šæ—¶å™¨</h4></a><p>JavaScript åœ¨æµè§ˆå™¨ä¸­æ˜¯<strong>å•çº¿ç¨‹æ‰§è¡Œ</strong>çš„ï¼Œä½†å…è®¸ä½¿ç”¨å®šæ—¶å™¨æŒ‡å®šåœ¨æŸä¸ªæ—¶é—´ä¹‹åæˆ–æ¯éš”ä¸€æ®µæ—¶é—´å°± æ‰§è¡Œç›¸åº”çš„ä»£ç ã€‚setTimeout()ç”¨äºæŒ‡å®šåœ¨ä¸€å®šæ—¶é—´åæ‰§è¡ŒæŸäº›ä»£ç ï¼Œè€Œ setInterval()ç”¨äºæŒ‡å®š æ¯éš”ä¸€æ®µæ—¶é—´æ‰§è¡ŒæŸäº›ä»£ç ã€‚</p><p>setIntervale()åœ¨å®è·µä¸­å¾ˆå°‘ä¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ä½¿ç”¨ï¼Œ<strong>å› ä¸ºä¸€ä¸ªä»»åŠ¡ç»“æŸå’Œä¸‹ä¸€ä¸ªä»»åŠ¡å¼€å§‹ä¹‹é—´çš„æ—¶é—´é—´éš”æ˜¯æ— æ³•ä¿è¯çš„</strong>ï¼Œæœ‰äº›å¾ªç¯å®šæ—¶ä»»åŠ¡å¯èƒ½ä¼šå› æ­¤è€Œè¢«è·³è¿‡ã€‚</p><a href=#location-å¯¹è±¡><h3 id=location-å¯¹è±¡><span class=hanchor arialabel=Anchor># </span>location å¯¹è±¡</h3></a><p>location æ˜¯æœ€æœ‰ç”¨çš„ BOM å¯¹è±¡ä¹‹ä¸€ï¼Œæä¾›äº†å½“å‰çª—å£ä¸­åŠ è½½æ–‡æ¡£çš„ä¿¡æ¯ï¼Œä»¥åŠé€šå¸¸çš„å¯¼èˆªåŠŸèƒ½ã€‚</p><table><thead><tr><th>å± æ€§</th><th>å€¼</th><th>è¯´ æ˜</th></tr></thead><tbody><tr><td>location.hash "</td><td>&ldquo;#contents&rdquo;</td><td>URL æ•£åˆ—å€¼ï¼ˆäº•å·åè·Ÿé›¶æˆ–å¤šä¸ªå­—ç¬¦ï¼‰ï¼Œå¦‚æœæ²¡æœ‰åˆ™ ä¸ºç©ºå­—ç¬¦ä¸²</td></tr><tr><td>location.host</td><td>&ldquo;
<a href=https://www.wrox.com rel=noopener>www.wrox.com</a>:80&rdquo;</td><td>æœåŠ¡å™¨ååŠç«¯å£å·</td></tr><tr><td>location.hostname</td><td>&ldquo;
<a href=https://www.wrox.com rel=noopener>www.wrox.com</a>&rdquo;</td><td>æœåŠ¡å™¨å</td></tr><tr><td>location.href</td><td>&ldquo;
<a href=http://www.wrox.com:80/WileyCDA/ rel=noopener>http://www.wrox.com:80/WileyCDA/</a> ?q=javascript#contents&rdquo;</td><td>å½“å‰åŠ è½½é¡µé¢çš„å®Œæ•´ URLã€‚location çš„ toString()æ–¹æ³•è¿”å›è¿™ä¸ªå€¼</td></tr><tr><td>location.pathname</td><td>&ldquo;/WileyCDA/&rdquo;</td><td>&ldquo;/WileyCDA/&rdquo; URL ä¸­çš„è·¯å¾„å’Œï¼ˆæˆ–ï¼‰æ–‡ä»¶å</td></tr><tr><td>location.port</td><td>&ldquo;80&rdquo;</td><td>&ldquo;80&rdquo; è¯·æ±‚çš„ç«¯å£ã€‚å¦‚æœ URL ä¸­æ²¡æœ‰ç«¯å£ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸²</td></tr><tr><td>location.protocol</td><td>&ldquo;http:&rdquo;</td><td>&ldquo;http:&rdquo; é¡µé¢ä½¿ç”¨çš„åè®®ã€‚é€šå¸¸æ˜¯"http:&ldquo;æˆ–"https:&rdquo;</td></tr><tr><td>location.search</td><td>&ldquo;?q=javascript&rdquo;</td><td>&ldquo;?q=javascript&rdquo; URL çš„æŸ¥è¯¢å­—ç¬¦ä¸²ã€‚è¿™ä¸ªå­—ç¬¦ä¸²ä»¥é—®å·å¼€å¤´</td></tr><tr><td>location.username</td><td>&ldquo;foouser&rdquo;</td><td>&ldquo;foouser&rdquo; åŸŸåå‰æŒ‡å®šçš„ç”¨æˆ·å</td></tr><tr><td>location.password</td><td>&ldquo;barpassword&rdquo;</td><td>&ldquo;barpassword&rdquo; åŸŸåå‰æŒ‡å®šçš„å¯†ç </td></tr><tr><td>location.origin</td><td>&ldquo;
<a href=http://www.wrox.com rel=noopener>http://www.wrox.com</a>&rdquo;</td><td>&ldquo;
<a href=http://www.wrox.com rel=noopener>http://www.wrox.com</a>&rdquo; URL çš„æºåœ°å€ã€‚åªè¯»</td></tr></tbody></table><a href=#navigator-å¯¹è±¡><h3 id=navigator-å¯¹è±¡><span class=hanchor arialabel=Anchor># </span>navigator å¯¹è±¡</h3></a><p>å±æ€§å’Œæ–¹æ³•å¤ªå¤šå°±ä¸åˆ—äº†ï¼Œnavigator å¯¹è±¡çš„å±æ€§é€šå¸¸ç”¨äºç¡®å®šæµè§ˆå™¨çš„ç±»å‹ã€‚</p><a href=#æ£€æµ‹æ’ä»¶><h4 id=æ£€æµ‹æ’ä»¶><span class=hanchor arialabel=Anchor># </span>æ£€æµ‹æ’ä»¶</h4></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=c1>// æ’ä»¶æ£€æµ‹ï¼ŒIE10 åŠæ›´ä½ç‰ˆæœ¬æ— æ•ˆ
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>let</span> <span class=nx>hasPlugin</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>name</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span> <span class=o>=</span> <span class=nx>name</span><span class=p>.</span><span class=nx>toLowerCase</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=kd>let</span> <span class=nx>plugin</span> <span class=k>of</span> <span class=nb>window</span><span class=p>.</span><span class=nx>navigator</span><span class=p>.</span><span class=nx>plugins</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>plugin</span><span class=p>.</span><span class=nx>name</span><span class=p>.</span><span class=nx>toLowerCase</span><span class=p>().</span><span class=nx>indexOf</span><span class=p>(</span><span class=nx>name</span><span class=p>)</span> <span class=o>&gt;</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=kc>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// æ£€æµ‹ Flash
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>alert</span><span class=p>(</span><span class=nx>hasPlugin</span><span class=p>(</span><span class=s2>&#34;Flash&#34;</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=c1>// æ£€æµ‹ QuickTime
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>alert</span><span class=p>(</span><span class=nx>hasPlugin</span><span class=p>(</span><span class=s2>&#34;QuickTime&#34;</span><span class=p>));</span>
</span></span></code></pre></td></tr></table></div></div><a href=#screen-å¯¹è±¡><h3 id=screen-å¯¹è±¡><span class=hanchor arialabel=Anchor># </span>screen å¯¹è±¡</h3></a><p>è¿™ä¸ªå¯¹è±¡ä¸­ä¿å­˜çš„çº¯ç²¹æ˜¯å®¢æˆ·ç«¯èƒ½åŠ›ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯æµè§ˆå™¨çª—å£å¤–é¢çš„å®¢æˆ·ç«¯æ˜¾ç¤ºå™¨çš„ä¿¡æ¯ï¼Œæ¯”å¦‚åƒç´ å®½åº¦å’Œåƒç´ é«˜åº¦ã€‚</p><a href=#history-å¯¹è±¡><h3 id=history-å¯¹è±¡><span class=hanchor arialabel=Anchor># </span>history å¯¹è±¡</h3></a><p>history å¯¹è±¡è¡¨ç¤ºå½“å‰çª—å£é¦–æ¬¡ä½¿ç”¨ä»¥æ¥ç”¨æˆ·çš„å¯¼èˆªå†å²è®°å½•ã€‚å› ä¸º history æ˜¯ window çš„å±æ€§ï¼Œ æ‰€ä»¥æ¯ä¸ª window éƒ½æœ‰è‡ªå·±çš„ history å¯¹è±¡ã€‚å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œè¿™ä¸ªå¯¹è±¡ä¸ä¼šæš´éœ²ç”¨æˆ·è®¿é—®è¿‡çš„ URLï¼Œ ä½†å¯ä»¥é€šè¿‡å®ƒåœ¨ä¸çŸ¥é“å®é™… URL çš„æƒ…å†µä¸‹å‰è¿›å’Œåé€€ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=c1>// åé€€ä¸€é¡µ
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>history</span><span class=p>.</span><span class=nx>go</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>// å‰è¿›ä¸€é¡µ
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>history</span><span class=p>.</span><span class=nx>go</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>// å¯¼èˆªåˆ°æœ€è¿‘çš„ wrox.com é¡µé¢
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>history</span><span class=p>.</span><span class=nx>go</span><span class=p>(</span><span class=s2>&#34;wrox.com&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>// åé€€ä¸€é¡µ
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>history</span><span class=p>.</span><span class=nx>back</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=c1>// å‰è¿›ä¸€é¡µ
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>history</span><span class=p>.</span><span class=nx>forward</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><a href=#å®¢æˆ·ç«¯æ£€æµ‹><h2 id=å®¢æˆ·ç«¯æ£€æµ‹><span class=hanchor arialabel=Anchor># </span>å®¢æˆ·ç«¯æ£€æµ‹</h2></a><a href=#æµè§ˆå™¨æ£€æµ‹><h3 id=æµè§ˆå™¨æ£€æµ‹><span class=hanchor arialabel=Anchor># </span>æµè§ˆå™¨æ£€æµ‹</h3></a><p>æƒ³è¦çŸ¥é“è‡ªå·±ä»£ç è¿è¡Œåœ¨ä»€ä¹ˆæµè§ˆå™¨ä¸Šï¼Œå¤§éƒ¨åˆ†å¼€å‘è€…ä¼šåˆ†æ window.navigator.userAgent è¿”å›çš„å­—ç¬¦ä¸²å€¼ã€‚æ‰€æœ‰æµè§ˆå™¨éƒ½ä¼šæä¾›è¿™ä¸ªå€¼ï¼Œå¦‚æœç›¸ä¿¡è¿™äº›è¿”å›å€¼å¹¶åŸºäºç»™å®šçš„ä¸€ç»„æµè§ˆå™¨æ£€æµ‹è¿™ä¸ª å­—ç¬¦ä¸²ï¼Œæœ€ç»ˆä¼šå¾—åˆ°å…³äºæµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿçš„æ¯”è¾ƒç²¾ç¡®çš„ç»“æœã€‚</p><ol><li><p>ä¼ªé€ ç”¨æˆ·ä»£ç†</p><p>æœ‰äº›æµè§ˆå™¨æä¾›ä¼ªç§æœ‰çš„<strong>defineGetter</strong>æ–¹æ³•ï¼Œ åˆ©ç”¨å®ƒå¯ä»¥ç¯¡æ”¹ç”¨æˆ·ä»£ç†å­—ç¬¦ä¸²ï¼š</p></li><li><p>åˆ†ææµè§ˆå™¨</p><ul><li>æµè§ˆå™¨</li><li>æµè§ˆå™¨ç‰ˆæœ¬</li><li>æµè§ˆå™¨æ¸²æŸ“å¼•æ“</li><li>è®¾å¤‡ç±»å‹ï¼ˆæ¡Œé¢/ç§»åŠ¨ï¼‰</li><li>è®¾å¤‡ç”Ÿäº§å•†</li><li>è®¾å¤‡å‹å·</li><li>æ“ä½œç³»ç»Ÿ</li><li>æ“ä½œç³»ç»Ÿç‰ˆæœ¬</li></ul><p>ç¬¬ä¸‰æ–¹ç”¨æˆ·ä»£ç†è§£æç¨‹åºï¼šBowser ã€ UAParser.js ã€ Platform.js ã€ CURRENT-DEVICE ã€Google Closureã€ Mootools</p></li></ol><a href=#ç½‘ç»œæ£€æµ‹><h3 id=ç½‘ç»œæ£€æµ‹><span class=hanchor arialabel=Anchor># </span>ç½‘ç»œæ£€æµ‹</h3></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>connectionStateChange</span> <span class=o>=</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>navigator</span><span class=p>.</span><span class=nx>onLine</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nb>window</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;online&#39;</span><span class=p>,</span> <span class=nx>connectionStateChange</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nb>window</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;offline&#39;</span><span class=p>,</span> <span class=nx>connectionStateChange</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>NetworkInformation</strong> API : å¯ä»¥é€šè¿‡ navigator.connection å±æ€§ä½¿ç”¨ã€‚ è¿™ä¸ª API æä¾›äº†ä¸€äº›åªè¯»å±æ€§ï¼Œå¹¶ä¸ºè¿æ¥å±æ€§å˜åŒ–äº‹ä»¶å¤„ç†ç¨‹åºå®šä¹‰äº†ä¸€ä¸ªäº‹ä»¶å¯¹è±¡ã€‚</p><a href=#ç”µæ± æ£€æµ‹><h3 id=ç”µæ± æ£€æµ‹><span class=hanchor arialabel=Anchor># </span>ç”µæ± æ£€æµ‹</h3></a><p>navigator.getBattery()æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ª Promise å®ä¾‹ï¼Œè§£å†³ä¸ºä¸€ä¸ª BatteryManager å¯¹è±¡ã€‚</p><a href=#ç¡¬ä»¶æ£€æµ‹><h3 id=ç¡¬ä»¶æ£€æµ‹><span class=hanchor arialabel=Anchor># </span>ç¡¬ä»¶æ£€æµ‹</h3></a><p>æµè§ˆå™¨æ£€æµ‹ç¡¬ä»¶çš„èƒ½åŠ›ç›¸å½“æœ‰é™</p><ol><li><p><strong>å¤„ç†å™¨æ ¸å¿ƒæ•°</strong></p><p>navigator.hardwareConcurrency å±æ€§è¿”å›æµè§ˆå™¨æ”¯æŒçš„é€»è¾‘å¤„ç†å™¨æ ¸å¿ƒæ•°é‡ï¼ŒåŒ…å«è¡¨ç¤ºæ ¸å¿ƒæ•°çš„ä¸€ä¸ªæ•´æ•°å€¼ï¼ˆå¦‚æœæ ¸å¿ƒæ•°æ— æ³•ç¡®å®šï¼Œè¿™ä¸ªå€¼å°±æ˜¯ 1ï¼‰ã€‚å…³é”®åœ¨äºï¼Œè¿™ä¸ªå€¼è¡¨ç¤ºæµè§ˆå™¨å¯ä»¥å¹¶è¡Œæ‰§è¡Œçš„ æœ€å¤§å·¥ä½œçº¿ç¨‹æ•°é‡ï¼Œä¸ä¸€å®šæ˜¯å®é™…çš„ CPU æ ¸å¿ƒæ•°ã€‚</p></li><li><p><strong>è®¾å¤‡å†…å­˜å¤§å°</strong></p><p>navigator.deviceMemory å±æ€§è¿”å›è®¾å¤‡å¤§è‡´çš„ç³»ç»Ÿå†…å­˜å¤§å°ï¼ŒåŒ…å«å•ä½ä¸º GB çš„æµ®ç‚¹æ•°ï¼ˆèˆå…¥ ä¸ºæœ€æ¥è¿‘çš„ 2 çš„å¹‚ï¼š512MB è¿”å› 0.5ï¼Œ4GB è¿”å› 4ï¼‰ã€‚</p></li><li><p><strong>æœ€å¤§è§¦ç‚¹æ•°</strong></p><p>navigator.maxTouchPoints å±æ€§è¿”å›è§¦æ‘¸å±æ”¯æŒçš„æœ€å¤§å…³è”è§¦ç‚¹æ•°é‡ï¼ŒåŒ…å«ä¸€ä¸ªæ•´æ•°å€¼ã€‚</p></li></ol><a href=#dom><h2 id=dom><span class=hanchor arialabel=Anchor># </span>DOM</h2></a><a href=#æ“çºµèŠ‚ç‚¹><h3 id=æ“çºµèŠ‚ç‚¹><span class=hanchor arialabel=Anchor># </span>æ“çºµèŠ‚ç‚¹</h3></a><p><strong>appendChild</strong>() å’Œ <strong>insertBefore</strong>() åœ¨æ’å…¥èŠ‚ç‚¹æ—¶ä¸ä¼šåˆ é™¤ä»»ä½•å·²æœ‰èŠ‚ç‚¹ã€‚</p><p>ç›¸å¯¹åœ°ï¼Œ <strong>replaceChild</strong>()æ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šè¦æ’å…¥çš„èŠ‚ç‚¹å’Œè¦æ›¿æ¢çš„èŠ‚ç‚¹ã€‚è¦æ›¿æ¢çš„èŠ‚ç‚¹ä¼šè¢«è¿”å›å¹¶ä»æ–‡æ¡£ æ ‘ä¸­å®Œå…¨ç§»é™¤ï¼Œè¦æ’å…¥çš„èŠ‚ç‚¹ä¼šå–è€Œä»£ä¹‹ã€‚</p><p><strong>cloneNode</strong>()æ–¹æ³•æ¥æ”¶ä¸€ä¸ªå¸ƒå°”å€¼å‚æ•°ï¼Œè¡¨ç¤ºæ˜¯å¦æ·±å¤åˆ¶ã€‚åœ¨ä¼ å…¥ true å‚æ•°æ—¶ï¼Œä¼šè¿›è¡Œæ·±å¤åˆ¶ï¼Œ å³å¤åˆ¶èŠ‚ç‚¹åŠå…¶æ•´ä¸ªå­ DOM æ ‘ã€‚å¦‚æœä¼ å…¥ falseï¼Œåˆ™åªä¼šå¤åˆ¶è°ƒç”¨è¯¥æ–¹æ³•çš„èŠ‚ç‚¹ã€‚</p><a href=#documentfragment-ç±»å‹><h3 id=documentfragment-ç±»å‹><span class=hanchor arialabel=Anchor># </span>DocumentFragment ç±»å‹</h3></a><p>åœ¨æ‰€æœ‰èŠ‚ç‚¹ç±»å‹ä¸­ï¼ŒDocumentFragment ç±»å‹æ˜¯å”¯ä¸€ä¸€ä¸ªåœ¨æ ‡è®°ä¸­æ²¡æœ‰å¯¹åº”è¡¨ç¤ºçš„ç±»å‹ã€‚DOM å°† æ–‡æ¡£ç‰‡æ®µå®šä¹‰ä¸ºâ€œè½»é‡çº§â€æ–‡æ¡£ï¼Œèƒ½å¤ŸåŒ…å«å’Œæ“ä½œèŠ‚ç‚¹ï¼Œå´æ²¡æœ‰å®Œæ•´æ–‡æ¡£é‚£æ ·é¢å¤–çš„æ¶ˆè€—</p><p>å‡è®¾æƒ³ç»™ä¸€ä¸ªå…ƒç´ æ·»åŠ  3 ä¸ªåˆ—è¡¨é¡¹ã€‚å¦‚æœåˆ† 3 æ¬¡ç»™è¿™ä¸ªå…ƒç´ æ·»åŠ åˆ—è¡¨é¡¹ï¼Œæµè§ˆå™¨å°±è¦é‡æ–°æ¸²æŸ“ 3 æ¬¡é¡µé¢ï¼Œä»¥åæ˜ æ–°æ·»åŠ çš„å†…å®¹ã€‚ä¸ºé¿å…å¤šæ¬¡æ¸²æŸ“ï¼Œä¸‹é¢çš„ä»£ç ç¤ºä¾‹ä½¿ç”¨æ–‡æ¡£ç‰‡æ®µåˆ›å»ºäº†æ‰€æœ‰åˆ—è¡¨é¡¹ï¼Œ ç„¶åä¸€æ¬¡æ€§å°†å®ƒä»¬æ·»åŠ åˆ°äº†ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kd>let</span> <span class=nx>fragment</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>createDocumentFragment</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nx>ul</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>&#34;myList&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=p>(</span><span class=kd>let</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=mi>3</span><span class=p>;</span> <span class=o>++</span><span class=nx>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=kd>let</span> <span class=nx>li</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>createElement</span><span class=p>(</span><span class=s2>&#34;li&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl> <span class=nx>li</span><span class=p>.</span><span class=nx>appendChild</span><span class=p>(</span><span class=nb>document</span><span class=p>.</span><span class=nx>createTextNode</span><span class=p>(</span><span class=sb>`Item </span><span class=si>${</span><span class=nx>i</span> <span class=o>+</span> <span class=mi>1</span><span class=si>}</span><span class=sb>`</span><span class=p>));</span>
</span></span><span class=line><span class=cl> <span class=nx>fragment</span><span class=p>.</span><span class=nx>appendChild</span><span class=p>(</span><span class=nx>li</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>ul</span><span class=p>.</span><span class=nx>appendChild</span><span class=p>(</span><span class=nx>fragment</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><a href=#åŠ¨æ€è„šæœ¬><h3 id=åŠ¨æ€è„šæœ¬><span class=hanchor arialabel=Anchor># </span>åŠ¨æ€è„šæœ¬</h3></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>loadScript</span><span class=p>(</span><span class=nx>url</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=kd>let</span> <span class=nx>script</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>createElement</span><span class=p>(</span><span class=s2>&#34;script&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl> <span class=nx>script</span><span class=p>.</span><span class=nx>src</span> <span class=o>=</span> <span class=nx>url</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=nb>document</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>appendChild</span><span class=p>(</span><span class=nx>script</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><a href=#åŠ¨æ€-css><h3 id=åŠ¨æ€-css><span class=hanchor arialabel=Anchor># </span>åŠ¨æ€ css</h3></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>loadStyles</span><span class=p>(</span><span class=nx>url</span><span class=p>){</span>
</span></span><span class=line><span class=cl> <span class=kd>let</span> <span class=nx>link</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>createElement</span><span class=p>(</span><span class=s2>&#34;link&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl> <span class=nx>link</span><span class=p>.</span><span class=nx>rel</span> <span class=o>=</span> <span class=s2>&#34;stylesheet&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=nx>link</span><span class=p>.</span><span class=nx>type</span> <span class=o>=</span> <span class=s2>&#34;text/css&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=nx>link</span><span class=p>.</span><span class=nx>href</span> <span class=o>=</span> <span class=nx>url</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=kd>let</span> <span class=nx>head</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementsByTagName</span><span class=p>(</span><span class=s2>&#34;head&#34;</span><span class=p>)[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl> <span class=nx>head</span><span class=p>.</span><span class=nx>appendChild</span><span class=p>(</span><span class=nx>link</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><a href=#mutationobserver-æ¥å£><h3 id=mutationobserver-æ¥å£><span class=hanchor arialabel=Anchor># </span>MutationObserver æ¥å£</h3></a><p>åœ¨ DOM è¢«ä¿®æ”¹æ—¶å¼‚æ­¥æ‰§è¡Œå›è°ƒã€‚ä½¿ ç”¨ MutationObserver å¯ä»¥è§‚å¯Ÿæ•´ä¸ªæ–‡æ¡£ã€DOM æ ‘çš„ä¸€éƒ¨åˆ†ï¼Œæˆ–æŸä¸ªå…ƒç´ .</p><p>æ¯ä¸ªå›è°ƒéƒ½ä¼šæ”¶åˆ°ä¸€ä¸ª MutationRecord å®ä¾‹çš„æ•°ç»„ã€‚MutationRecord å®ä¾‹åŒ…å«çš„ä¿¡æ¯åŒ…æ‹¬å‘ ç”Ÿäº†ä»€ä¹ˆå˜åŒ–ï¼Œä»¥åŠ DOM çš„å“ªä¸€éƒ¨åˆ†å—åˆ°äº†å½±å“ã€‚</p><a href=#åŸºæœ¬ä½¿ç”¨><h4 id=åŸºæœ¬ä½¿ç”¨><span class=hanchor arialabel=Anchor># </span>åŸºæœ¬ä½¿ç”¨ï¼š</h4></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kd>let</span> <span class=nx>observer</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>MutationObserver</span><span class=p>(</span>
</span></span><span class=line><span class=cl> <span class=p>(</span><span class=nx>mutationRecords</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>mutationRecords</span><span class=p>));</span>
</span></span></code></pre></td></tr></table></div></div><a href=#observeæ–¹æ³•><h4 id=observeæ–¹æ³•><span class=hanchor arialabel=Anchor># </span>observe()æ–¹æ³•</h4></a><p>æ–°åˆ›å»ºçš„ MutationObserver å®ä¾‹ä¸ä¼šå…³è” DOM çš„ä»»ä½•éƒ¨åˆ†ã€‚è¦æŠŠè¿™ä¸ª observer ä¸ DOM å…³ è”èµ·æ¥ï¼Œéœ€è¦ä½¿ç”¨ observe()æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå¿…éœ€çš„å‚æ•°ï¼šè¦è§‚å¯Ÿå…¶å˜åŒ–çš„ DOM èŠ‚ç‚¹ï¼Œä»¥åŠ ä¸€ä¸ª MutationObserverInit å¯¹è±¡ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=nx>observer</span><span class=p>.</span><span class=nx>observe</span><span class=p>(</span><span class=nb>document</span><span class=p>.</span><span class=nx>body</span><span class=p>,</span> <span class=p>{</span> <span class=nx>attributes</span><span class=o>:</span> <span class=kc>true</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=nb>document</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>className</span> <span class=o>=</span> <span class=s1>&#39;foo&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Changed body class&#39;</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><a href=#disconnectæ–¹æ³•><h4 id=disconnectæ–¹æ³•><span class=hanchor arialabel=Anchor># </span>disconnect()æ–¹æ³•</h4></a><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œåªè¦è¢«è§‚å¯Ÿçš„å…ƒç´ ä¸è¢«åƒåœ¾å›æ”¶ï¼ŒMutationObserver çš„å›è°ƒå°±ä¼šå“åº” DOM å˜åŒ–äº‹ ä»¶ï¼Œä»è€Œè¢«æ‰§è¡Œã€‚è¦æå‰ç»ˆæ­¢æ‰§è¡Œå›è°ƒï¼Œå¯ä»¥è°ƒç”¨ disconnect()æ–¹æ³•ã€‚ä¸‹é¢çš„ä¾‹å­æ¼”ç¤ºäº†åŒæ­¥è°ƒç”¨ disconnect()ä¹‹åï¼Œä¸ä»…ä¼šåœæ­¢æ­¤åå˜åŒ–äº‹ä»¶çš„å›è°ƒï¼Œä¹Ÿä¼šæŠ›å¼ƒå·²ç»åŠ å…¥ä»»åŠ¡é˜Ÿåˆ—è¦å¼‚æ­¥æ‰§è¡Œçš„å›è°ƒï¼š</p><a href=#å¤ç”¨-mutationobserver><h4 id=å¤ç”¨-mutationobserver><span class=hanchor arialabel=Anchor># </span>å¤ç”¨ MutationObserver</h4></a><p>å¤šæ¬¡è°ƒç”¨ observe()æ–¹æ³•ï¼Œå¯ä»¥å¤ç”¨ä¸€ä¸ª MutationObserver å¯¹è±¡è§‚å¯Ÿå¤šä¸ªä¸åŒçš„ç›®æ ‡èŠ‚ç‚¹ã€‚æ­¤ æ—¶ï¼ŒMutationRecord çš„ target å±æ€§å¯ä»¥æ ‡è¯†å‘ç”Ÿå˜åŒ–äº‹ä»¶çš„ç›®æ ‡èŠ‚ç‚¹ã€‚ä¸‹é¢çš„ç¤ºä¾‹æ¼”ç¤ºäº†è¿™ä¸ªè¿‡ç¨‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kd>let</span> <span class=nx>observer</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>MutationObserver</span><span class=p>(</span>
</span></span><span class=line><span class=cl> <span class=p>(</span><span class=nx>mutationRecords</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>mutationRecords</span><span class=p>.</span><span class=nx>map</span><span class=p>((</span><span class=nx>x</span><span class=p>)</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl><span class=nx>x</span><span class=p>.</span><span class=nx>target</span><span class=p>)));</span>
</span></span><span class=line><span class=cl><span class=c1>// å‘é¡µé¢ä¸»ä½“æ·»åŠ ä¸¤ä¸ªå­èŠ‚ç‚¹
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>let</span> <span class=nx>childA</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>createElement</span><span class=p>(</span><span class=s1>&#39;div&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl> <span class=nx>childB</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>createElement</span><span class=p>(</span><span class=s1>&#39;span&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nb>document</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>appendChild</span><span class=p>(</span><span class=nx>childA</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nb>document</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>appendChild</span><span class=p>(</span><span class=nx>childB</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>// è§‚å¯Ÿä¸¤ä¸ªå­èŠ‚ç‚¹
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>observer</span><span class=p>.</span><span class=nx>observe</span><span class=p>(</span><span class=nx>childA</span><span class=p>,</span> <span class=p>{</span> <span class=nx>attributes</span><span class=o>:</span> <span class=kc>true</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=nx>observer</span><span class=p>.</span><span class=nx>observe</span><span class=p>(</span><span class=nx>childB</span><span class=p>,</span> <span class=p>{</span> <span class=nx>attributes</span><span class=o>:</span> <span class=kc>true</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=c1>// ä¿®æ”¹ä¸¤ä¸ªå­èŠ‚ç‚¹çš„å±æ€§
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>childA</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=s1>&#39;bar&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>childB</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=s1>&#39;bar&#39;</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><a href=#æ€§èƒ½å†…å­˜ä¸åƒåœ¾å›æ”¶><h4 id=æ€§èƒ½å†…å­˜ä¸åƒåœ¾å›æ”¶><span class=hanchor arialabel=Anchor># </span>æ€§èƒ½ã€å†…å­˜ä¸åƒåœ¾å›æ”¶</h4></a><ul><li>MutationObserver çš„å¼•ç”¨</li></ul><p>MutationObserver å®ä¾‹ä¸ç›®æ ‡èŠ‚ç‚¹ä¹‹é—´çš„å¼•ç”¨å…³ç³»æ˜¯éå¯¹ç§°çš„ã€‚MutationObserver æ‹¥æœ‰å¯¹è¦è§‚å¯Ÿçš„ç›®æ ‡èŠ‚ç‚¹çš„å¼±å¼•ç”¨ã€‚<strong>å› ä¸ºæ˜¯å¼±å¼•ç”¨ï¼Œæ‰€ä»¥ä¸ä¼šå¦¨ç¢åƒåœ¾å›æ”¶ç¨‹åºå›æ”¶ç›®æ ‡èŠ‚ç‚¹</strong>ã€‚</p><p>ç„¶è€Œï¼Œ<strong>ç›®æ ‡èŠ‚ç‚¹å´æ‹¥æœ‰å¯¹ MutationObserver çš„å¼ºå¼•ç”¨</strong>ã€‚å¦‚æœç›®æ ‡èŠ‚ç‚¹ä» DOM ä¸­è¢«ç§»é™¤ï¼Œéšå è¢«åƒåœ¾å›æ”¶ï¼Œåˆ™å…³è”çš„ MutationObserver ä¹Ÿä¼šè¢«åƒåœ¾å›æ”¶ã€‚</p><ul><li>MutationRecord çš„å¼•ç”¨</li></ul><p>è®°å½•é˜Ÿåˆ—ä¸­çš„æ¯ä¸ª MutationRecord å®ä¾‹è‡³å°‘åŒ…å«å¯¹å·²æœ‰ DOM èŠ‚ç‚¹çš„ä¸€ä¸ªå¼•ç”¨ã€‚å¦‚æœå˜åŒ–æ˜¯ childList ç±»å‹ï¼Œåˆ™ä¼šåŒ…å«å¤šä¸ªèŠ‚ç‚¹çš„å¼•ç”¨ã€‚è®°å½•é˜Ÿåˆ—å’Œå›è°ƒå¤„ç†çš„é»˜è®¤è¡Œä¸ºæ˜¯è€—å°½è¿™ä¸ªé˜Ÿåˆ—ï¼Œå¤„ç† æ¯ä¸ª MutationRecordï¼Œç„¶åè®©å®ƒä»¬è¶…å‡ºä½œç”¨åŸŸå¹¶è¢«åƒåœ¾å›æ”¶ã€‚</p><a href=#dom2><h3 id=dom2><span class=hanchor arialabel=Anchor># </span>DOM2</h3></a><p>// TODO: ä¸œè¥¿å¤ªå¤š ä¸‹æ¬¡ç”¨åˆ°å†çœ‹</p><a href=#dom3><h3 id=dom3><span class=hanchor arialabel=Anchor># </span>DOM3</h3></a><a href=#äº‹ä»¶><h2 id=äº‹ä»¶><span class=hanchor arialabel=Anchor># </span>äº‹ä»¶</h2></a><a href=#äº‹ä»¶å†’æ³¡><h3 id=äº‹ä»¶å†’æ³¡><span class=hanchor arialabel=Anchor># </span>äº‹ä»¶å†’æ³¡</h3></a><p>IE äº‹ä»¶æµè¢«ç§°ä¸ºäº‹ä»¶å†’æ³¡ï¼Œè¿™æ˜¯å› ä¸ºäº‹ä»¶è¢«å®šä¹‰ä¸ºä»æœ€å…·ä½“çš„å…ƒç´ ï¼ˆæ–‡æ¡£æ ‘ä¸­æœ€æ·±çš„èŠ‚ç‚¹ï¼‰å¼€å§‹è§¦ å‘ï¼Œç„¶åå‘ä¸Šä¼ æ’­è‡³æ²¡æœ‰é‚£ä¹ˆå…·ä½“çš„å…ƒç´ ï¼ˆæ–‡æ¡£ï¼‰ã€‚</p><a href=#äº‹ä»¶æ•è·><h3 id=äº‹ä»¶æ•è·><span class=hanchor arialabel=Anchor># </span>äº‹ä»¶æ•è·</h3></a><p>Netscape Communicator å›¢é˜Ÿæå‡ºäº†å¦ä¸€ç§åä¸ºäº‹ä»¶æ•è·çš„äº‹ä»¶æµã€‚äº‹ä»¶æ•è·çš„æ„æ€æ˜¯æœ€ä¸å…·ä½“çš„èŠ‚ ç‚¹åº”è¯¥æœ€å…ˆæ”¶åˆ°äº‹ä»¶ï¼Œè€Œæœ€å…·ä½“çš„èŠ‚ç‚¹åº”è¯¥æœ€åæ”¶åˆ°äº‹ä»¶ã€‚äº‹ä»¶æ•è·å®é™…ä¸Šæ˜¯ä¸ºäº†åœ¨äº‹ä»¶åˆ°è¾¾æœ€ç»ˆç›®æ ‡ å‰æ‹¦æˆªäº‹ä»¶ã€‚</p><a href=#dom-äº‹ä»¶æµ><h3 id=dom-äº‹ä»¶æµ><span class=hanchor arialabel=Anchor># </span>DOM äº‹ä»¶æµ</h3></a><p>DOM2 Events è§„èŒƒè§„å®šäº‹ä»¶æµåˆ†ä¸º 3 ä¸ªé˜¶æ®µï¼š<strong>äº‹ä»¶æ•è·</strong>ã€<strong>åˆ°è¾¾ç›®æ ‡</strong>å’Œ<strong>äº‹ä»¶å†’æ³¡</strong>ã€‚äº‹ä»¶æ•è·æœ€å…ˆå‘ç”Ÿï¼Œ ä¸ºæå‰æ‹¦æˆªäº‹ä»¶æä¾›äº†å¯èƒ½ã€‚ç„¶åï¼Œå®é™…çš„ç›®æ ‡å…ƒç´ æ¥æ”¶åˆ°äº‹ä»¶ã€‚æœ€åä¸€ä¸ªé˜¶æ®µæ˜¯å†’æ³¡ï¼Œæœ€è¿Ÿè¦åœ¨è¿™ä¸ªé˜¶æ®µå“åº”äº‹ä»¶ã€‚</p><a href=#dom2-äº‹ä»¶å¤„ç†ç¨‹åº><h3 id=dom2-äº‹ä»¶å¤„ç†ç¨‹åº><span class=hanchor arialabel=Anchor># </span>DOM2 äº‹ä»¶å¤„ç†ç¨‹åº</h3></a><p>DOM2 Events ä¸ºäº‹ä»¶å¤„ç†ç¨‹åºçš„èµ‹å€¼å’Œç§»é™¤å®šä¹‰äº†ä¸¤ä¸ªæ–¹æ³•ï¼š<strong>addEventListener</strong>()å’Œ <strong>removeEventListener</strong>()ã€‚è¿™ä¸¤ä¸ªæ–¹æ³•æš´éœ²åœ¨æ‰€æœ‰ DOM èŠ‚ç‚¹ä¸Šï¼Œå®ƒä»¬æ¥æ”¶ 3 ä¸ªå‚æ•°ï¼š<strong>äº‹ä»¶å</strong>ã€<strong>äº‹ä»¶å¤„ç†å‡½æ•°</strong>å’Œä¸€ä¸ªå¸ƒå°”å€¼ï¼Œtrue è¡¨ç¤ºåœ¨æ•<strong>è·é˜¶æ®µè°ƒç”¨äº‹ä»¶å¤„ç†ç¨‹åº</strong>ï¼Œfalseï¼ˆé»˜è®¤å€¼ï¼‰è¡¨ç¤ºåœ¨<strong>å†’æ³¡é˜¶æ®µè°ƒç”¨äº‹ä»¶å¤„ç†ç¨‹åº</strong>ã€‚</p><a href=#äº‹ä»¶ç±»å‹><h3 id=äº‹ä»¶ç±»å‹><span class=hanchor arialabel=Anchor># </span>äº‹ä»¶ç±»å‹</h3></a><ul><li><strong>ç”¨æˆ·ç•Œé¢äº‹ä»¶ï¼ˆUIEventï¼‰</strong>ï¼šæ¶‰åŠä¸ BOM äº¤äº’çš„é€šç”¨æµè§ˆå™¨äº‹ä»¶ã€‚</li><li><strong>ç„¦ç‚¹äº‹ä»¶ï¼ˆFocusEventï¼‰</strong>ï¼šåœ¨å…ƒç´ è·å¾—å’Œå¤±å»ç„¦ç‚¹æ—¶è§¦å‘ã€‚</li><li><strong>é¼ æ ‡äº‹ä»¶ï¼ˆMouseEventï¼‰</strong>ï¼šä½¿ç”¨é¼ æ ‡åœ¨é¡µé¢ä¸Šæ‰§è¡ŒæŸäº›æ“ä½œæ—¶è§¦å‘ã€‚</li><li><strong>æ»šè½®äº‹ä»¶ï¼ˆWheelEventï¼‰</strong>ï¼šä½¿ç”¨é¼ æ ‡æ»šè½®ï¼ˆæˆ–ç±»ä¼¼è®¾å¤‡ï¼‰æ—¶è§¦å‘ã€‚</li><li><strong>è¾“å…¥äº‹ä»¶ï¼ˆInputEventï¼‰</strong>ï¼šå‘æ–‡æ¡£ä¸­è¾“å…¥æ–‡æœ¬æ—¶è§¦å‘ã€‚</li><li><strong>é”®ç›˜äº‹ä»¶ï¼ˆKeyboardEventï¼‰</strong>ï¼šä½¿ç”¨é”®ç›˜åœ¨é¡µé¢ä¸Šæ‰§è¡ŒæŸäº›æ“ä½œæ—¶è§¦å‘</li><li><strong>åˆæˆäº‹ä»¶ï¼ˆCompositionEventï¼‰</strong>ï¼šåœ¨ä½¿ç”¨æŸç§ IMEï¼ˆInput Method Editorï¼Œè¾“å…¥æ³•ç¼–è¾‘å™¨ï¼‰è¾“å…¥ å­—ç¬¦æ—¶è§¦å‘ã€‚</li></ul><a href=#äº‹ä»¶å§”æ‰˜><h3 id=äº‹ä»¶å§”æ‰˜><span class=hanchor arialabel=Anchor># </span>äº‹ä»¶å§”æ‰˜</h3></a><p>â€œè¿‡å¤šäº‹ä»¶å¤„ç†ç¨‹åºâ€çš„è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨äº‹ä»¶å§”æ‰˜ã€‚äº‹ä»¶å§”æ‰˜<strong>åˆ©ç”¨äº‹ä»¶å†’æ³¡</strong>ï¼Œå¯ä»¥åªä½¿ç”¨ä¸€ä¸ªäº‹ä»¶å¤„ç†ç¨‹åºæ¥ç®¡ç†ä¸€ç§ç±»å‹çš„äº‹ä»¶ã€‚</p><a href=#åŠ¨ç”»ä¸-canvas-å›¾å½¢><h2 id=åŠ¨ç”»ä¸-canvas-å›¾å½¢><span class=hanchor arialabel=Anchor># </span>åŠ¨ç”»ä¸ Canvas å›¾å½¢</h2></a><a href=#requestanimationframe><h3 id=requestanimationframe><span class=hanchor arialabel=Anchor># </span>requestAnimationFrame</h3></a><p>è¿™ä¸ªæ–¹æ³•ä¼šå‘Šè¯‰æµè§ˆå™¨è¦æ‰§è¡ŒåŠ¨ç”» äº†ï¼Œäºæ˜¯æµè§ˆå™¨å¯ä»¥é€šè¿‡æœ€ä¼˜æ–¹å¼ç¡®å®šé‡ç»˜çš„æ—¶åºã€‚</p><p>requestAnimationFrame()æ–¹æ³•æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œæ­¤å‚æ•°æ˜¯ä¸€ä¸ªè¦åœ¨é‡ç»˜å±å¹•å‰è°ƒç”¨çš„å‡½æ•°ã€‚</p><a href=#cancelanimationframe><h4 id=cancelanimationframe><span class=hanchor arialabel=Anchor># </span>cancelAnimationFrame</h4></a><p>ä¸ setTimeout()ç±»ä¼¼ï¼ŒrequestAnimationFrame()ä¹Ÿè¿”å›ä¸€ä¸ªè¯·æ±‚ IDï¼Œå¯ä»¥ç”¨äºé€šè¿‡å¦ä¸€ä¸ª æ–¹æ³• cancelAnimationFrame()æ¥å–æ¶ˆé‡ç»˜ä»»åŠ¡ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kd>let</span> <span class=nx>requestID</span> <span class=o>=</span> <span class=nb>window</span><span class=p>.</span><span class=nx>requestAnimationFrame</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Repaint!&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl><span class=nb>window</span><span class=p>.</span><span class=nx>cancelAnimationFrame</span><span class=p>(</span><span class=nx>requestID</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><a href=#é€šè¿‡-requestanimationframe-èŠ‚æµ><h4 id=é€šè¿‡-requestanimationframe-èŠ‚æµ><span class=hanchor arialabel=Anchor># </span>é€šè¿‡ requestAnimationFrame èŠ‚æµ</h4></a><p>è¿™æ ·ï¼Œè®¡æ—¶å™¨å¯ä»¥é™åˆ¶å®é™…çš„æ“ä½œæ‰§è¡Œé—´éš”ï¼Œè€Œ requestAnimationFrame æ§åˆ¶ åœ¨æµè§ˆå™¨çš„å“ªä¸ªæ¸²æŸ“å‘¨æœŸä¸­æ‰§è¡Œã€‚ä¸‹é¢çš„ä¾‹å­å¯ä»¥å°†å›è°ƒé™åˆ¶ä¸ºä¸è¶…è¿‡ 50 æ¯«ç§’æ‰§è¡Œä¸€æ¬¡:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kd>let</span> <span class=nx>enabled</span> <span class=o>=</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>expensiveOperation</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Invoked at&#39;</span><span class=p>,</span> <span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>());</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nb>window</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;scroll&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=k>if</span> <span class=p>(</span><span class=nx>enabled</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>enabled</span> <span class=o>=</span> <span class=kc>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=nb>window</span><span class=p>.</span><span class=nx>requestAnimationFrame</span><span class=p>(</span><span class=nx>expensiveOperation</span><span class=p>);</span>
</span></span><span class=line><span class=cl> <span class=nb>window</span><span class=p>.</span><span class=nx>setTimeout</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=nx>enabled</span> <span class=o>=</span> <span class=kc>true</span><span class=p>,</span> <span class=mi>50</span><span class=p>);</span>
</span></span><span class=line><span class=cl> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><a href=#canvas><h3 id=canvas><span class=hanchor arialabel=Anchor># </span>Canvas</h3></a><p>//TODOï¼š äºŒæ¬¡é˜…è¯»æ—¶æ€»ç»“åå†å†™</p><a href=#webgl><h3 id=webgl><span class=hanchor arialabel=Anchor># </span>WebGL</h3></a><a href=#javascript-api><h2 id=javascript-api><span class=hanchor arialabel=Anchor># </span>JavaScript API</h2></a><a href=#streams-api><h3 id=streams-api><span class=hanchor arialabel=Anchor># </span>Streams API</h3></a><ul><li><strong>å¯è¯»æµ</strong>ï¼šå¯ä»¥é€šè¿‡æŸä¸ªå…¬å…±æ¥å£è¯»å–æ•°æ®å—çš„æµã€‚æ•°æ®åœ¨å†…éƒ¨ä»åº•å±‚æºè¿›å…¥æµï¼Œç„¶åç”±æ¶ˆè´¹è€… ï¼ˆconsumerï¼‰è¿›è¡Œå¤„ç†ã€‚</li><li><strong>å¯å†™æµ</strong>ï¼šå¯ä»¥é€šè¿‡æŸä¸ªå…¬å…±æ¥å£å†™å…¥æ•°æ®å—çš„æµã€‚ç”Ÿäº§è€…ï¼ˆproducerï¼‰å°†æ•°æ®å†™å…¥æµï¼Œæ•°æ®åœ¨å†… éƒ¨ä¼ å…¥åº•å±‚æ•°æ®æ§½ï¼ˆsinkï¼‰ã€‚</li><li><strong>è½¬æ¢æµ</strong>ï¼šç”±ä¸¤ç§æµç»„æˆï¼Œå¯å†™æµç”¨äºæ¥æ”¶æ•°æ®ï¼ˆå¯å†™ç«¯ï¼‰ï¼Œå¯è¯»æµç”¨äºè¾“å‡ºæ•°æ®ï¼ˆå¯è¯»ç«¯ï¼‰ã€‚è¿™ ä¸¤ä¸ªæµä¹‹é—´æ˜¯è½¬æ¢ç¨‹åºï¼ˆtransformerï¼‰ï¼Œå¯ä»¥æ ¹æ®éœ€è¦æ£€æŸ¥å’Œä¿®æ”¹æµå†…å®¹ã€‚</li></ul><p>å„å¤§æµè§ˆå™¨æ”¯æŒåº¦ä¸ä¸€ï¼ŒChrome æœ€æ–°ç‰ˆå·²ç»æ”¯æŒï¼Œnode å°šæœªæ”¯æŒã€‚</p><a href=#å¯è¯»æµ><h4 id=å¯è¯»æµ><span class=hanchor arialabel=Anchor># </span>å¯è¯»æµ</h4></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl>    <span class=c1>// æ¯ 1000 æ¯«ç§’ç”Ÿæˆä¸€ä¸ªé€’å¢çš„æ•´æ•°
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=p>(</span><span class=kd>let</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=mi>5</span><span class=p>;</span> <span class=o>++</span><span class=nx>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>yield</span> <span class=kr>await</span> <span class=k>new</span> <span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>setTimeout</span><span class=p>(</span><span class=nx>resolve</span><span class=p>,</span> <span class=mi>1000</span><span class=p>,</span> <span class=nx>i</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>readableStream</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>ReadableStream</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=kr>async</span> <span class=nx>start</span> <span class=p>(</span><span class=nx>controller</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=kr>await</span> <span class=p>(</span><span class=kd>let</span> <span class=nx>chunk</span> <span class=k>of</span> <span class=nx>ints</span><span class=p>())</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1>// å°†å€¼ä¼ å…¥æ§åˆ¶å™¨
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>controller</span><span class=p>.</span><span class=nx>enqueue</span><span class=p>(</span><span class=nx>chunk</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=nx>controller</span><span class=p>.</span><span class=nx>close</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>readableStream</span><span class=p>.</span><span class=nx>locked</span><span class=p>);</span> <span class=c1>// false
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>readableStreamDefaultReader</span> <span class=o>=</span> <span class=nx>readableStream</span><span class=p>.</span><span class=nx>getReader</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>readableStream</span><span class=p>.</span><span class=nx>locked</span><span class=p>);</span> <span class=c1>// true
</span></span></span><span class=line><span class=cl><span class=c1>// æ¶ˆè´¹è€…
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>(</span><span class=kr>async</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=p>(</span><span class=kc>true</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=p>{</span> <span class=nx>done</span><span class=p>,</span> <span class=nx>value</span> <span class=p>}</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>readableStreamDefaultReader</span><span class=p>.</span><span class=nx>read</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>done</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>value</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})();</span>
</span></span></code></pre></td></tr></table></div></div><a href=#å¯å†™æµ><h4 id=å¯å†™æµ><span class=hanchor arialabel=Anchor># </span>å¯å†™æµ</h4></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span><span class=o>*</span> <span class=nx>ints</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// æ¯ 1000 æ¯«ç§’ç”Ÿæˆä¸€ä¸ªé€’å¢çš„æ•´æ•°
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=p>(</span><span class=kd>let</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=mi>5</span><span class=p>;</span> <span class=o>++</span><span class=nx>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>yield</span> <span class=kr>await</span> <span class=k>new</span> <span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>setTimeout</span><span class=p>(</span><span class=nx>resolve</span><span class=p>,</span> <span class=mi>1000</span><span class=p>,</span> <span class=nx>i</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>writableStream</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>WritableStream</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>write</span> <span class=p>(</span><span class=nx>value</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>value</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>writableStream</span><span class=p>.</span><span class=nx>locked</span><span class=p>);</span> <span class=c1>// false
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>writableStreamDefaultWriter</span> <span class=o>=</span> <span class=nx>writableStream</span><span class=p>.</span><span class=nx>getWriter</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>writableStream</span><span class=p>.</span><span class=nx>locked</span><span class=p>);</span> <span class=c1>// true
</span></span></span><span class=line><span class=cl><span class=c1>// ç”Ÿäº§è€…
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>(</span><span class=kr>async</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=kr>await</span> <span class=p>(</span><span class=kd>let</span> <span class=nx>chunk</span> <span class=k>of</span> <span class=nx>ints</span><span class=p>())</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>await</span> <span class=nx>writableStreamDefaultWriter</span><span class=p>.</span><span class=nx>ready</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nx>writableStreamDefaultWriter</span><span class=p>.</span><span class=nx>write</span><span class=p>(</span><span class=nx>chunk</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>writableStreamDefaultWriter</span><span class=p>.</span><span class=nx>close</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>})();</span>
</span></span></code></pre></td></tr></table></div></div><a href=#è½¬æ¢æµ><h4 id=è½¬æ¢æµ><span class=hanchor arialabel=Anchor># </span>è½¬æ¢æµ</h4></a><p>è½¬æ¢æµç”¨äºç»„åˆå¯è¯»æµå’Œå¯å†™æµã€‚æ•°æ®å—åœ¨ä¸¤ä¸ªæµä¹‹é—´çš„è½¬æ¢æ˜¯é€šè¿‡ **transform()**æ–¹æ³•å®Œæˆçš„ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span><span class=o>*</span> <span class=nx>ints</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// æ¯ 1000 æ¯«ç§’ç”Ÿæˆä¸€ä¸ªé€’å¢çš„æ•´æ•°
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=p>(</span><span class=kd>let</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=mi>5</span><span class=p>;</span> <span class=o>++</span><span class=nx>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>yield</span> <span class=kr>await</span> <span class=k>new</span> <span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>setTimeout</span><span class=p>(</span><span class=nx>resolve</span><span class=p>,</span> <span class=mi>1000</span><span class=p>,</span> <span class=nx>i</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=p>{</span> <span class=nx>writable</span><span class=p>,</span> <span class=nx>readable</span> <span class=p>}</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>TransformStream</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>transform</span> <span class=p>(</span><span class=nx>chunk</span><span class=p>,</span> <span class=nx>controller</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>controller</span><span class=p>.</span><span class=nx>enqueue</span><span class=p>(</span><span class=nx>chunk</span> <span class=o>*</span> <span class=mi>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>readableStreamDefaultReader</span> <span class=o>=</span> <span class=nx>readable</span><span class=p>.</span><span class=nx>getReader</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>writableStreamDefaultWriter</span> <span class=o>=</span> <span class=nx>writable</span><span class=p>.</span><span class=nx>getWriter</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=c1>// æ¶ˆè´¹è€…
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>(</span><span class=kr>async</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=p>(</span><span class=kc>true</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=p>{</span> <span class=nx>done</span><span class=p>,</span> <span class=nx>value</span> <span class=p>}</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>readableStreamDefaultReader</span><span class=p>.</span><span class=nx>read</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>done</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>value</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})();</span>
</span></span><span class=line><span class=cl><span class=c1>// ç”Ÿäº§è€…
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>(</span><span class=kr>async</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=kr>await</span> <span class=p>(</span><span class=kd>let</span> <span class=nx>chunk</span> <span class=k>of</span> <span class=nx>ints</span><span class=p>())</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>await</span> <span class=nx>writableStreamDefaultWriter</span><span class=p>.</span><span class=nx>ready</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nx>writableStreamDefaultWriter</span><span class=p>.</span><span class=nx>write</span><span class=p>(</span><span class=nx>chunk</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>writableStreamDefaultWriter</span><span class=p>.</span><span class=nx>close</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>})();</span>
</span></span></code></pre></td></tr></table></div></div><a href=#é€šè¿‡ç®¡é“è¿æ¥æµ><h4 id=é€šè¿‡ç®¡é“è¿æ¥æµ><span class=hanchor arialabel=Anchor># </span>é€šè¿‡ç®¡é“è¿æ¥æµ</h4></a><p>æµå¯ä»¥é€šè¿‡ç®¡é“è¿æ¥æˆä¸€ä¸²ã€‚æœ€å¸¸è§çš„ç”¨ä¾‹æ˜¯ä½¿ç”¨ pipeThrough()æ–¹æ³•æŠŠ ReadableStream æ¥å…¥ TransformStreamã€‚ä»å†…éƒ¨çœ‹ï¼ŒReadableStream å…ˆæŠŠè‡ªå·±çš„å€¼ä¼ ç»™ TransformStream å†…éƒ¨çš„ WritableStreamï¼Œç„¶åæ‰§è¡Œè½¬æ¢ï¼Œæ¥ç€è½¬æ¢åçš„å€¼åˆåœ¨æ–°çš„ ReadableStream ä¸Šå‡ºç°ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span><span class=o>*</span> <span class=nx>ints</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// æ¯ 1000 æ¯«ç§’ç”Ÿæˆä¸€ä¸ªé€’å¢çš„æ•´æ•°
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=p>(</span><span class=kd>let</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=mi>5</span><span class=p>;</span> <span class=o>++</span><span class=nx>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>yield</span> <span class=kr>await</span> <span class=k>new</span> <span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>setTimeout</span><span class=p>(</span><span class=nx>resolve</span><span class=p>,</span> <span class=mi>1000</span><span class=p>,</span> <span class=nx>i</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>integerStream</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>ReadableStream</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=kr>async</span> <span class=nx>start</span> <span class=p>(</span><span class=nx>controller</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=kr>await</span> <span class=p>(</span><span class=kd>let</span> <span class=nx>chunk</span> <span class=k>of</span> <span class=nx>ints</span><span class=p>())</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>controller</span><span class=p>.</span><span class=nx>enqueue</span><span class=p>(</span><span class=nx>chunk</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=nx>controller</span><span class=p>.</span><span class=nx>close</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>doublingStream</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>TransformStream</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>transform</span> <span class=p>(</span><span class=nx>chunk</span><span class=p>,</span> <span class=nx>controller</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>controller</span><span class=p>.</span><span class=nx>enqueue</span><span class=p>(</span><span class=nx>chunk</span> <span class=o>*</span> <span class=mi>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl><span class=c1>// é€šè¿‡ç®¡é“è¿æ¥æµ
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>pipedStream</span> <span class=o>=</span> <span class=nx>integerStream</span><span class=p>.</span><span class=nx>pipeThrough</span><span class=p>(</span><span class=nx>doublingStream</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>// ä»è¿æ¥æµçš„è¾“å‡ºè·å¾—è¯»å–å™¨
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>pipedStreamDefaultReader</span> <span class=o>=</span> <span class=nx>pipedStream</span><span class=p>.</span><span class=nx>getReader</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=c1>// æ¶ˆè´¹è€…
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>(</span><span class=kr>async</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=p>(</span><span class=kc>true</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=p>{</span> <span class=nx>done</span><span class=p>,</span> <span class=nx>value</span> <span class=p>}</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>pipedStreamDefaultReader</span><span class=p>.</span><span class=nx>read</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>done</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>value</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})();</span>
</span></span></code></pre></td></tr></table></div></div><a href=#performance-timeline-api><h3 id=performance-timeline-api><span class=hanchor arialabel=Anchor># </span>Performance Timeline API</h3></a><p>Performance Timeline API ä½¿ç”¨ä¸€å¥—ç”¨äºåº¦é‡å®¢æˆ·ç«¯å»¶è¿Ÿçš„å·¥å…·æ‰©å±•äº† Performance æ¥å£ã€‚æ€§èƒ½åº¦ é‡å°†ä¼šé‡‡ç”¨è®¡ç®—ç»“æŸä¸å¼€å§‹æ—¶é—´å·®çš„å½¢å¼ã€‚</p><p>æµè§ˆå™¨ä¼šè‡ªåŠ¨è®°å½•å„ç§ PerformanceEntry å¯¹è±¡ï¼Œè€Œä½¿ç”¨ performance.mark()ä¹Ÿå¯ä»¥è®°å½•è‡ªå®š ä¹‰çš„ PerformanceEntry å¯¹è±¡ã€‚åœ¨ä¸€ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡ä¸­è¢«è®°å½•çš„æ‰€æœ‰æ€§èƒ½æ¡ç›®å¯ä»¥é€šè¿‡ **performance.getEntries()**è·å–</p><ol><li><strong>User Timing API</strong></li></ol><p>User Timing API ç”¨äºè®°å½•å’Œåˆ†æè‡ªå®šä¹‰æ€§èƒ½æ¡ç›®ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=nx>performance</span><span class=p>.</span><span class=nx>mark</span><span class=p>(</span><span class=s1>&#39;foo&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=p>(</span><span class=kd>let</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=mf>1E6</span><span class=p>;</span> <span class=o>++</span><span class=nx>i</span><span class=p>)</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=nx>performance</span><span class=p>.</span><span class=nx>mark</span><span class=p>(</span><span class=s1>&#39;bar&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>// è·å–æœ€æ–°çš„æ ‡è®°
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=p>[</span><span class=nx>endMark</span><span class=p>,</span> <span class=nx>startMark</span><span class=p>]</span> <span class=o>=</span> <span class=nx>performance</span><span class=p>.</span><span class=nx>getEntriesByType</span><span class=p>(</span><span class=s1>&#39;mark&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//è‡ªå®šä¹‰åå­—ï¼Œå’ŒmarkåŒºé—´
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>performance</span><span class=p>.</span><span class=nx>measure</span><span class=p>(</span><span class=s1>&#39;baz&#39;</span><span class=p>,</span> <span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=s1>&#39;bar&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=p>[</span><span class=nx>differenceMark</span><span class=p>]</span> <span class=o>=</span> <span class=nx>performance</span><span class=p>.</span><span class=nx>getEntriesByType</span><span class=p>(</span><span class=s1>&#39;measure&#39;</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><ol start=2><li><strong>Navigation Timing API</strong></li></ol><p>Navigation Timing API æä¾›äº†é«˜ç²¾åº¦æ—¶é—´æˆ³ï¼Œç”¨äºåº¦é‡å½“å‰é¡µé¢åŠ è½½é€Ÿåº¦ã€‚æµè§ˆå™¨ä¼šåœ¨å¯¼èˆªäº‹ä»¶å‘ç”Ÿæ—¶è‡ªåŠ¨è®°å½• PerformanceNavigationTiming æ¡ç›®ã€‚è¿™ä¸ªå¯¹è±¡ä¼šæ•è·å¤§é‡æ—¶é—´æˆ³ï¼Œ<strong>ç”¨äºæè¿°é¡µé¢æ˜¯ä½•æ—¶ä»¥åŠå¦‚ä½•åŠ è½½çš„ã€‚</strong></p><p>æ¯”å¦‚ load çš„æ—¶é—´å·®ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kr>const</span> <span class=p>[</span><span class=nx>performanceNavigationTimingEntry</span><span class=p>]</span> <span class=o>=</span> <span class=nx>performance</span><span class=p>.</span><span class=nx>getEntriesByType</span><span class=p>(</span><span class=s1>&#39;navigation&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>performanceNavigationTimingEntry</span><span class=p>.</span><span class=nx>loadEventEnd</span> <span class=o>-</span><span class=nx>performanceNavigationTimingEntry</span><span class=p>.</span><span class=nx>loadEventStart</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li><strong>Resource Timing API</strong></li></ol><p>Resource Timing API æä¾›äº†é«˜ç²¾åº¦æ—¶é—´æˆ³ï¼Œç”¨äºåº¦é‡å½“å‰é¡µé¢åŠ è½½æ—¶<strong>è¯·æ±‚èµ„æºçš„é€Ÿåº¦</strong>ã€‚æµè§ˆå™¨ä¼šåœ¨åŠ è½½èµ„æºæ—¶è‡ªåŠ¨è®°å½• PerformanceResourceTimingã€‚è¿™ä¸ªå¯¹è±¡ä¼šæ•è·å¤§é‡æ—¶é—´æˆ³ï¼Œ<strong>ç”¨äºæè¿°èµ„æºåŠ è½½çš„é€Ÿåº¦</strong>ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>performanceResourceTimingEntry</span> <span class=o>=</span> <span class=nx>performance</span><span class=p>.</span><span class=nx>getEntriesByType</span><span class=p>(</span><span class=s1>&#39;resource&#39;</span><span class=p>)[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>performanceResourceTimingEntry</span><span class=p>.</span><span class=nx>responseEnd</span> <span class=o>-</span> <span class=nx>performanceResourceTimingEntry</span><span class=p>.</span><span class=nx>requestStart</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><a href=#web-ç»„ä»¶><h3 id=web-ç»„ä»¶><span class=hanchor arialabel=Anchor># </span>Web ç»„ä»¶</h3></a><p>è¿™é‡Œæ‰€è¯´çš„ Web ç»„ä»¶æŒ‡çš„æ˜¯ä¸€å¥—ç”¨äºå¢å¼º DOM è¡Œä¸ºçš„å·¥å…·ï¼ŒåŒ…æ‹¬å½±å­ DOMã€è‡ªå®šä¹‰ å…ƒç´ å’Œ HTML æ¨¡æ¿ã€‚è¿™ä¸€å¥—æµè§ˆå™¨ API ç‰¹åˆ«æ··ä¹±ã€‚</p><ul><li><p>å¹¶æ²¡æœ‰ç»Ÿä¸€çš„â€œWeb Componentsâ€è§„èŒƒï¼šæ¯ä¸ª Web ç»„ä»¶éƒ½åœ¨ä¸€ä¸ªä¸åŒçš„è§„èŒƒä¸­å®šä¹‰ã€‚</p></li><li><p>æœ‰äº› Web ç»„ä»¶å¦‚å½±å­ DOM å’Œè‡ªå®šä¹‰å…ƒç´ ï¼Œå·²ç»å‡ºç°äº†å‘åä¸å…¼å®¹çš„ç‰ˆæœ¬é—®é¢˜ã€‚</p></li><li><p>æµè§ˆå™¨å®ç°æå…¶ä¸ä¸€è‡´</p></li></ul><p>ç”±äºå­˜åœ¨è¿™äº›é—®é¢˜ï¼Œå› æ­¤ä½¿ç”¨ Web ç»„ä»¶é€šå¸¸éœ€è¦å¼•å…¥ä¸€ä¸ª Web ç»„ä»¶åº“ï¼Œæ¯”å¦‚ Polymerã€‚è¿™ç§åº“å¯ä»¥ ä½œä¸ºè…»å­è„šæœ¬ï¼Œæ¨¡æ‹Ÿæµè§ˆå™¨ä¸­ç¼ºå¤±çš„ Web ç»„ä»¶</p><a href=#html-æ¨¡æ¿><h4 id=html-æ¨¡æ¿><span class=hanchor arialabel=Anchor># </span>HTML æ¨¡æ¿</h4></a><a href=#å½±å­-dom><h4 id=å½±å­-dom><span class=hanchor arialabel=Anchor># </span>å½±å­ DOM</h4></a><a href=#è‡ªå®šä¹‰å…ƒç´ ><h4 id=è‡ªå®šä¹‰å…ƒç´ ><span class=hanchor arialabel=Anchor># </span>è‡ªå®šä¹‰å…ƒç´ </h4></a><a href=#web-cryptography-api><h3 id=web-cryptography-api><span class=hanchor arialabel=Anchor># </span>Web Cryptography API</h3></a><a href=#ç”Ÿæˆéšæœºæ•°><h4 id=ç”Ÿæˆéšæœºæ•°><span class=hanchor arialabel=Anchor># </span>ç”Ÿæˆéšæœºæ•°</h4></a><p>æˆ‘ä»¬å¹³æ—¶å¸¸ç”¨çš„ math.random() æ˜¯ä»¥<strong>ä¼ªéšæœºæ•°ç”Ÿæˆå™¨ PRNG</strong>ç”Ÿæˆçš„ã€‚æ‰€è°“â€œä¼ªâ€æŒ‡çš„æ˜¯ç”Ÿæˆå€¼çš„è¿‡ç¨‹ä¸æ˜¯çœŸçš„éšæœºã€‚ PRNG ç”Ÿæˆçš„å€¼åªæ˜¯æ¨¡æ‹Ÿäº†éšæœºçš„ç‰¹æ€§ã€‚æµè§ˆå™¨çš„ PRNG å¹¶æœªä½¿ç”¨çœŸæ­£çš„éšæœºæºï¼Œåªæ˜¯å¯¹ä¸€ä¸ªå†…éƒ¨çŠ¶æ€ åº”ç”¨äº†å›ºå®šçš„ç®—æ³•ã€‚æ¯æ¬¡è°ƒç”¨ Math.random()ï¼Œè¿™ä¸ªå†…éƒ¨çŠ¶æ€éƒ½ä¼šè¢«ä¸€ä¸ªç®—æ³•ä¿®æ”¹ï¼Œè€Œç»“æœä¼šè¢«è½¬æ¢ ä¸ºä¸€ä¸ªæ–°çš„éšæœºå€¼ã€‚ä¾‹å¦‚ï¼ŒV8 å¼•æ“ä½¿ç”¨äº†ä¸€ä¸ªåä¸º xorshift128+çš„ç®—æ³•æ¥æ‰§è¡Œè¿™ç§ä¿®æ”¹ã€‚</p><p>ç”±äºç®—æ³•æœ¬èº«æ˜¯å›ºå®šçš„ï¼Œå…¶è¾“å…¥åªæ˜¯ä¹‹å‰çš„çŠ¶æ€ï¼Œå› æ­¤éšæœºæ•°é¡ºåºä¹Ÿæ˜¯ç¡®å®šçš„ã€‚xorshift128+ä½¿ç”¨ 128 ä½å†…éƒ¨çŠ¶æ€ï¼Œè€Œç®—æ³•çš„è®¾è®¡è®©ä»»ä½•åˆå§‹çŠ¶æ€åœ¨é‡å¤è‡ªèº«ä¹‹å‰éƒ½ä¼šäº§ç”Ÿ 2128â€“1 ä¸ªä¼ªéšæœºå€¼ã€‚è¿™ç§å¾ªç¯ è¢«ç§°ä¸º<strong>ç½®æ¢å¾ªç¯</strong>ï¼ˆpermutation cycleï¼‰ï¼Œè€Œè¿™ä¸ªå¾ªç¯çš„é•¿åº¦è¢«ç§°ä¸ºä¸€ä¸ª<strong>å‘¨æœŸ</strong>ï¼ˆperiodï¼‰ã€‚å¾ˆæ˜æ˜¾ï¼Œå¦‚æœæ”»å‡» è€…çŸ¥é“ PRNG çš„å†…éƒ¨çŠ¶æ€ï¼Œå°±å¯ä»¥é¢„æµ‹åç»­ç”Ÿæˆçš„ä¼ªéšæœºå€¼ã€‚å¦‚æœå¼€å‘è€…æ— æ„ä¸­ä½¿ç”¨ PRNG ç”Ÿæˆäº†ç§æœ‰ å¯†é’¥ç”¨äºåŠ å¯†ï¼Œåˆ™æ”»å‡»è€…å°±å¯ä»¥åˆ©ç”¨ PRNG çš„è¿™ä¸ªç‰¹æ€§ç®—å‡ºç§æœ‰å¯†é’¥ã€‚</p><p>ä¼ªéšæœºæ•°ç”Ÿæˆå™¨ä¸»è¦ç”¨äºå¿«é€Ÿè®¡ç®—å‡ºçœ‹èµ·æ¥éšæœºçš„å€¼ã€‚ä¸è¿‡å¹¶ä¸é€‚åˆç”¨äºåŠ å¯†è®¡ç®—ã€‚ä¸ºè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯†ç å­¦å®‰å…¨ä¼ªéšæœºæ•°ç”Ÿæˆå™¨ï¼ˆCSPRNGï¼ŒCryptographically Secure PseudoRandom Number Generatorï¼‰ é¢å¤–å¢åŠ äº†ä¸€ä¸ªç†µä½œä¸ºè¾“å…¥ï¼Œä¾‹å¦‚æµ‹è¯•ç¡¬ä»¶æ—¶é—´æˆ–å…¶ä»–æ— æ³•é¢„è®¡è¡Œä¸ºçš„ç³»ç»Ÿç‰¹æ€§ã€‚è¿™æ ·ä¸€æ¥ï¼Œè®¡ç®—é€Ÿåº¦ æ˜æ˜¾æ¯”å¸¸è§„ PRNG æ…¢å¾ˆå¤šï¼Œä½† CSPRNG ç”Ÿæˆçš„å€¼å°±å¾ˆéš¾é¢„æµ‹ï¼Œå¯ä»¥ç”¨äºåŠ å¯†äº†ã€‚</p><a href=#ä½¿ç”¨><h4 id=ä½¿ç”¨><span class=hanchor arialabel=Anchor># </span>ä½¿ç”¨</h4></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>array</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Uint8Array</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=p>(</span><span class=kd>let</span> <span class=nx>i</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span> <span class=nx>i</span><span class=o>&lt;</span><span class=mi>5</span><span class=p>;</span> <span class=o>++</span><span class=nx>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>crypto</span><span class=p>.</span><span class=nx>getRandomValues</span><span class=p>(</span><span class=nx>array</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// Uint8Array [41]
</span></span></span><span class=line><span class=cl><span class=c1>// Uint8Array [250]
</span></span></span><span class=line><span class=cl><span class=c1>// Uint8Array [51]
</span></span></span><span class=line><span class=cl><span class=c1>// Uint8Array [129]
</span></span></span><span class=line><span class=cl><span class=c1>// Uint8Array [35]
</span></span></span></code></pre></td></tr></table></div></div><a href=#å°ç»“><h3 id=å°ç»“><span class=hanchor arialabel=Anchor># </span>å°ç»“</h3></a><p>é™¤äº†å®šä¹‰æ–°æ ‡ç­¾ï¼ŒHTML5 è¿˜å®šä¹‰äº†ä¸€äº› JavaScript APIã€‚è¿™äº› API å¯ä»¥ä¸ºå¼€å‘è€…æä¾›æ›´ä¾¿æ·çš„ Web æ¥å£ï¼Œæš´éœ²å ªæ¯”æ¡Œé¢åº”ç”¨çš„èƒ½åŠ›ã€‚æœ¬ç« ä¸»è¦ä»‹ç»äº†ä»¥ä¸‹ APIã€‚</p><ul><li>Atomics API ç”¨äºä¿æŠ¤ä»£ç åœ¨å¤šçº¿ç¨‹å†…å­˜è®¿é—®æ¨¡å¼ä¸‹ä¸å‘ç”Ÿèµ„æºäº‰ç”¨ã€‚</li><li>postMessage() API æ”¯æŒä»ä¸åŒæºè·¨æ–‡æ¡£å‘é€æ¶ˆæ¯ï¼ŒåŒæ—¶ä¿è¯å®‰å…¨å’Œéµå¾ªåŒæºç­–ç•¥ã€‚</li><li>Encoding API ç”¨äºå®ç°å­—ç¬¦ä¸²ä¸ç¼“å†²åŒºä¹‹é—´çš„æ— ç¼è½¬æ¢ï¼ˆè¶Šæ¥è¶Šå¸¸è§çš„æ“ä½œï¼‰ã€‚</li><li>File API æä¾›äº†å‘é€ã€æ¥æ”¶å’Œè¯»å–å¤§å‹äºŒè¿›åˆ¶å¯¹è±¡çš„å¯é å·¥å…·ã€‚</li><li>åª’ä½“å…ƒç´ <code>&lt;audio></code>å’Œ<code>&lt;video></code>æ‹¥æœ‰è‡ªå·±çš„ APIï¼Œç”¨äºæ“ä½œéŸ³é¢‘å’Œè§†é¢‘ã€‚å¹¶ä¸æ˜¯æ¯ä¸ªæµè§ˆå™¨éƒ½ä¼šæ”¯
æŒæ‰€æœ‰åª’ä½“æ ¼å¼ï¼Œä½¿ç”¨ canPlayType()æ–¹æ³•å¯ä»¥æ£€æµ‹æµè§ˆå™¨æ”¯æŒæƒ…å†µã€‚</li><li>æ‹–æ”¾ API æ”¯æŒæ–¹ä¾¿åœ°å°†å…ƒç´ æ ‡è¯†ä¸ºå¯æ‹–åŠ¨ï¼Œå¹¶åœ¨æ“ä½œç³»ç»Ÿå®Œæˆæ”¾ç½®æ—¶ç»™å‡ºå›åº”ã€‚å¯ä»¥åˆ©ç”¨å®ƒåˆ›
å»ºè‡ªå®šä¹‰å¯æ‹–åŠ¨å…ƒç´ å’Œæ”¾ç½®ç›®æ ‡ã€‚</li><li>Notifications API æä¾›äº†ä¸€ç§æµè§ˆå™¨ä¸­ç«‹çš„æ–¹å¼ï¼Œä»¥æ­¤å‘ç”¨æˆ·å±•ç¤ºæ¶ˆé€šçŸ¥å¼¹å±‚ã€‚</li><li>Streams API æ”¯æŒä»¥å…¨æ–°çš„æ–¹å¼è¯»å–ã€å†™å…¥å’Œå¤„ç†æ•°æ®ã€‚</li><li>Timing API æä¾›äº†ä¸€ç»„åº¦é‡æ•°æ®è¿›å‡ºæµè§ˆå™¨æ—¶é—´çš„å¯é å·¥å…·ã€‚</li><li>Web Components API ä¸ºå…ƒç´ é‡ç”¨å’Œå°è£…æŠ€æœ¯å‘å‰è¿ˆè¿›æä¾›äº†æœ‰åŠ›æ”¯æ’‘ã€‚</li><li>Web Cryptography API è®©ç”Ÿæˆéšæœºæ•°ã€åŠ å¯†å’Œç­¾åæ¶ˆæ¯æˆä¸ºä¸€ç±»ç‰¹æ€§ã€‚</li></ul><a href=#é”™è¯¯å¤„ç†å’Œè°ƒè¯•><h2 id=é”™è¯¯å¤„ç†å’Œè°ƒè¯•><span class=hanchor arialabel=Anchor># </span>é”™è¯¯å¤„ç†å’Œè°ƒè¯•</h2></a><a href=#trycatch><h3 id=trycatch><span class=hanchor arialabel=Anchor># </span>try/catch</h3></a><p>å¦‚æœ try å—ä¸­æœ‰ä»£ç å‘ç”Ÿé”™è¯¯ï¼Œä»£ç ä¼šç«‹å³é€€å‡ºæ‰§è¡Œï¼Œå¹¶è·³åˆ° catch å—ä¸­ã€‚catch å—æ­¤æ—¶æ¥æ”¶åˆ° ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«å‘ç”Ÿé”™è¯¯çš„ç›¸å…³ä¿¡æ¯ã€‚ä¸å…¶ä»–è¯­è¨€ä¸åŒï¼Œå³ä½¿åœ¨ catch å—ä¸­ä¸ä½¿ç”¨é”™è¯¯å¯¹è±¡ï¼Œ ä¹Ÿå¿…é¡»ä¸ºå®ƒå®šä¹‰åç§°ã€‚é”™è¯¯å¯¹è±¡ä¸­æš´éœ²çš„å®é™…ä¿¡æ¯å› æµè§ˆå™¨è€Œå¼‚ï¼Œä½†è‡³å°‘åŒ…å«ä¿å­˜é”™è¯¯æ¶ˆæ¯çš„ message å±æ€§ã€‚</p><a href=#finally><h4 id=finally><span class=hanchor arialabel=Anchor># </span>finally</h4></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>testFinally</span><span class=p>(){</span>
</span></span><span class=line><span class=cl> <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=k>return</span> <span class=mi>2</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>){</span>
</span></span><span class=line><span class=cl> <span class=k>return</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=p>}</span> <span class=k>finally</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>çœ‹èµ·æ¥è¯¥å‡½æ•°åº”è¯¥è¿”å› 2ï¼Œ å› ä¸ºå®ƒåœ¨ try å—ä¸­ï¼Œä¸ä¼šå¯¼è‡´é”™è¯¯ã€‚ä½†æ˜¯ï¼Œfinally å—çš„å­˜åœ¨å¯¼è‡´ try å—ä¸­çš„ return è¯­å¥è¢«å¿½ç•¥ã€‚</p><a href=#é”™è¯¯ç±»å‹><h4 id=é”™è¯¯ç±»å‹><span class=hanchor arialabel=Anchor># </span>é”™è¯¯ç±»å‹</h4></a><ul><li><strong>Error</strong> æ˜¯åŸºç±»å‹ï¼Œå…¶ä»–é”™è¯¯ç±»å‹ç»§æ‰¿è¯¥ç±»å‹.æµè§ˆå™¨å¾ˆå°‘ä¼šæŠ›å‡º Error ç±»å‹çš„é”™è¯¯ï¼Œè¯¥ç±»å‹ä¸»è¦ç”¨äºå¼€ å‘è€…æŠ›å‡ºè‡ªå®šä¹‰é”™è¯¯ã€‚</li><li><strong>InternalError</strong> ç±»å‹çš„é”™è¯¯ä¼šåœ¨åº•å±‚ JavaScript å¼•æ“æŠ›å‡ºå¼‚å¸¸æ—¶ç”±æµè§ˆå™¨æŠ›å‡ºã€‚ä¾‹å¦‚ï¼Œé€’å½’è¿‡å¤šå¯¼ è‡´äº†æ ˆæº¢å‡ºã€‚è¿™ä¸ªç±»å‹å¹¶ä¸æ˜¯ä»£ç ä¸­é€šå¸¸è¦å¤„ç†çš„é”™è¯¯ï¼Œå¦‚æœçœŸå‘ç”Ÿäº†è¿™ç§é”™è¯¯ï¼Œå¾ˆå¯èƒ½ä»£ç å“ªé‡Œå¼„é”™ äº†æˆ–è€…æœ‰å±é™©äº†ã€‚</li><li><strong>EvalError</strong> ç±»å‹çš„é”™è¯¯ä¼šåœ¨ä½¿ç”¨ eval()å‡½æ•°å‘ç”Ÿå¼‚å¸¸æ—¶æŠ›å‡ºã€‚</li><li><strong>RangeError</strong> é”™è¯¯ä¼šåœ¨æ•°å€¼è¶Šç•Œæ—¶æŠ›å‡ºã€‚ä¾‹å¦‚ï¼Œå®šä¹‰æ•°ç»„æ—¶å¦‚æœè®¾ç½®äº†å¹¶ä¸æ”¯æŒçš„é•¿åº¦ï¼Œ</li><li><strong>ReferenceError</strong> ä¼šåœ¨æ‰¾ä¸åˆ°å¯¹è±¡æ—¶å‘ç”Ÿã€‚ï¼ˆè¿™å°±æ˜¯è‘—åçš„"object expected"æµè§ˆå™¨é”™è¯¯çš„åŸ å› ã€‚ï¼‰è¿™ç§é”™è¯¯ç»å¸¸æ˜¯ç”±è®¿é—®ä¸å­˜åœ¨çš„å˜é‡è€Œå¯¼è‡´çš„</li><li><strong>SyntaxError</strong> ç»å¸¸åœ¨ç»™ eval()ä¼ å…¥çš„å­—ç¬¦ä¸²åŒ…å« JavaScript è¯­æ³•é”™è¯¯æ—¶å‘ç”Ÿ</li><li>**TypeError **åœ¨ JavaScript ä¸­å¾ˆå¸¸è§ï¼Œä¸»è¦å‘ç”Ÿåœ¨å˜é‡ä¸æ˜¯é¢„æœŸç±»å‹ï¼Œæˆ–è€…è®¿é—®ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶ã€‚å¾ˆ å¤šåŸå› å¯èƒ½å¯¼è‡´è¿™ç§é”™è¯¯ï¼Œå°¤å…¶æ˜¯åœ¨ä½¿ç”¨ç±»å‹ç‰¹å®šçš„æ“ä½œè€Œå˜é‡ç±»å‹ä¸å¯¹æ—¶ã€‚</li><li><strong>URIError</strong> åªä¼šåœ¨ä½¿ç”¨ encodeURI()æˆ– decodeURI()ä½†ä¼ å…¥äº†æ ¼å¼é”™è¯¯çš„ URI æ—¶å‘ç”Ÿã€‚è¿™ä¸ªé”™è¯¯ææ€•æ˜¯ JavaScript ä¸­éš¾å¾—ä¸€è§çš„é”™è¯¯äº†ï¼Œå› ä¸ºä¸Šé¢è¿™ä¸¤ä¸ªå‡½æ•°éå¸¸ç¨³å¥</li></ul><a href=#trycatch-çš„ç”¨æ³•><h4 id=trycatch-çš„ç”¨æ³•><span class=hanchor arialabel=Anchor># </span>try/catch çš„ç”¨æ³•</h4></a><p><strong>try/catch è¯­å¥æœ€å¥½ç”¨åœ¨è‡ªå·±æ— æ³•æ§åˆ¶çš„é”™è¯¯ä¸Š</strong>ã€‚å¦‚æœä½ æ˜ç¡®çŸ¥é“è‡ªå·±çš„ä»£ç ä¼šå‘ç”ŸæŸç§é”™è¯¯ï¼Œé‚£ä¹ˆå°±ä¸é€‚åˆä½¿ç”¨ try/catch è¯­å¥ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç»™ å‡½æ•°ä¼ å…¥å­—ç¬¦ä¸²è€Œä¸æ˜¯æ•°å€¼æ—¶å°±ä¼šå¤±è´¥ï¼Œå°±åº”è¯¥æ£€æŸ¥è¯¥å‡½æ•°çš„å‚æ•°ç±»å‹å¹¶é‡‡å–ç›¸åº”çš„æ“ä½œã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œ æ²¡æœ‰å¿…è¦ä½¿ç”¨ try/catch è¯­å¥ã€‚</p><a href=#æŠ›å‡ºé”™è¯¯-1><h3 id=æŠ›å‡ºé”™è¯¯-1><span class=hanchor arialabel=Anchor># </span>æŠ›å‡ºé”™è¯¯</h3></a><p>ä¸ try/catch è¯­å¥å¯¹åº”çš„ä¸€ä¸ªæœºåˆ¶æ˜¯ throw æ“ä½œç¬¦ï¼Œç”¨äºåœ¨ä»»ä½•æ—¶å€™æŠ›å‡ºè‡ªå®šä¹‰é”™è¯¯ã€‚throw æ“ ä½œç¬¦å¿…é¡»æœ‰ä¸€ä¸ªå€¼ï¼Œä½†å€¼çš„ç±»å‹ä¸é™ã€‚</p><p>ä½¿ç”¨ throw æ“ä½œç¬¦æ—¶ï¼Œä»£ç ç«‹å³åœæ­¢æ‰§è¡Œï¼Œé™¤é try/catch è¯­å¥æ•è·äº†æŠ›å‡ºçš„å€¼ã€‚</p><p>å¯ä»¥é€šè¿‡å†…ç½®çš„é”™è¯¯ç±»å‹æ¥æ¨¡æ‹Ÿæµè§ˆå™¨é”™è¯¯ã€‚æ¯ç§é”™è¯¯ç±»å‹çš„æ„é€ å‡½æ•°éƒ½åªæ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œå°±æ˜¯é”™è¯¯æ¶ˆæ¯ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=k>throw</span> <span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=s2>&#34;Something bad happened.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>// or
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>throw</span> <span class=k>new</span> <span class=nx>SyntaxError</span><span class=p>(</span><span class=s2>&#34;I don&#39;t like your syntax.&#34;</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>æˆ–è€…é€šè¿‡ç»§æ‰¿ error è‡ªå®šä¹‰ä¸€ä¸ªé”™è¯¯,éœ€è¦æä¾› name å±æ€§å’Œ message å±æ€§</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kr>class</span> <span class=nx>CustomError</span> <span class=kr>extends</span> <span class=nb>Error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>constructor</span><span class=p>(</span><span class=nx>message</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=kr>super</span><span class=p>(</span><span class=nx>message</span><span class=p>);</span>
</span></span><span class=line><span class=cl> <span class=k>this</span><span class=p>.</span><span class=nx>name</span> <span class=o>=</span> <span class=s2>&#34;CustomError&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=k>this</span><span class=p>.</span><span class=nx>message</span> <span class=o>=</span> <span class=nx>message</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><a href=#ä½•æ—¶æŠ›å‡º><h4 id=ä½•æ—¶æŠ›å‡º><span class=hanchor arialabel=Anchor># </span>ä½•æ—¶æŠ›å‡º</h4></a><p>ä¸€ä¸ªå¸¸è§çš„é—®é¢˜æ˜¯ä½•æ—¶æŠ›å‡ºé”™è¯¯ï¼Œä½•æ—¶ä½¿ç”¨ try/catch æ•è·é”™è¯¯ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œé”™è¯¯è¦åœ¨åº”ç”¨ç¨‹åº æ¶æ„çš„åº•å±‚æŠ›å‡ºï¼Œåœ¨è¿™ä¸ªå±‚é¢ä¸Šï¼Œäººä»¬å¯¹æ­£åœ¨è¿›è¡Œçš„æµç¨‹çŸ¥ä¹‹ç”šå°‘ï¼Œå› æ­¤æ— æ³•çœŸæ­£åœ°å¤„ç†é”™è¯¯ã€‚</p><p>è‡³äºæŠ›å‡ºé”™è¯¯ä¸æ•è·é”™è¯¯çš„åŒºåˆ«ï¼Œå¯ä»¥è¿™æ ·æƒ³ï¼šåº”è¯¥åªåœ¨ç¡®åˆ‡çŸ¥é“æ¥ä¸‹æ¥è¯¥åšä»€ä¹ˆçš„æ—¶å€™æ•è·é”™è¯¯ã€‚æ•è·é”™è¯¯çš„ç›®çš„æ˜¯é˜»æ­¢æµè§ˆå™¨ä»¥å…¶é»˜è®¤æ–¹å¼å“åº”ï¼›æŠ›å‡ºé”™è¯¯çš„ç›®çš„æ˜¯ä¸ºé”™è¯¯æä¾›æœ‰å…³å…¶å‘ç”ŸåŸå› çš„ è¯´æ˜ã€‚</p><a href=#error-äº‹ä»¶><h3 id=error-äº‹ä»¶><span class=hanchor arialabel=Anchor># </span>error äº‹ä»¶</h3></a><p><strong>ä»»ä½•æ²¡æœ‰è¢« try/catch è¯­å¥å¤„ç†çš„é”™è¯¯éƒ½ä¼šåœ¨ window å¯¹è±¡ä¸Šè§¦å‘ error äº‹ä»¶</strong>ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=nb>window</span><span class=p>.</span><span class=nx>onerror</span> <span class=o>=</span> <span class=p>(</span><span class=nx>message</span><span class=p>,</span> <span class=nx>url</span><span class=p>,</span> <span class=nx>line</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=c1>// é”™è¯¯æ¶ˆæ¯ã€å‘ç”Ÿé”™è¯¯çš„ URL å’Œè¡Œå·
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>message</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>// å¯ä»¥è¿”å› false æ¥é˜»æ­¢æµè§ˆå™¨é»˜è®¤æŠ¥å‘Šé”™è¯¯çš„è¡Œä¸ºï¼Œ
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=k>return</span> <span class=kc>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><a href=#è¯†åˆ«é”™è¯¯><h3 id=è¯†åˆ«é”™è¯¯><span class=hanchor arialabel=Anchor># </span>è¯†åˆ«é”™è¯¯</h3></a><p>é”™è¯¯å¤„ç†éå¸¸é‡è¦çš„éƒ¨åˆ†æ˜¯é¦–å…ˆè¯†åˆ«é”™è¯¯å¯èƒ½ä¼šåœ¨ä»£ç ä¸­çš„ä»€ä¹ˆåœ°æ–¹å‘ç”Ÿã€‚å› ä¸º JavaScript æ˜¯æ¾æ•£ ç±»å‹çš„ï¼Œä¸ä¼šéªŒè¯å‡½æ•°å‚æ•°ï¼Œ<strong>æ‰€ä»¥å¾ˆå¤šé”™è¯¯åªæœ‰åœ¨ä»£ç çœŸæ­£è¿è¡Œèµ·æ¥æ—¶æ‰ä¼šå‡ºç°</strong>ã€‚é€šå¸¸ï¼Œéœ€è¦æ³¨æ„ 3 ç±»é”™è¯¯ï¼š</p><ul><li><p>ç±»å‹è½¬æ¢é”™è¯¯</p></li><li><p>æ•°æ®ç±»å‹é”™è¯¯</p></li><li><p>é€šä¿¡é”™è¯¯</p></li></ul><p>ä¸Šé¢è¿™å‡ ç§é”™è¯¯ä¼šåœ¨ç‰¹å®šæƒ…å†µä¸‹ï¼Œåœ¨æ²¡æœ‰å¯¹å€¼è¿›è¡Œå……åˆ†æ£€æµ‹æ—¶å‘ç”Ÿã€‚</p><a href=#é™æ€ä»£ç åˆ†æå™¨><h4 id=é™æ€ä»£ç åˆ†æå™¨><span class=hanchor arialabel=Anchor># </span>é™æ€ä»£ç åˆ†æå™¨</h4></a><p>é™æ€ä»£ç åˆ†æå™¨è¦æ±‚ä½¿ç”¨ç±»å‹ã€å‡½æ•°ç­¾ååŠå…¶ä»–æŒ‡ä»¤æ¥æ³¨è§£ JavaScriptï¼Œä»¥æ­¤æè¿°ç¨‹åºå¦‚ä½•åœ¨åŸºæœ¬ å¯æ‰§è¡Œä»£ç ä¹‹å¤–è¿è¡Œã€‚åˆ†æå™¨ä¼šæ¯”è¾ƒæ³¨è§£å’Œ JavaScript ä»£ç çš„å„ä¸ªéƒ¨åˆ†ï¼Œå¯¹åœ¨å®é™…è¿è¡Œæ—¶å¯èƒ½å‡ºç°çš„æ½œ åœ¨ä¸å…¼å®¹é—®é¢˜ç»™å‡ºæé†’ã€‚</p><p>å¸¸ç”¨ï¼šJSHintã€JSLintã€Google Closure å’Œ TypeScript.</p><a href=#ç±»å‹è½¬æ¢é”™è¯¯><h4 id=ç±»å‹è½¬æ¢é”™è¯¯><span class=hanchor arialabel=Anchor># </span>ç±»å‹è½¬æ¢é”™è¯¯</h4></a><p>ç±»å‹è½¬æ¢é”™è¯¯çš„ä¸»è¦åŸå› æ˜¯ä½¿ç”¨äº†ä¼šè‡ªåŠ¨æ”¹å˜æŸä¸ªå€¼çš„æ•°æ®ç±»å‹çš„æ“ä½œç¬¦æˆ–è¯­è¨€æ„é€ ã€‚ä½¿ç”¨äº† == æˆ– ï¼=ã€ä»¥åŠåœ¨ ifã€for æˆ– while ç­‰æµæ§åˆ¶è¯­å¥ä¸­ä½¿ç”¨éå¸ƒå°”å€¼</p><a href=#æ•°æ®ç±»å‹é”™è¯¯><h4 id=æ•°æ®ç±»å‹é”™è¯¯><span class=hanchor arialabel=Anchor># </span>æ•°æ®ç±»å‹é”™è¯¯</h4></a><p>å› ä¸º JavaScript æ˜¯æ¾æ•£ç±»å‹çš„ï¼Œæ‰€ä»¥å˜é‡å’Œå‡½æ•°å‚æ•°éƒ½ä¸èƒ½ä¿è¯ä¼šä½¿ç”¨æ­£ç¡®çš„æ•°æ®ç±»å‹ã€‚å¼€å‘è€…éœ€ è¦è‡ªå·±æ£€æŸ¥æ•°æ®ç±»å‹ï¼Œç¡®ä¿ä¸ä¼šå‘ç”Ÿé”™è¯¯ã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼ŒåŸå§‹ç±»å‹çš„å€¼åº”è¯¥ä½¿ç”¨ typeof æ£€æµ‹ï¼Œè€Œå¯¹è±¡å€¼åº”è¯¥ä½¿ç”¨ instanceof æ£€æµ‹ã€‚æ ¹æ®å‡½æ•° çš„ç”¨æ³•ï¼Œä¸ä¸€å®šè¦æ£€æŸ¥æ¯ä¸ªå‚æ•°çš„æ•°æ®ç±»å‹ï¼Œä½†å¯¹å¤–çš„ä»»ä½• API éƒ½åº”è¯¥åšç±»å‹æ£€æŸ¥ä»¥ä¿è¯æ­£ç¡®æ‰§è¡Œã€‚</p><a href=#é€šä¿¡é”™è¯¯><h4 id=é€šä¿¡é”™è¯¯><span class=hanchor arialabel=Anchor># </span>é€šä¿¡é”™è¯¯</h4></a><a href=#json><h2 id=json><span class=hanchor arialabel=Anchor># </span>JSON</h2></a><p>JSON è¯­æ³•æ”¯æŒè¡¨ç¤º 3 ç§ç±»å‹çš„å€¼ã€‚</p><ul><li>ç®€å•å€¼ï¼šå­—ç¬¦ä¸²ã€æ•°å€¼ã€å¸ƒå°”å€¼å’Œ null å¯ä»¥åœ¨ JSON ä¸­å‡ºç°ï¼Œå°±åƒåœ¨ JavaScript ä¸­ä¸€æ ·ã€‚ç‰¹æ®Š å€¼ <strong>undefined ä¸å¯ä»¥</strong>ã€‚</li><li>å¯¹è±¡ï¼šç¬¬ä¸€ç§å¤æ‚æ•°æ®ç±»å‹ï¼Œå¯¹è±¡è¡¨ç¤ºæœ‰åºé”®/å€¼å¯¹ã€‚æ¯ä¸ªå€¼å¯ä»¥æ˜¯ç®€å•å€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤æ‚ç±»å‹ã€‚</li><li>æ•°ç»„ï¼šç¬¬äºŒç§å¤æ‚æ•°æ®ç±»å‹ï¼Œæ•°ç»„è¡¨ç¤ºå¯ä»¥é€šè¿‡æ•°å€¼ç´¢å¼•è®¿é—®çš„å€¼çš„æœ‰åºåˆ—è¡¨ã€‚æ•°ç»„çš„å€¼å¯ä»¥ æ˜¯ä»»æ„ç±»å‹ï¼ŒåŒ…æ‹¬ç®€å•å€¼ã€å¯¹è±¡ï¼Œç”šè‡³å…¶ä»–æ•°ç»„ã€‚</li></ul><a href=#json-å¯¹è±¡><h3 id=json-å¯¹è±¡><span class=hanchor arialabel=Anchor># </span>JSON å¯¹è±¡</h3></a><p>JSON å¯¹è±¡æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼šstringify()å’Œ parse()ã€‚åœ¨ç®€å•çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•åˆ†åˆ«å¯ä»¥å°† JavaScript åºåˆ—åŒ–ä¸º JSON å­—ç¬¦ä¸²ï¼Œä»¥åŠå°† JSON è§£æä¸ºåŸç”Ÿ JavaScript å€¼ã€‚</p><p>å®é™…ä¸Šï¼Œ**JSON.stringify()**æ–¹æ³•é™¤äº†è¦åºåˆ—åŒ–çš„å¯¹è±¡ï¼Œè¿˜å¯ä»¥æ¥æ”¶ä¸¤ä¸ªå‚æ•°ã€‚è¿™ä¸¤ä¸ªå‚æ•°å¯ä»¥ç”¨ äºæŒ‡å®šå…¶ä»–åºåˆ—åŒ– JavaScript å¯¹è±¡çš„æ–¹å¼ã€‚<strong>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¿‡æ»¤å™¨ï¼Œå¯ä»¥æ˜¯æ•°ç»„æˆ–å‡½æ•°ï¼›ç¬¬äºŒä¸ªå‚æ•°æ˜¯ç”¨äºç¼©è¿›ç»“æœ JSON å­—ç¬¦ä¸²çš„é€‰é¡¹ã€‚å•ç‹¬æˆ–ç»„åˆä½¿ç”¨è¿™äº›å‚æ•°å¯ä»¥æ›´å¥½åœ°æ§åˆ¶ JSON åºåˆ—åŒ–ã€‚</strong></p><p>æœ‰æ—¶å€™ï¼Œå¯¹è±¡éœ€è¦åœ¨ JSON.stringify()ä¹‹ä¸Šè‡ªå®šä¹‰ JSON åºåˆ—åŒ–ã€‚æ­¤æ—¶ï¼Œå¯ä»¥åœ¨è¦åºåˆ—åŒ–çš„å¯¹è±¡ ä¸­æ·»åŠ  **toJSON()**æ–¹æ³•ï¼Œåºåˆ—åŒ–æ—¶ä¼šåŸºäºè¿™ä¸ªæ–¹æ³•è¿”å›é€‚å½“çš„ JSON è¡¨ç¤ºã€‚</p><p>**JSON.parse()**æ–¹æ³•ä¹Ÿå¯ä»¥æ¥æ”¶ä¸€ä¸ªé¢å¤–çš„å‚æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼šé’ˆå¯¹æ¯ä¸ªé”®/å€¼å¯¹éƒ½è°ƒç”¨ä¸€æ¬¡ã€‚ä¸ºåŒºåˆ« äºä¼ ç»™ JSON.stringify()çš„èµ·è¿‡æ»¤ä½œç”¨çš„æ›¿ä»£å‡½æ•°ï¼ˆreplacerï¼‰ï¼Œè¿™ä¸ªå‡½æ•°è¢«ç§°ä¸ºè¿˜åŸå‡½æ•°ï¼ˆreviverï¼‰ã€‚ å®é™…ä¸Šå®ƒä»¬çš„æ ¼å¼å®Œå…¨ä¸€æ ·ï¼Œå³è¿˜åŸå‡½æ•°ä¹Ÿæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œå±æ€§åï¼ˆkeyï¼‰å’Œå±æ€§å€¼ï¼ˆvalueï¼‰ï¼Œå¦å¤–ä¹Ÿ éœ€è¦è¿”å›å€¼ã€‚</p><a href=#ç½‘ç»œè¯·æ±‚ä¸è¿œç¨‹èµ„æº><h2 id=ç½‘ç»œè¯·æ±‚ä¸è¿œç¨‹èµ„æº><span class=hanchor arialabel=Anchor># </span>ç½‘ç»œè¯·æ±‚ä¸è¿œç¨‹èµ„æº</h2></a><a href=#xhr--xmlhttprequest--å¯¹è±¡><h3 id=xhr--xmlhttprequest--å¯¹è±¡><span class=hanchor arialabel=Anchor># </span>XHR ( XMLHttpRequest ) å¯¹è±¡</h3></a><p>çœ‹äº†ä¸‹ ä¼šç”¨å°±è¡Œäº†</p><a href=#è¿›åº¦äº‹ä»¶><h3 id=è¿›åº¦äº‹ä»¶><span class=hanchor arialabel=Anchor># </span>è¿›åº¦äº‹ä»¶</h3></a><p>Progress Events æ˜¯ W3C çš„å·¥ä½œè‰æ¡ˆï¼Œå®šä¹‰äº†å®¢æˆ·ç«¯ ï€­ æœåŠ¡å™¨ç«¯é€šä¿¡ã€‚è¿™äº›äº‹ä»¶æœ€åˆåªé’ˆå¯¹ XHRï¼Œç° åœ¨ä¹Ÿæ¨å¹¿åˆ°äº†å…¶ä»–ç±»ä¼¼çš„ APIã€‚æœ‰ä»¥ä¸‹ 6 ä¸ªè¿›åº¦ç›¸å…³çš„äº‹ä»¶ã€‚</p><ul><li><p>loadstartï¼šåœ¨æ¥æ”¶åˆ°å“åº”çš„ç¬¬ä¸€ä¸ªå­—èŠ‚æ—¶è§¦å‘ã€‚</p></li><li><p>progressï¼šåœ¨æ¥æ”¶å“åº”æœŸé—´åå¤è§¦å‘ã€‚</p></li><li><p>errorï¼šåœ¨è¯·æ±‚å‡ºé”™æ—¶è§¦å‘ã€‚</p></li><li><p>abortï¼šåœ¨è°ƒç”¨ abort()ç»ˆæ­¢è¿æ¥æ—¶è§¦å‘ã€‚</p></li><li><p>loadï¼šåœ¨æˆåŠŸæ¥æ”¶å®Œå“åº”æ—¶è§¦å‘ã€‚</p></li><li><p>loadendï¼šåœ¨é€šä¿¡å®Œæˆæ—¶ï¼Œä¸”åœ¨ errorã€abort æˆ– load ä¹‹åè§¦å‘ã€‚</p></li></ul><p>æ¯æ¬¡è¯·æ±‚éƒ½ä¼šé¦–å…ˆè§¦å‘ loadstart äº‹ä»¶ï¼Œä¹‹åæ˜¯ä¸€ä¸ªæˆ–å¤šä¸ª progress äº‹ä»¶ï¼Œæ¥ç€æ˜¯ errorã€abort æˆ– load ä¸­çš„ä¸€ä¸ªï¼Œæœ€åä»¥ loadend äº‹ä»¶ç»“æŸã€‚</p><a href=#load-äº‹ä»¶><h4 id=load-äº‹ä»¶><span class=hanchor arialabel=Anchor># </span>load äº‹ä»¶</h4></a><p>onload äº‹ä»¶å¤„ç†ç¨‹åºä¼šæ”¶åˆ°ä¸€ä¸ª event å¯¹è±¡ï¼Œå…¶ target å±æ€§è®¾ç½®ä¸º XHR å®ä¾‹ï¼Œåœ¨è¿™ä¸ªå®ä¾‹ä¸Š å¯ä»¥è®¿é—®æ‰€æœ‰ XHR å¯¹è±¡å±æ€§å’Œæ–¹æ³•ã€‚</p><a href=#progress-äº‹ä»¶><h4 id=progress-äº‹ä»¶><span class=hanchor arialabel=Anchor># </span>progress äº‹ä»¶</h4></a><p>Mozilla åœ¨ XHR å¯¹è±¡ä¸Šå¦ä¸€ä¸ªåˆ›æ–°æ˜¯ progress äº‹ä»¶ï¼Œåœ¨æµè§ˆå™¨æ¥æ”¶æ•°æ®æœŸé—´ï¼Œè¿™ä¸ªäº‹ä»¶ä¼šåå¤è§¦ å‘ã€‚æ¯æ¬¡è§¦å‘æ—¶ï¼Œonprogress äº‹ä»¶å¤„ç†ç¨‹åºéƒ½ä¼šæ”¶åˆ° event å¯¹è±¡ï¼Œå…¶ target å±æ€§æ˜¯ XHR å¯¹è±¡ï¼Œä¸” åŒ…å« 3 ä¸ªé¢å¤–å±æ€§ï¼š<strong>lengthComputable</strong>ã€<strong>position</strong> å’Œ <strong>totalSize</strong>ã€‚å…¶ä¸­</p><ul><li>lengthComputable æ˜¯ ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¿›åº¦ä¿¡æ¯æ˜¯å¦å¯ç”¨ï¼›</li><li>position æ˜¯æ¥æ”¶åˆ°çš„å­—èŠ‚æ•°ï¼›</li><li>totalSize æ˜¯å“åº”çš„ ContentLength å¤´éƒ¨å®šä¹‰çš„æ€»å­—èŠ‚æ•°</li></ul><a href=#è·¨æºèµ„æºå…±äº«><h3 id=è·¨æºèµ„æºå…±äº«><span class=hanchor arialabel=Anchor># </span>è·¨æºèµ„æºå…±äº«</h3></a><p>è·¨æºèµ„æºå…±äº«ï¼ˆCORSï¼ŒCross-Origin Resource Sharingï¼‰å®šä¹‰äº†æµè§ˆå™¨ä¸æœåŠ¡å™¨å¦‚ä½•å®ç°è·¨æºé€šä¿¡ã€‚ CORS èƒŒåçš„åŸºæœ¬æ€è·¯å°±æ˜¯ä½¿ç”¨è‡ªå®šä¹‰çš„ HTTP å¤´éƒ¨å…è®¸æµè§ˆå™¨å’ŒæœåŠ¡å™¨ç›¸äº’äº†è§£ï¼Œä»¥ç¡®å®è¯·æ±‚æˆ–å“åº” åº”è¯¥æˆåŠŸè¿˜æ˜¯å¤±è´¥ã€‚</p><p>å¯¹äºç®€å•çš„è¯·æ±‚ï¼Œæ¯”å¦‚ <strong>GET æˆ– POST è¯·æ±‚ï¼Œæ²¡æœ‰è‡ªå®šä¹‰å¤´éƒ¨ï¼Œè€Œä¸”è¯·æ±‚ä½“æ˜¯ text/plain ç±»å‹</strong>ï¼Œ è¿™æ ·çš„è¯·æ±‚åœ¨å‘é€æ—¶ä¼šæœ‰ä¸€ä¸ªé¢å¤–çš„å¤´éƒ¨å« Originã€‚Origin å¤´éƒ¨åŒ…å«å‘é€è¯·æ±‚çš„é¡µé¢çš„æºï¼ˆåè®®ã€ åŸŸåå’Œç«¯å£ï¼‰ï¼Œä»¥ä¾¿æœåŠ¡å™¨ç¡®å®šæ˜¯å¦ä¸ºå…¶æä¾›å“åº”ã€‚</p><p>å¦‚æœæœåŠ¡å™¨å†³å®šå“åº”è¯·æ±‚ï¼Œé‚£ä¹ˆåº”è¯¥å‘é€ Access-Control-Allow-Origin å¤´éƒ¨.</p><a href=#é¢„æ£€è¯·æ±‚><h4 id=é¢„æ£€è¯·æ±‚><span class=hanchor arialabel=Anchor># </span>é¢„æ£€è¯·æ±‚</h4></a><p>CORS é€šè¿‡ä¸€ç§å«é¢„æ£€è¯·æ±‚ï¼ˆpreflighted requestï¼‰çš„æœåŠ¡å™¨éªŒè¯æœºåˆ¶ï¼Œå…è®¸ä½¿ç”¨è‡ªå®šä¹‰å¤´éƒ¨ã€é™¤ GET å’Œ POST ä¹‹å¤–çš„æ–¹æ³•ï¼Œä»¥åŠä¸åŒè¯·æ±‚ä½“å†…å®¹ç±»å‹ã€‚åœ¨è¦å‘é€æ¶‰åŠä¸Šè¿°æŸç§é«˜çº§é€‰é¡¹çš„è¯·æ±‚æ—¶ï¼Œä¼šå…ˆå‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªâ€œé¢„æ£€â€è¯·æ±‚ã€‚è¿™ä¸ªè¯·æ±‚ä½¿ç”¨ OPTIONS æ–¹æ³•å‘é€å¹¶åŒ…å«ä»¥ä¸‹å¤´éƒ¨ã€‚</p><ul><li><strong>Origin</strong>ï¼šä¸ç®€å•è¯·æ±‚ç›¸åŒã€‚</li><li><strong>Access-Control-Request-Method</strong>ï¼šè¯·æ±‚å¸Œæœ›ä½¿ç”¨çš„æ–¹æ³•ã€‚</li><li><strong>Access-Control-Request-Headers</strong>ï¼šï¼ˆå¯é€‰ï¼‰è¦ä½¿ç”¨çš„é€—å·åˆ†éš”çš„è‡ªå®šä¹‰å¤´éƒ¨åˆ—è¡¨</li></ul><p>åœ¨è¿™ä¸ªè¯·æ±‚å‘é€åï¼ŒæœåŠ¡å™¨å¯ä»¥ç¡®å®šæ˜¯å¦å…è®¸è¿™ç§ç±»å‹çš„è¯·æ±‚ã€‚æœåŠ¡å™¨ä¼šé€šè¿‡åœ¨å“åº”ä¸­å‘é€å¦‚ä¸‹å¤´éƒ¨ä¸æµè§ˆå™¨æ²Ÿé€šè¿™äº›ä¿¡æ¯ã€‚</p><ul><li>Access-Control-Allow-Originï¼šä¸ç®€å•è¯·æ±‚ç›¸åŒã€‚</li><li>Access-Control-Allow-Methodsï¼šå…è®¸çš„æ–¹æ³•ï¼ˆé€—å·åˆ†éš”çš„åˆ—è¡¨ï¼‰ã€‚</li><li>Access-Control-Allow-Headersï¼šæœåŠ¡å™¨å…è®¸çš„å¤´éƒ¨ï¼ˆé€—å·åˆ†éš”çš„åˆ—è¡¨ï¼‰ã€‚</li><li>Access-Control-Max-Ageï¼šç¼“å­˜é¢„æ£€è¯·æ±‚çš„ç§’æ•°ã€‚</li></ul><p>é¢„æ£€è¯·æ±‚è¿”å›åï¼Œç»“æœä¼šæŒ‰å“åº”æŒ‡å®šçš„æ—¶é—´ç¼“å­˜ä¸€æ®µæ—¶é—´ã€‚æ¢å¥è¯è¯´ï¼Œ<strong>åªæœ‰ç¬¬ä¸€æ¬¡å‘é€è¿™ç§ç±»å‹çš„ è¯·æ±‚æ—¶æ‰ä¼šå¤šå‘é€ä¸€æ¬¡é¢å¤–çš„ HTTP è¯·æ±‚ã€‚</strong></p><a href=#å‡­æ®è¯·æ±‚><h4 id=å‡­æ®è¯·æ±‚><span class=hanchor arialabel=Anchor># </span>å‡­æ®è¯·æ±‚</h4></a><p><strong>é»˜è®¤æƒ…å†µä¸‹ï¼Œè·¨æºè¯·æ±‚ä¸æä¾›å‡­æ®ï¼ˆcookieã€HTTP è®¤è¯å’Œå®¢æˆ·ç«¯ SSL è¯ä¹¦ï¼‰ã€‚å¯ä»¥é€šè¿‡å°† withCredentials å±æ€§è®¾ç½®ä¸º true æ¥è¡¨æ˜è¯·æ±‚ä¼šå‘é€å‡­æ®ã€‚</strong></p><a href=#å›¾ç‰‡æ¢æµ‹><h4 id=å›¾ç‰‡æ¢æµ‹><span class=hanchor arialabel=Anchor># </span>å›¾ç‰‡æ¢æµ‹</h4></a><p>å›¾ç‰‡æ¢æµ‹æ˜¯åˆ©ç”¨<code>&lt;img></code>æ ‡ç­¾å®ç°è·¨åŸŸé€šä¿¡çš„æœ€æ—©çš„ä¸€ç§æŠ€æœ¯ã€‚ä»»ä½•é¡µé¢éƒ½å¯ä»¥è·¨åŸŸåŠ è½½å›¾ç‰‡è€Œä¸ å¿…æ‹…å¿ƒé™åˆ¶ï¼Œå› æ­¤è¿™ä¹Ÿæ˜¯åœ¨çº¿å¹¿å‘Šè·Ÿè¸ªçš„ä¸»è¦æ–¹å¼ã€‚å¯ä»¥åŠ¨æ€åˆ›å»ºå›¾ç‰‡ï¼Œç„¶åé€šè¿‡å®ƒä»¬çš„ onload å’Œ onerror äº‹ä»¶å¤„ç†ç¨‹åºå¾—çŸ¥ä½•æ—¶æ”¶åˆ°å“åº”</p><p>å›¾ç‰‡æ¢æµ‹é¢‘ç¹ç”¨äºè·Ÿè¸ªç”¨æˆ·åœ¨é¡µé¢ä¸Šçš„ç‚¹å‡»æ“ä½œæˆ–åŠ¨æ€æ˜¾ç¤ºå¹¿å‘Šã€‚å½“ç„¶ï¼Œå›¾ç‰‡æ¢æµ‹çš„ç¼ºç‚¹æ˜¯<strong>åªèƒ½å‘é€ GET è¯·æ±‚</strong>å’Œ<strong>æ— æ³•è·å–æœåŠ¡å™¨å“åº”çš„å†…å®¹</strong>ã€‚è¿™ä¹Ÿæ˜¯åªèƒ½åˆ©ç”¨å›¾ç‰‡æ¢æµ‹å®ç°æµè§ˆå™¨ä¸æœåŠ¡å™¨å•å‘é€šä¿¡çš„ åŸå› ã€‚</p><a href=#jsonp><h4 id=jsonp><span class=hanchor arialabel=Anchor># </span>JSONP</h4></a><p>JSONP è°ƒç”¨æ˜¯é€šè¿‡åŠ¨æ€åˆ›å»º<code>&lt;script></code>å…ƒç´ å¹¶ä¸º src å±æ€§æŒ‡å®šè·¨åŸŸ URL å®ç°çš„ã€‚æ­¤æ—¶çš„<code>&lt;script></code>ä¸<code>&lt;img></code>å…ƒç´ ç±»ä¼¼ï¼Œèƒ½å¤Ÿä¸å—é™åˆ¶åœ°ä»å…¶ä»–åŸŸåŠ è½½èµ„æºã€‚å› ä¸º JSONP æ˜¯æœ‰æ•ˆçš„ JavaScriptï¼Œæ‰€ä»¥ JSONP å“åº”åœ¨è¢«åŠ è½½å®Œæˆä¹‹åä¼šç«‹å³æ‰§è¡Œã€‚</p><p>JSONP ç”±äºå…¶ç®€å•æ˜“ç”¨ï¼Œåœ¨å¼€å‘è€…ä¸­éå¸¸æµè¡Œã€‚ç›¸æ¯”äºå›¾ç‰‡æ¢æµ‹ï¼Œä½¿ç”¨ JSONP å¯ä»¥ç›´æ¥è®¿é—®å“åº”ï¼Œ <strong>å®ç°æµè§ˆå™¨ä¸æœåŠ¡å™¨çš„åŒå‘é€šä¿¡</strong>ã€‚ä¸è¿‡ JSONP ä¹Ÿæœ‰ä¸€äº›ç¼ºç‚¹ã€‚</p><p>é¦–å…ˆï¼ŒJSONP æ˜¯ä»ä¸åŒçš„åŸŸæ‹‰å–å¯æ‰§è¡Œä»£ç ã€‚å¦‚æœè¿™ä¸ªåŸŸå¹¶ä¸å¯ä¿¡ï¼Œåˆ™å¯èƒ½åœ¨å“åº”ä¸­åŠ å…¥æ¶æ„å†…å®¹ã€‚ æ­¤æ—¶é™¤äº†å®Œå…¨åˆ é™¤ JSONP æ²¡æœ‰å…¶ä»–åŠæ³•ã€‚åœ¨ä½¿ç”¨ä¸å—æ§çš„ Web æœåŠ¡æ—¶ï¼Œä¸€å®šè¦ä¿è¯æ˜¯å¯ä»¥ä¿¡ä»»çš„ã€‚</p><p>ç¬¬äºŒä¸ªç¼ºç‚¹æ˜¯ä¸å¥½ç¡®å®š JSONP è¯·æ±‚æ˜¯å¦å¤±è´¥ã€‚è™½ç„¶ HTML5 è§„å®šäº†<code>&lt;script></code>å…ƒç´ çš„ onerror äº‹ä»¶å¤„ç†ç¨‹åºï¼Œä½†è¿˜æ²¡æœ‰è¢«ä»»ä½•æµè§ˆå™¨å®ç°ã€‚ä¸ºæ­¤ï¼Œå¼€å‘è€…ç»å¸¸ä½¿ç”¨è®¡æ—¶å™¨æ¥å†³å®šæ˜¯å¦æ”¾å¼ƒç­‰å¾…å“åº”ã€‚è¿™ç§
æ–¹å¼å¹¶ä¸å‡†ç¡®ï¼Œæ¯•ç«Ÿä¸åŒç”¨æˆ·çš„ç½‘ç»œè¿æ¥é€Ÿåº¦å’Œå¸¦å®½æ˜¯ä¸ä¸€æ ·çš„ã€‚</p><a href=#fetch-è¯·æ±‚><h3 id=fetch-è¯·æ±‚><span class=hanchor arialabel=Anchor># </span>fetch è¯·æ±‚</h3></a><p>Fetch API æœ¬èº«æ˜¯ä½¿ç”¨ JavaScript è¯·æ±‚èµ„æºçš„ä¼˜ç§€å·¥å…·ï¼ŒåŒæ—¶è¿™ä¸ª API ä¹Ÿèƒ½å¤Ÿåº”ç”¨åœ¨æœåŠ¡çº¿ç¨‹ ï¼ˆservice workerï¼‰ä¸­ï¼Œæä¾›æ‹¦æˆªã€é‡å®šå‘å’Œä¿®æ”¹é€šè¿‡ fetch()ç”Ÿæˆçš„è¯·æ±‚æ¥å£ã€‚</p><ul><li><p>å‘é€ JSON æ•°æ®</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=nx>fetch</span><span class=p>(</span><span class=s1>&#39;/send-me-json&#39;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>method</span><span class=o>:</span> <span class=s1>&#39;POST&#39;</span><span class=p>,</span> <span class=c1>// å‘é€è¯·æ±‚ä½“æ—¶å¿…é¡»ä½¿ç”¨ä¸€ç§ HTTP æ–¹æ³•
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=nx>body</span><span class=o>:</span> <span class=nx>payload</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=nx>headers</span><span class=o>:</span> <span class=nx>jsonHeaders</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div></li></ul><ul><li><p>å‘é€è·¨æºè¯·æ±‚</p></li><li><p>åŠ è½½ Blob æ–‡ä»¶</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=nx>fetch</span><span class=p>(</span><span class=s1>&#39;my-image.png&#39;</span><span class=p>).</span><span class=nx>then</span><span class=p>((</span><span class=nx>response</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>response</span><span class=p>.</span><span class=nx>blob</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>ä¸­æ–­è¯·æ±‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=nx>åŒ…å«é”™è¯¯çš„æ‹’ç»</span><span class=err>ã€‚</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nx>abortController</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>AbortController</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=nx>fetch</span><span class=p>(</span><span class=s1>&#39;wikipedia.zip&#39;</span><span class=p>,</span> <span class=p>{</span> <span class=nx>signal</span><span class=o>:</span> <span class=nx>abortController</span><span class=p>.</span><span class=nx>signal</span> <span class=p>})</span>
</span></span><span class=line><span class=cl> <span class=p>.</span><span class=k>catch</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;aborted!&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>// 10 æ¯«ç§’åä¸­æ–­è¯·æ±‚
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>setTimeout</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=nx>abortController</span><span class=p>.</span><span class=nx>abort</span><span class=p>(),</span> <span class=mi>10</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div></li></ul><a href=#headers-å¯¹è±¡><h4 id=headers-å¯¹è±¡><span class=hanchor arialabel=Anchor># </span>Headers å¯¹è±¡</h4></a><p>Headers ä¸ Map ç±»å‹éƒ½æœ‰ get()ã€set()ã€has()å’Œ delete() ç­‰å®ä¾‹æ–¹æ³•</p><p>Headers å¹¶ä¸æ˜¯ä¸ Map å¤„å¤„éƒ½ä¸€æ ·ã€‚åœ¨åˆå§‹åŒ– Headers å¯¹è±¡æ—¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨é”®/å€¼å¯¹å½¢å¼çš„å¯¹è±¡ï¼Œ è€Œ Map åˆ™ä¸å¯ä»¥</p><a href=#request-å¯¹è±¡><h4 id=request-å¯¹è±¡><span class=hanchor arialabel=Anchor># </span>Request å¯¹è±¡</h4></a><a href=#response-å¯¹è±¡><h4 id=response-å¯¹è±¡><span class=hanchor arialabel=Anchor># </span>Response å¯¹è±¡</h4></a><a href=#beacon-api><h3 id=beacon-api><span class=hanchor arialabel=Anchor># </span>Beacon API</h3></a><p>ä¸ºäº†æŠŠå°½é‡å¤šçš„é¡µé¢ä¿¡æ¯ä¼ åˆ°æœåŠ¡å™¨ï¼Œå¾ˆå¤šåˆ†æå·¥å…·éœ€è¦<strong>åœ¨é¡µé¢ç”Ÿå‘½å‘¨æœŸä¸­å°½é‡æ™šçš„æ—¶å€™å‘æœåŠ¡å™¨ å‘é€é¥æµ‹æˆ–åˆ†ææ•°æ®</strong>ã€‚å› æ­¤ï¼Œç†æƒ³çš„æƒ…å†µä¸‹æ˜¯é€šè¿‡æµè§ˆå™¨çš„ unload äº‹ä»¶å‘é€ç½‘ç»œè¯·æ±‚ã€‚è¿™ä¸ªäº‹ä»¶è¡¨ç¤º ç”¨æˆ·è¦ç¦»å¼€å½“å‰é¡µé¢ï¼Œä¸ä¼šå†ç”Ÿæˆåˆ«çš„æœ‰ç”¨ä¿¡æ¯äº†ã€‚</p><p>unload äº‹ä»¶è§¦å‘æ—¶ï¼Œåˆ†æå·¥å…·è¦åœæ­¢æ”¶é›†ä¿¡æ¯å¹¶æŠŠæ”¶é›†åˆ°çš„æ•°æ®å‘ç»™æœåŠ¡å™¨ã€‚è¿™æ—¶å€™æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œ å› ä¸º unload äº‹ä»¶å¯¹æµè§ˆå™¨æ„å‘³ç€æ²¡æœ‰ç†ç”±å†å‘é€ä»»ä½•ç»“æœæœªçŸ¥çš„ç½‘ç»œè¯·æ±‚ï¼ˆå› ä¸ºé¡µé¢éƒ½è¦è¢«é”€æ¯äº†ï¼‰ã€‚ ä¾‹å¦‚ï¼Œåœ¨ unload äº‹ä»¶å¤„ç†ç¨‹åºä¸­åˆ›å»ºçš„ä»»ä½•å¼‚æ­¥è¯·æ±‚éƒ½ä¼šè¢«æµè§ˆå™¨å–æ¶ˆã€‚ä¸ºæ­¤ï¼Œå¼‚æ­¥ XMLHttpRequest æˆ– fetch()ä¸é€‚åˆè¿™ä¸ªä»»åŠ¡ã€‚åˆ†æå·¥å…·å¯ä»¥ä½¿ç”¨åŒæ­¥ XMLHttpRequest å¼ºåˆ¶å‘é€è¯·æ±‚ï¼Œä½†è¿™æ ·åšä¼šå¯¼ è‡´ç”¨æˆ·ä½“éªŒé—®é¢˜ã€‚æµè§ˆå™¨ä¼šå› ä¸ºè¦ç­‰å¾… unload äº‹ä»¶å¤„ç†ç¨‹åºå®Œæˆè€Œå»¶è¿Ÿå¯¼èˆªåˆ°ä¸‹ä¸€ä¸ªé¡µé¢ã€‚</p><p>ä¸ºè§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒW3C å¼•å…¥äº†è¡¥å……æ€§çš„ Beacon APIã€‚è¿™ä¸ª API ç»™ navigator å¯¹è±¡å¢åŠ äº†ä¸€ä¸ª sendBeacon()æ–¹æ³•ã€‚è¿™ä¸ªç®€å•çš„æ–¹æ³•æ¥æ”¶ä¸€ä¸ª URL å’Œä¸€ä¸ªæ•°æ®æœ‰æ•ˆè½½è·å‚æ•°ï¼Œå¹¶ä¼šå‘é€ä¸€ä¸ª POST è¯·æ±‚ã€‚å¯é€‰çš„æ•°æ®æœ‰æ•ˆè½½è·å‚æ•°æœ‰ ArrayBufferViewã€Blobã€DOMStringã€FormData å®ä¾‹ã€‚å¦‚æœè¯·æ±‚æˆåŠŸè¿›å…¥äº†æœ€ç»ˆè¦å‘é€çš„ä»»åŠ¡é˜Ÿåˆ—ï¼Œåˆ™è¿™ä¸ªæ–¹æ³•è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=c1>// å‘é€ POST è¯·æ±‚
</span></span></span><span class=line><span class=cl><span class=c1>// URL: &#39;https://example.com/analytics-reporting-url&#39;
</span></span></span><span class=line><span class=cl><span class=c1>// è¯·æ±‚è´Ÿè½½ï¼š&#39;{foo: &#34;bar&#34;}&#39;
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>navigator</span><span class=p>.</span><span class=nx>sendBeacon</span><span class=p>(</span><span class=s1>&#39;https://example.com/analytics-reporting-url&#39;</span><span class=p>,</span> <span class=s1>&#39;{foo: &#34;bar&#34;}&#39;</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>è¿™ä¸ªæ–¹æ³•è™½ç„¶çœ‹èµ·æ¥åªä¸è¿‡æ˜¯ POST è¯·æ±‚çš„ä¸€ä¸ªè¯­æ³•ç³–ï¼Œä½†å®ƒæœ‰å‡ ä¸ªé‡è¦çš„ç‰¹æ€§ã€‚</p><ul><li>sendBeacon()å¹¶ä¸æ˜¯åªèƒ½åœ¨é¡µé¢ç”Ÿå‘½å‘¨æœŸæœ«å°¾ä½¿ç”¨ï¼Œè€Œæ˜¯ä»»ä½•æ—¶å€™éƒ½å¯ä»¥ä½¿ç”¨ã€‚</li><li>è°ƒç”¨ sendBeacon()åï¼Œæµè§ˆå™¨ä¼šæŠŠè¯·æ±‚æ·»åŠ åˆ°ä¸€ä¸ªå†…éƒ¨çš„è¯·æ±‚é˜Ÿåˆ—ã€‚æµè§ˆå™¨ä¼šä¸»åŠ¨åœ°å‘é€é˜Ÿ åˆ—ä¸­çš„è¯·æ±‚ã€‚</li><li>æµè§ˆå™¨ä¿è¯åœ¨åŸå§‹é¡µé¢å·²ç»å…³é—­çš„æƒ…å†µä¸‹ä¹Ÿä¼šå‘é€è¯·æ±‚ã€‚</li><li>çŠ¶æ€ç ã€è¶…æ—¶å’Œå…¶ä»–ç½‘ç»œåŸå› é€ æˆçš„å¤±è´¥å®Œå…¨æ˜¯ä¸é€æ˜çš„ï¼Œä¸èƒ½é€šè¿‡ç¼–ç¨‹æ–¹å¼å¤„ç†ã€‚</li><li>ä¿¡æ ‡ï¼ˆbeaconï¼‰è¯·æ±‚ä¼šæºå¸¦è°ƒç”¨ sendBeacon()æ—¶æ‰€æœ‰ç›¸å…³çš„ cookieã€‚</li></ul><a href=#web-socket><h3 id=web-socket><span class=hanchor arialabel=Anchor># </span>Web Socket</h3></a><p>Web Socket ä½¿ç”¨äº†<strong>è‡ªå®šä¹‰åè®®</strong>ï¼Œæ‰€ä»¥ URL æ–¹æ¡ˆï¼ˆschemeï¼‰ç¨æœ‰å˜åŒ–ï¼šä¸èƒ½å†ä½¿ç”¨ http://æˆ– https://ï¼Œ è€Œè¦ä½¿ç”¨ ws://å’Œ wss://ã€‚å‰è€…æ˜¯ä¸å®‰å…¨çš„è¿æ¥ï¼Œåè€…æ˜¯å®‰å…¨è¿æ¥ã€‚åœ¨æŒ‡å®š Web Socket URL æ—¶ï¼Œå¿…é¡»åŒ…å« URL æ–¹æ¡ˆï¼Œå› ä¸ºå°†æ¥æœ‰å¯èƒ½å†æ”¯æŒå…¶ä»–æ–¹æ¡ˆã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kd>let</span> <span class=nx>socket</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>WebSocket</span><span class=p>(</span><span class=s2>&#34;ws://www.example.com/server.php&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nx>stringData</span> <span class=o>=</span> <span class=s2>&#34;Hello world!&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nx>arrayBufferData</span> <span class=o>=</span> <span class=nx>Uint8Array</span><span class=p>.</span><span class=nx>from</span><span class=p>([</span><span class=s1>&#39;f&#39;</span><span class=p>,</span> <span class=s1>&#39;o&#39;</span><span class=p>,</span> <span class=s1>&#39;o&#39;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nx>blobData</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Blob</span><span class=p>([</span><span class=s1>&#39;f&#39;</span><span class=p>,</span> <span class=s1>&#39;o&#39;</span><span class=p>,</span> <span class=s1>&#39;o&#39;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=c1>//å‘é€å’Œæ¥æ”¶æ•°æ®
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>socket</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=nx>stringData</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>socket</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=nx>arrayBufferData</span><span class=p>.</span><span class=nx>buffer</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>socket</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=nx>blobData</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>socket</span><span class=p>.</span><span class=nx>onmessage</span> <span class=o>=</span> <span class=kd>function</span><span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=kd>let</span> <span class=nx>data</span> <span class=o>=</span> <span class=nx>event</span><span class=p>.</span><span class=nx>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=c1>// å¯¹æ•°æ®æ‰§è¡ŒæŸäº›æ“ä½œ
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=c1>//åœ¨è¿æ¥æˆåŠŸå»ºç«‹æ—¶è§¦å‘ã€‚
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>socket</span><span class=p>.</span><span class=nx>onopen</span> <span class=o>=</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>alert</span><span class=p>(</span><span class=s2>&#34;Connection established.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=c1>//åœ¨å‘ç”Ÿé”™è¯¯æ—¶è§¦å‘ã€‚è¿æ¥æ— æ³•å­˜ç»­ã€‚
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>socket</span><span class=p>.</span><span class=nx>onerror</span> <span class=o>=</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>alert</span><span class=p>(</span><span class=s2>&#34;Connection error.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=c1>//åœ¨è¿æ¥å…³é—­æ—¶è§¦å‘ã€‚
</span></span></span><span class=line><span class=cl><span class=c1>//åªæœ‰ close äº‹ä»¶çš„ event å¯¹è±¡ä¸Šæœ‰é¢å¤–ä¿¡æ¯ã€‚è¿™ä¸ªå¯¹è±¡ä¸Šæœ‰ 3 ä¸ªé¢å¤–å±æ€§ï¼š
</span></span></span><span class=line><span class=cl><span class=c1>// wasCleanã€code å’Œ reasonã€‚
</span></span></span><span class=line><span class=cl><span class=c1>//å…¶ä¸­ï¼ŒwasClean æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¿æ¥æ˜¯å¦å¹²å‡€åœ°å…³é—­ï¼›code æ˜¯ä¸€ä¸ªæ¥è‡ªæœåŠ¡å™¨çš„æ•°å€¼çŠ¶æ€ç ï¼›reason æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒåŒ…å«æœåŠ¡å™¨å‘æ¥çš„æ¶ˆæ¯ã€‚
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>socket</span><span class=p>.</span><span class=nx>onclose</span> <span class=o>=</span> <span class=kd>function</span><span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`as clean? </span><span class=si>${</span><span class=nx>event</span><span class=p>.</span><span class=nx>wasClean</span><span class=si>}</span><span class=sb> Code=</span><span class=si>${</span><span class=nx>event</span><span class=p>.</span><span class=nx>code</span><span class=si>}</span><span class=sb> Reason=</span><span class=si>${</span><span class=nx>event</span><span class=p>.</span><span class=nx>reason</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><a href=#å®¢æˆ·ç«¯å­˜å‚¨><h2 id=å®¢æˆ·ç«¯å­˜å‚¨><span class=hanchor arialabel=Anchor># </span>å®¢æˆ·ç«¯å­˜å‚¨</h2></a><a href=#cookie><h3 id=cookie><span class=hanchor arialabel=Anchor># </span>cookie</h3></a><p>cookie æ˜¯ä¸ç‰¹å®šåŸŸç»‘å®šçš„ã€‚è®¾ç½® cookie åï¼Œå®ƒä¼šä¸è¯·æ±‚ä¸€èµ·å‘é€åˆ°åˆ›å»ºå®ƒçš„åŸŸã€‚è¿™ä¸ªé™åˆ¶èƒ½ä¿è¯ cookie ä¸­å­˜å‚¨çš„ä¿¡æ¯åªå¯¹è¢«è®¤å¯çš„æ¥æ”¶è€…å¼€æ”¾ï¼Œä¸è¢«å…¶ä»–åŸŸè®¿é—®ã€‚</p><p>å› ä¸º cookie å­˜å‚¨åœ¨å®¢æˆ·ç«¯æœºå™¨ä¸Šï¼Œæ‰€ä»¥ä¸ºä¿è¯å®ƒä¸ä¼šè¢«æ¶æ„åˆ©ç”¨ï¼Œæµè§ˆå™¨ä¼šæ–½åŠ é™åˆ¶ã€‚åŒæ—¶ï¼Œcookie ä¹Ÿä¸ä¼šå ç”¨å¤ªå¤šç£ç›˜ç©ºé—´</p><ul><li>ä¸è¶…è¿‡ 300 ä¸ª cookieï¼›</li><li>æ¯ä¸ª cookie ä¸è¶…è¿‡ 4096 å­—èŠ‚ï¼›</li><li>æ¯ä¸ªåŸŸä¸è¶…è¿‡ 20 ä¸ª cookieï¼›</li><li>æ¯ä¸ªåŸŸä¸è¶…è¿‡ 81 920 å­—èŠ‚ã€‚</li></ul><a href=#ä½¿ç”¨-1><h4 id=ä½¿ç”¨-1><span class=hanchor arialabel=Anchor># </span>ä½¿ç”¨</h4></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=c1>//secure :åªèƒ½åœ¨sslé“¾æ¥ä¸Šå‘é€
</span></span></span><span class=line><span class=cl><span class=c1>//domain : cookie æœ‰æ•ˆçš„åŸŸã€‚å‘é€åˆ°è¿™ä¸ªåŸŸçš„æ‰€æœ‰è¯·æ±‚éƒ½ä¼šåŒ…å«å¯¹åº”çš„ cookie
</span></span></span><span class=line><span class=cl><span class=c1>//path   :è¯·æ±‚ URL ä¸­åŒ…å«è¿™ä¸ªè·¯å¾„æ‰ä¼šæŠŠ cookie å‘é€åˆ°æœåŠ¡å™¨ã€‚
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>Set</span><span class=o>-</span><span class=nx>Cookie</span><span class=o>:</span> <span class=nx>name</span><span class=o>=</span><span class=nx>value</span><span class=p>;</span> <span class=nx>expires</span><span class=o>=</span><span class=nx>Mon</span><span class=p>,</span> <span class=mi>22</span><span class=o>-</span><span class=nx>Jan</span><span class=o>-</span><span class=mi>07</span> <span class=mi>07</span><span class=o>:</span><span class=mi>10</span><span class=o>:</span><span class=mi>24</span> <span class=nx>GMT</span><span class=p>;</span> <span class=nx>domain</span><span class=o>=</span><span class=p>.</span><span class=nx>wrox</span><span class=p>.</span><span class=nx>com</span><span class=p>;</span> <span class=nx>secure</span>
</span></span></code></pre></td></tr></table></div></div><a href=#js-ä¸­ä½¿ç”¨-cookie><h4 id=js-ä¸­ä½¿ç”¨-cookie><span class=hanchor arialabel=Anchor># </span>JS ä¸­ä½¿ç”¨ Cookie</h4></a><p>æ‰€æœ‰åå’Œå€¼éƒ½æ˜¯ URL ç¼–ç çš„ï¼Œå› æ­¤å¿…é¡»ä½¿ç”¨ decodeURIComponent()è§£ç ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kr>class</span> <span class=nx>CookieUtil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=kr>static</span> <span class=nx>get</span><span class=p>(</span><span class=nx>name</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=kd>let</span> <span class=nx>cookieName</span> <span class=o>=</span> <span class=sb>`</span><span class=si>${</span><span class=nb>encodeURIComponent</span><span class=p>(</span><span class=nx>name</span><span class=p>)</span><span class=si>}</span><span class=sb>=`</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=nx>cookieStart</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>cookie</span><span class=p>.</span><span class=nx>indexOf</span><span class=p>(</span><span class=nx>cookieName</span><span class=p>),</span>
</span></span><span class=line><span class=cl> <span class=nx>cookieValue</span> <span class=o>=</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=k>if</span> <span class=p>(</span><span class=nx>cookieStart</span> <span class=o>&gt;</span> <span class=o>-</span><span class=mi>1</span><span class=p>){</span>
</span></span><span class=line><span class=cl> <span class=kd>let</span> <span class=nx>cookieEnd</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>cookie</span><span class=p>.</span><span class=nx>indexOf</span><span class=p>(</span><span class=s2>&#34;;&#34;</span><span class=p>,</span> <span class=nx>cookieStart</span><span class=p>);</span>
</span></span><span class=line><span class=cl> <span class=k>if</span> <span class=p>(</span><span class=nx>cookieEnd</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>){</span>
</span></span><span class=line><span class=cl> <span class=nx>cookieEnd</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>cookie</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=p>}</span>
</span></span><span class=line><span class=cl> <span class=nx>cookieValue</span> <span class=o>=</span> <span class=nb>decodeURIComponent</span><span class=p>(</span><span class=nb>document</span><span class=p>.</span><span class=nx>cookie</span><span class=p>.</span><span class=nx>substring</span><span class=p>(</span><span class=nx>cookieStart</span>
</span></span><span class=line><span class=cl> <span class=o>+</span> <span class=nx>cookieName</span><span class=p>.</span><span class=nx>length</span><span class=p>,</span> <span class=nx>cookieEnd</span><span class=p>));</span>
</span></span><span class=line><span class=cl> <span class=p>}</span>
</span></span><span class=line><span class=cl> <span class=k>return</span> <span class=nx>cookieValue</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=p>}</span>
</span></span><span class=line><span class=cl> <span class=kr>static</span> <span class=nx>set</span><span class=p>(</span><span class=nx>name</span><span class=p>,</span> <span class=nx>value</span><span class=p>,</span> <span class=nx>expires</span><span class=p>,</span> <span class=nx>path</span><span class=p>,</span> <span class=nx>domain</span><span class=p>,</span> <span class=nx>secure</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=kd>let</span> <span class=nx>cookieText</span> <span class=o>=</span>
</span></span><span class=line><span class=cl> <span class=sb>`</span><span class=si>${</span><span class=nb>encodeURIComponent</span><span class=p>(</span><span class=nx>name</span><span class=p>)</span><span class=si>}</span><span class=sb>=</span><span class=si>${</span><span class=nb>encodeURIComponent</span><span class=p>(</span><span class=nx>value</span><span class=p>)</span><span class=si>}</span><span class=sb>`</span>
</span></span><span class=line><span class=cl> <span class=k>if</span> <span class=p>(</span><span class=nx>expires</span> <span class=k>instanceof</span> <span class=nb>Date</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>cookieText</span> <span class=o>+=</span> <span class=sb>`; expires=</span><span class=si>${</span><span class=nx>expires</span><span class=p>.</span><span class=nx>toGMTString</span><span class=p>()</span><span class=si>}</span><span class=sb>`</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=p>}</span>
</span></span><span class=line><span class=cl> <span class=k>if</span> <span class=p>(</span><span class=nx>path</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>cookieText</span> <span class=o>+=</span> <span class=sb>`; path=</span><span class=si>${</span><span class=nx>path</span><span class=si>}</span><span class=sb>`</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=p>}</span>
</span></span><span class=line><span class=cl> <span class=k>if</span> <span class=p>(</span><span class=nx>domain</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>cookieText</span> <span class=o>+=</span> <span class=sb>`; domain=</span><span class=si>${</span><span class=nx>domain</span><span class=si>}</span><span class=sb>`</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=p>}</span>
</span></span><span class=line><span class=cl> <span class=k>if</span> <span class=p>(</span><span class=nx>secure</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>cookieText</span> <span class=o>+=</span> <span class=s2>&#34;; secure&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=p>}</span>
</span></span><span class=line><span class=cl> <span class=nb>document</span><span class=p>.</span><span class=nx>cookie</span> <span class=o>=</span> <span class=nx>cookieText</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=p>}</span>
</span></span><span class=line><span class=cl> <span class=kr>static</span> <span class=nx>unset</span><span class=p>(</span><span class=nx>name</span><span class=p>,</span> <span class=nx>path</span><span class=p>,</span> <span class=nx>domain</span><span class=p>,</span> <span class=nx>secure</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>CookieUtil</span><span class=p>.</span><span class=nx>set</span><span class=p>(</span><span class=nx>name</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=k>new</span> <span class=nb>Date</span><span class=p>(</span><span class=mi>0</span><span class=p>),</span> <span class=nx>path</span><span class=p>,</span> <span class=nx>domain</span><span class=p>,</span> <span class=nx>secure</span><span class=p>);</span>
</span></span><span class=line><span class=cl> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><a href=#å­-cookie><h4 id=å­-cookie><span class=hanchor arialabel=Anchor># </span>å­ Cookie</h4></a><p>å­ cookie çš„æ ¼å¼ç±»ä¼¼äºæŸ¥è¯¢å­—ç¬¦ä¸²ã€‚è¿™äº›å€¼å¯ä»¥å­˜å‚¨ä¸ºå•ä¸ª cookieï¼Œè€Œä¸ç”¨å•ç‹¬å­˜å‚¨ä¸ºè‡ªå·±çš„å/å€¼å¯¹ã€‚ç»“æœå°±æ˜¯ç½‘ç«™æˆ– Web åº”ç”¨ç¨‹åºèƒ½å¤Ÿåœ¨å•åŸŸ cookie æ•°é™åˆ¶ä¸‹å­˜å‚¨æ›´å¤šçš„ç»“æ„åŒ–æ•°æ®ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=nx>name</span><span class=o>=</span><span class=nx>name1</span><span class=o>=</span><span class=nx>value1</span><span class=o>&amp;</span><span class=nx>name2</span><span class=o>=</span><span class=nx>value2</span><span class=o>&amp;</span><span class=nx>name3</span><span class=o>=</span><span class=nx>value3</span><span class=o>&amp;</span><span class=nx>name4</span><span class=o>=</span><span class=nx>value4</span><span class=o>&amp;</span><span class=nx>name5</span><span class=o>=</span><span class=nx>value5</span>
</span></span></code></pre></td></tr></table></div></div><a href=#æ³¨æ„äº‹é¡¹><h4 id=æ³¨æ„äº‹é¡¹><span class=hanchor arialabel=Anchor># </span>æ³¨æ„äº‹é¡¹</h4></a><p>è¿˜æœ‰ä¸€ç§å«ä½œ <strong>HTTP-only</strong> çš„ cookieã€‚HTTP-only å¯ä»¥åœ¨æµè§ˆå™¨è®¾ç½®ï¼Œä¹Ÿå¯ä»¥åœ¨æœåŠ¡å™¨è®¾ç½®ï¼Œä½†åªèƒ½ åœ¨æœåŠ¡å™¨ä¸Šè¯»å–ï¼Œè¿™æ˜¯å› ä¸º JavaScript æ— æ³•å–å¾—è¿™ç§ cookie çš„å€¼</p><a href=#sessionstorage><h3 id=sessionstorage><span class=hanchor arialabel=Anchor># </span>sessionStorage</h3></a><p>sessionStorage å¯¹è±¡åªå­˜å‚¨ä¼šè¯æ•°æ®ï¼Œè¿™æ„å‘³ç€æ•°æ®åªä¼šå­˜å‚¨åˆ°æµè§ˆå™¨å…³é—­ã€‚è¿™è·Ÿæµè§ˆå™¨å…³é—­æ—¶ ä¼šæ¶ˆå¤±çš„ä¼šè¯ cookie ç±»ä¼¼ã€‚å­˜å‚¨åœ¨ sessionStorage ä¸­çš„æ•°æ®ä¸å—é¡µé¢åˆ·æ–°å½±å“ï¼Œå¯ä»¥åœ¨æµè§ˆå™¨å´©æºƒ å¹¶é‡å¯åæ¢å¤ã€‚ï¼ˆå–å†³äºæµè§ˆå™¨ï¼ŒFirefox å’Œ WebKit æ”¯æŒï¼ŒIE ä¸æ”¯æŒã€‚ï¼‰</p><a href=#localstorage><h3 id=localstorage><span class=hanchor arialabel=Anchor># </span>localStorage</h3></a><p>åœ¨ä¿®è®¢çš„ HTML5 è§„èŒƒé‡Œï¼ŒlocalStorage å¯¹è±¡å–ä»£äº† globalStorageï¼Œä½œä¸ºåœ¨å®¢æˆ·ç«¯æŒä¹…å­˜å‚¨ æ•°æ®çš„æœºåˆ¶ã€‚è¦è®¿é—®åŒä¸€ä¸ª localStorage å¯¹è±¡ï¼Œ<strong>é¡µé¢å¿…é¡»æ¥è‡ªåŒä¸€ä¸ªåŸŸï¼ˆå­åŸŸä¸å¯ä»¥ï¼‰ã€åœ¨ç›¸åŒçš„ç«¯å£ä¸Šä½¿ç”¨ç›¸åŒçš„åè®®ã€‚</strong></p><p>ä¸¤ç§å­˜å‚¨æ–¹æ³•çš„åŒºåˆ«åœ¨äºï¼Œå­˜å‚¨åœ¨ localStorage ä¸­çš„æ•°æ®ä¼šä¿ç•™åˆ°é€šè¿‡ JavaScript åˆ é™¤æˆ–è€…ç”¨æˆ· æ¸…é™¤æµè§ˆå™¨ç¼“å­˜ã€‚localStorage æ•°æ®ä¸å—é¡µé¢åˆ·æ–°å½±å“ï¼Œä¹Ÿä¸ä¼šå› å…³é—­çª—å£ã€æ ‡ç­¾é¡µæˆ–é‡æ–°å¯åŠ¨æµè§ˆ å™¨è€Œä¸¢å¤±ã€‚</p><a href=#indexdb><h3 id=indexdb><span class=hanchor arialabel=Anchor># </span>indexDB</h3></a><p>IndexedDB èƒŒåçš„æ€æƒ³æ˜¯åˆ›é€ ä¸€å¥— APIï¼Œæ–¹ä¾¿ JavaScript å¯¹è±¡çš„ å­˜å‚¨å’Œè·å–ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒæŸ¥è¯¢å’Œæœç´¢ã€‚</p><p>IndexedDB çš„è®¾è®¡å‡ ä¹å®Œå…¨æ˜¯å¼‚æ­¥çš„ã€‚ä¸ºæ­¤ï¼Œå¤§å¤šæ•°æ“ä½œä»¥è¯·æ±‚çš„å½¢å¼æ‰§è¡Œï¼Œè¿™äº›è¯·æ±‚ä¼šå¼‚æ­¥æ‰§è¡Œï¼Œ äº§ç”ŸæˆåŠŸçš„ç»“æœæˆ–é”™è¯¯ã€‚</p><a href=#æ¨¡å—><h2 id=æ¨¡å—><span class=hanchor arialabel=Anchor># </span>æ¨¡å—</h2></a><p>å°†ä»£ç æ‹†åˆ†æˆç‹¬ç«‹çš„å—ï¼Œç„¶åå†æŠŠè¿™äº›å—è¿æ¥èµ·æ¥å¯ä»¥é€šè¿‡æ¨¡å—æ¨¡å¼æ¥å®ç°ã€‚è¿™ç§æ¨¡å¼èƒŒåçš„æ€æƒ³ å¾ˆç®€å•ï¼šæŠŠ<strong>é€»è¾‘åˆ†å—ï¼Œå„è‡ªå°è£…ï¼Œç›¸äº’ç‹¬ç«‹ï¼Œæ¯ä¸ªå—è‡ªè¡Œå†³å®šå¯¹å¤–æš´éœ²ä»€ä¹ˆ</strong>ï¼ŒåŒæ—¶è‡ªè¡Œå†³å®šå¼•å…¥æ‰§è¡Œå“ªäº›å¤–éƒ¨ä»£ç ã€‚</p><a href=#å‡‘åˆçš„æ¨¡å—ç³»ç»Ÿ-iife><h3 id=å‡‘åˆçš„æ¨¡å—ç³»ç»Ÿ-iife><span class=hanchor arialabel=Anchor># </span>å‡‘åˆçš„æ¨¡å—ç³»ç»Ÿ-IIFE</h3></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=c1>// ä¸ºäº†æš´éœ²å…¬å…± APIï¼Œæ¨¡å— IIFE ä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶å±æ€§å°±æ˜¯æ¨¡å—å‘½åç©ºé—´ä¸­çš„å…¬å…±æˆå‘˜ï¼š
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>Foo</span> <span class=o>=</span> <span class=p>(</span><span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>bar</span><span class=o>:</span> <span class=s1>&#39;baz&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=nx>baz</span><span class=o>:</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>bar</span><span class=p>);</span>
</span></span><span class=line><span class=cl> <span class=p>}</span>
</span></span><span class=line><span class=cl> <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>})();</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>Foo</span><span class=p>.</span><span class=nx>bar</span><span class=p>);</span> <span class=c1>// &#39;baz&#39;
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>Foo</span><span class=p>.</span><span class=nx>baz</span><span class=p>();</span> <span class=c1>// &#39;baz&#39;
</span></span></span></code></pre></td></tr></table></div></div><a href=#es6-ä¹‹å‰çš„æ¨¡å—ç³»ç»Ÿ><h3 id=es6-ä¹‹å‰çš„æ¨¡å—ç³»ç»Ÿ><span class=hanchor arialabel=Anchor># </span>ES6 ä¹‹å‰çš„æ¨¡å—ç³»ç»Ÿ</h3></a><p>åœ¨ ES6 åŸç”Ÿæ”¯æŒæ¨¡å—ä¹‹å‰ï¼Œä½¿ç”¨æ¨¡å—çš„ JavaScript ä»£ç æœ¬è´¨ä¸Šæ˜¯å¸Œæœ›ä½¿ç”¨é»˜è®¤æ²¡æœ‰çš„è¯­è¨€ç‰¹æ€§ã€‚å›  æ­¤ï¼Œå¿…é¡»æŒ‰ç…§ç¬¦åˆæŸç§è§„èŒƒçš„æ¨¡å—è¯­æ³•æ¥ç¼–å†™ä»£ç ï¼Œå¦å¤–è¿˜éœ€è¦å•ç‹¬çš„æ¨¡å—å·¥å…·æŠŠè¿™äº›æ¨¡å—è¯­æ³•ä¸ JavaScript è¿è¡Œæ—¶è¿æ¥èµ·æ¥ã€‚è¿™é‡Œçš„æ¨¡å—è¯­æ³•å’Œè¿æ¥æ–¹å¼æœ‰ä¸åŒçš„è¡¨ç°å½¢å¼**ï¼Œé€šå¸¸éœ€è¦åœ¨æµè§ˆå™¨ä¸­é¢å¤– åŠ è½½åº“æˆ–è€…åœ¨æ„å»ºæ—¶å®Œæˆé¢„å¤„ç†ã€‚**</p><a href=#commonjs><h4 id=commonjs><span class=hanchor arialabel=Anchor># </span>CommonJS</h4></a><p>CommonJS è§„èŒƒæ¦‚è¿°äº†åŒæ­¥å£°æ˜ä¾èµ–çš„æ¨¡å—å®šä¹‰ã€‚è¿™ä¸ªè§„èŒƒä¸»è¦ç”¨äºåœ¨æœåŠ¡å™¨ç«¯å®ç°æ¨¡å—åŒ–ä»£ç ç»„ç»‡ï¼Œä½†ä¹Ÿå¯ç”¨äºå®šä¹‰åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨çš„æ¨¡å—ä¾èµ–ã€‚CommonJS æ¨¡å—è¯­æ³•ä¸èƒ½åœ¨æµè§ˆå™¨ä¸­ç›´æ¥è¿è¡Œã€‚</p><p><strong>åœ¨ CommonJS ä¸­ï¼Œæ¨¡å—åŠ è½½æ˜¯æ¨¡å—ç³»ç»Ÿæ‰§è¡Œçš„åŒæ­¥æ“ä½œã€‚</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=c1>//å®šä¹‰
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>moduleB</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./moduleB&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>module</span><span class=p>.</span><span class=nx>exports</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>stuff</span><span class=o>:</span> <span class=nx>moduleB</span><span class=p>.</span><span class=nx>doStuff</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//ä½¿ç”¨
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;moduleA&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./moduleA&#39;</span><span class=p>);</span> <span class=c1>// &#34;moduleA&#34;
</span></span></span></code></pre></td></tr></table></div></div><p><strong>æ— è®ºä¸€ä¸ªæ¨¡å—åœ¨ require()ä¸­è¢«å¼•ç”¨å¤šå°‘æ¬¡ï¼Œæ¨¡å—æ°¸è¿œæ˜¯å•ä¾‹ã€‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼ŒmoduleA åªä¼š è¢«æ‰“å°ä¸€æ¬¡ã€‚è¿™æ˜¯å› ä¸ºæ— è®ºè¯·æ±‚å¤šå°‘æ¬¡ï¼ŒmoduleA åªä¼šè¢«åŠ è½½ä¸€æ¬¡ã€‚</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;moduleA&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>a1</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./moduleA&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>a2</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./moduleA&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>a1</span> <span class=o>===</span> <span class=nx>a2</span><span class=p>);</span> <span class=c1>// true
</span></span></span></code></pre></td></tr></table></div></div><p>æ¨¡å—ç¬¬ä¸€æ¬¡åŠ è½½åä¼šè¢«ç¼“å­˜ï¼Œåç»­åŠ è½½ä¼šå–å¾—ç¼“å­˜çš„æ¨¡å—</p><p>module.exports å¯¹è±¡éå¸¸çµæ´»ï¼Œæœ‰å¤šç§ä½¿ç”¨æ–¹å¼ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=c1>//å•å€¼
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>module</span><span class=p>.</span><span class=nx>exports</span> <span class=o>=</span> <span class=s1>&#39;foo&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=c1>// å¤šå€¼
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>module</span><span class=p>.</span><span class=nx>exports</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>a</span><span class=o>:</span> <span class=s1>&#39;A&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=nx>b</span><span class=o>:</span> <span class=s1>&#39;B&#39;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=c1>// ç­‰åŒ
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>module</span><span class=p>.</span><span class=nx>exports</span><span class=p>.</span><span class=nx>a</span> <span class=o>=</span> <span class=s1>&#39;A&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nx>module</span><span class=p>.</span><span class=nx>exports</span><span class=p>.</span><span class=nx>b</span> <span class=o>=</span> <span class=s1>&#39;B&#39;</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><a href=#amd><h4 id=amd><span class=hanchor arialabel=Anchor># </span>AMD</h4></a><p>AMD æ¨¡å—å®ç°çš„æ ¸å¿ƒæ˜¯ç”¨<strong>å‡½æ•°åŒ…è£…æ¨¡å—å®šä¹‰</strong>ã€‚è¿™æ ·å¯ä»¥é˜²æ­¢å£°æ˜å…¨å±€å˜é‡ï¼Œå¹¶å…è®¸åŠ è½½å™¨åº“æ§åˆ¶ä½•æ—¶åŠ è½½æ¨¡å—ã€‚åŒ…è£…å‡½æ•°ä¹Ÿä¾¿äºæ¨¡å—ä»£ç çš„ç§»æ¤ï¼Œå› ä¸ºåŒ…è£…å‡½æ•°å†…éƒ¨çš„æ‰€æœ‰æ¨¡å—ä»£ç ä½¿ç”¨çš„éƒ½æ˜¯åŸç”Ÿ JavaScript ç»“æ„ã€‚åŒ…è£…æ¨¡å—çš„å‡½æ•°æ˜¯å…¨å±€ define çš„å‚æ•°ï¼Œå®ƒæ˜¯ç”± AMD åŠ è½½å™¨åº“çš„å®ç°å®šä¹‰çš„</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=c1>// ID ä¸º&#39;moduleA&#39;çš„æ¨¡å—å®šä¹‰ã€‚moduleA ä¾èµ– moduleBï¼Œ
</span></span></span><span class=line><span class=cl><span class=c1>// moduleB ä¼šå¼‚æ­¥åŠ è½½
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>define</span><span class=p>(</span><span class=s1>&#39;moduleA&#39;</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;moduleB&#39;</span><span class=p>],</span> <span class=kd>function</span><span class=p>(</span><span class=nx>moduleB</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>stuff</span><span class=o>:</span> <span class=nx>moduleB</span><span class=p>.</span><span class=nx>doStuff</span><span class=p>();</span>
</span></span><span class=line><span class=cl> <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><a href=#umd><h4 id=umd><span class=hanchor arialabel=Anchor># </span>UMD</h4></a><p>ä¸ºäº†<strong>ç»Ÿä¸€</strong> CommonJS å’Œ AMD ç”Ÿæ€ç³»ç»Ÿï¼Œé€šç”¨æ¨¡å—å®šä¹‰ï¼ˆUMDï¼ŒUniversal Module Definitionï¼‰è§„èŒƒåº”è¿è€Œç”Ÿã€‚UMD å¯ç”¨äºåˆ›å»ºè¿™ä¸¤ä¸ªç³»ç»Ÿéƒ½å¯ä»¥ä½¿ç”¨çš„æ¨¡å—ä»£ç ã€‚æœ¬è´¨ä¸Šï¼ŒUMD å®šä¹‰çš„æ¨¡å—ä¼šåœ¨å¯åŠ¨æ—¶ <strong>æ£€æµ‹è¦ä½¿ç”¨å“ªä¸ªæ¨¡å—ç³»ç»Ÿ</strong>ï¼Œç„¶åè¿›è¡Œé€‚å½“é…ç½®ï¼Œå¹¶æŠŠæ‰€æœ‰é€»è¾‘åŒ…è£…åœ¨ä¸€ä¸ªç«‹å³è°ƒç”¨çš„å‡½æ•°è¡¨è¾¾å¼ï¼ˆIIFEï¼‰ ä¸­ã€‚è™½ç„¶è¿™ç§ç»„åˆå¹¶ä¸å®Œç¾ï¼Œä½†åœ¨å¾ˆå¤šåœºæ™¯ä¸‹è¶³ä»¥å®ç°ä¸¤ä¸ªç”Ÿæ€çš„å…±å­˜ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=p>(</span><span class=kd>function</span> <span class=p>(</span><span class=nx>root</span><span class=p>,</span> <span class=nx>factory</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=k>if</span> <span class=p>(</span><span class=k>typeof</span> <span class=nx>define</span> <span class=o>===</span> <span class=s1>&#39;function&#39;</span> <span class=o>&amp;&amp;</span> <span class=nx>define</span><span class=p>.</span><span class=nx>amd</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=c1>// AMDã€‚æ³¨å†Œä¸ºåŒ¿åæ¨¡å—
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=nx>define</span><span class=p>([</span><span class=s1>&#39;moduleB&#39;</span><span class=p>],</span> <span class=nx>factory</span><span class=p>);</span>
</span></span><span class=line><span class=cl> <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=k>typeof</span> <span class=nx>module</span> <span class=o>===</span> <span class=s1>&#39;object&#39;</span> <span class=o>&amp;&amp;</span> <span class=nx>module</span><span class=p>.</span><span class=nx>exports</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=c1>// Nodeã€‚ä¸æ”¯æŒä¸¥æ ¼ CommonJS
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=c1>// ä½†å¯ä»¥åœ¨ Node è¿™æ ·æ”¯æŒ module.exports çš„
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=c1>// ç±» CommonJS ç¯å¢ƒä¸‹ä½¿ç”¨
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=nx>module</span><span class=p>.</span><span class=nx>exports</span> <span class=o>=</span> <span class=nx>factory</span><span class=p>(</span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39; moduleB &#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl> <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=c1>// æµè§ˆå™¨å…¨å±€ä¸Šä¸‹æ–‡ï¼ˆroot æ˜¯ windowï¼‰
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=nx>root</span><span class=p>.</span><span class=nx>returnExports</span> <span class=o>=</span> <span class=nx>factory</span><span class=p>(</span><span class=nx>root</span><span class=p>.</span> <span class=nx>moduleB</span><span class=p>);</span>
</span></span><span class=line><span class=cl> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}(</span><span class=k>this</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>moduleB</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=c1>// ä»¥æŸç§æ–¹å¼ä½¿ç”¨ moduleB
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=c1>// å°†è¿”å›å€¼ä½œä¸ºæ¨¡å—çš„å¯¼å‡º
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=c1>// è¿™ä¸ªä¾‹å­è¿”å›äº†ä¸€ä¸ªå¯¹è±¡
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=c1>// ä½†æ˜¯æ¨¡å—ä¹Ÿå¯ä»¥è¿”å›å‡½æ•°ä½œä¸ºå¯¼å‡ºå€¼
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=k>return</span> <span class=p>{};</span>
</span></span><span class=line><span class=cl><span class=p>}));</span>
</span></span></code></pre></td></tr></table></div></div><a href=#es6-æ¨¡å—><h3 id=es6-æ¨¡å—><span class=hanchor arialabel=Anchor># </span>ES6 æ¨¡å—</h3></a><p>ES6 æœ€å¤§çš„ä¸€ä¸ªæ”¹è¿›å°±æ˜¯å¼•å…¥äº†æ¨¡å—è§„èŒƒã€‚è¿™ä¸ªè§„èŒƒå…¨æ–¹ä½ç®€åŒ–äº†ä¹‹å‰å‡ºç°çš„æ¨¡å—åŠ è½½å™¨ï¼ŒåŸç”Ÿæµè§ˆå™¨æ”¯æŒæ„å‘³ç€åŠ è½½å™¨åŠå…¶ä»–é¢„å¤„ç†éƒ½ä¸å†å¿…è¦ã€‚ä»å¾ˆå¤šæ–¹é¢çœ‹ï¼ŒES6 æ¨¡å—ç³»ç»Ÿæ˜¯é›† AMD å’Œ CommonJS ä¹‹å¤§æˆè€…ã€‚</p><p>ECMAScript 6 æ¨¡å—æ˜¯ä½œä¸ºä¸€æ•´å— JavaScript ä»£ç è€Œå­˜åœ¨çš„ã€‚å¸¦æœ‰ type=&ldquo;module"å±æ€§çš„<code>&lt;script></code>æ ‡ç­¾ä¼šå‘Šè¯‰æµè§ˆå™¨ç›¸å…³ä»£ç åº”è¯¥ä½œä¸ºæ¨¡å—æ‰§è¡Œï¼Œè€Œä¸æ˜¯ä½œä¸ºä¼ ç»Ÿçš„è„šæœ¬æ‰§è¡Œã€‚</p><p>ä¸ä¼ ç»Ÿè„šæœ¬ä¸åŒï¼Œæ‰€æœ‰æ¨¡å—éƒ½ä¼šåƒ<code>&lt;script defer></code>åŠ è½½çš„è„šæœ¬ä¸€æ ·æŒ‰é¡ºåºæ‰§è¡Œã€‚è§£æåˆ°<code>&lt;script type="module"></code>æ ‡ç­¾åä¼šç«‹å³ä¸‹è½½æ¨¡å—æ–‡ä»¶ï¼Œä½†æ‰§è¡Œä¼šå»¶è¿Ÿåˆ°æ–‡æ¡£è§£æå®Œæˆã€‚</p><a href=#æ¨¡å—è¡Œä¸º><h4 id=æ¨¡å—è¡Œä¸º><span class=hanchor arialabel=Anchor># </span>æ¨¡å—è¡Œä¸º</h4></a><p>ECMAScript 6 æ¨¡å—å€Ÿç”¨äº† CommonJS å’Œ AMD çš„å¾ˆå¤šä¼˜ç§€ç‰¹æ€§ã€‚ä¸‹é¢ç®€å•åˆ—ä¸¾ä¸€äº›ã€‚</p><ul><li><p>æ¨¡å—ä»£ç åªåœ¨åŠ è½½åæ‰§è¡Œã€‚</p></li><li><p>æ¨¡å—åªèƒ½åŠ è½½ä¸€æ¬¡ã€‚</p></li><li><p>æ¨¡å—æ˜¯å•ä¾‹ã€‚</p></li><li><p>æ¨¡å—å¯ä»¥å®šä¹‰å…¬å…±æ¥å£ï¼Œå…¶ä»–æ¨¡å—å¯ä»¥åŸºäºè¿™ä¸ªå…¬å…±æ¥å£è§‚å¯Ÿå’Œäº¤äº’ã€‚</p></li><li><p>æ¨¡å—å¯ä»¥è¯·æ±‚åŠ è½½å…¶ä»–æ¨¡å—ã€‚</p></li><li><p>æ”¯æŒå¾ªç¯ä¾èµ–ã€‚ ES6 æ¨¡å—ç³»ç»Ÿä¹Ÿå¢åŠ äº†ä¸€äº›æ–°è¡Œä¸ºã€‚</p></li><li><p>ES6 æ¨¡å—é»˜è®¤åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹æ‰§è¡Œã€‚</p></li><li><p>ES6 æ¨¡å—ä¸å…±äº«å…¨å±€å‘½åç©ºé—´ã€‚</p></li><li><p>æ¨¡å—é¡¶çº§ this çš„å€¼æ˜¯ undefinedï¼ˆå¸¸è§„è„šæœ¬ä¸­æ˜¯ windowï¼‰ã€‚</p></li><li><p>æ¨¡å—ä¸­çš„ var å£°æ˜ä¸ä¼šæ·»åŠ åˆ° window å¯¹è±¡ã€‚</p></li><li><p>ES6 æ¨¡å—æ˜¯å¼‚æ­¥åŠ è½½å’Œæ‰§è¡Œçš„ã€‚</p></li></ul><a href=#å¯¼å‡º><h4 id=å¯¼å‡º><span class=hanchor arialabel=Anchor># </span>å¯¼å‡º</h4></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=c1>// é»˜è®¤å¯¼å‡º åªèƒ½ä¸€ä¸ª
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>export</span> <span class=k>default</span> <span class=nx>foo</span>
</span></span><span class=line><span class=cl><span class=c1>// ç­‰åŒäº
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>export</span> <span class=p>{</span> <span class=nx>foo</span> <span class=nx>as</span> <span class=k>default</span> <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=c1>// å¯¼å‡ºå¤šä¸ª
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>export</span> <span class=p>{</span> <span class=nx>foo</span><span class=p>,</span> <span class=nx>bar</span> <span class=nx>as</span> <span class=nx>myBar</span><span class=p>,</span> <span class=nx>baz</span> <span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><a href=#å¯¼å…¥><h4 id=å¯¼å…¥><span class=hanchor arialabel=Anchor># </span>å¯¼å…¥</h4></a><p>import è¯­å¥è¢«æå‡åˆ°æ¨¡å—é¡¶éƒ¨ã€‚å› æ­¤ï¼Œä¸ export å…³é”®å­—ç±»ä¼¼ï¼Œimport è¯­å¥ä¸ä½¿ç”¨å¯¼å…¥å€¼çš„è¯­å¥ çš„ç›¸å¯¹ä½ç½®å¹¶ä¸é‡è¦ã€‚ä¸è¿‡ï¼Œè¿˜æ˜¯<strong>æ¨è</strong>æŠŠå¯¼å…¥è¯­å¥<strong>æ”¾åœ¨æ¨¡å—é¡¶éƒ¨</strong>ã€‚</p><p>å¯¼å…¥å¯¹æ¨¡å—è€Œè¨€æ˜¯åªè¯»çš„ï¼Œå®é™…ä¸Šç›¸å½“äº const å£°æ˜çš„å˜é‡ã€‚åœ¨ä½¿ç”¨*æ‰§è¡Œæ‰¹é‡å¯¼å…¥æ—¶ï¼Œèµ‹å€¼ç»™åˆ«åçš„å‘½åå¯¼å‡ºå°±å¥½åƒä½¿ç”¨ <code>Object.freeze()</code>å†»ç»“è¿‡ä¸€æ ·ã€‚ç›´æ¥ä¿®æ”¹å¯¼å‡ºçš„å€¼æ˜¯ä¸å¯èƒ½çš„ï¼Œä½†<strong>å¯ä»¥ä¿®æ”¹å¯¼å‡ºå¯¹è±¡çš„å±æ€§</strong>ã€‚åŒæ ·ï¼Œä¹Ÿä¸èƒ½ç»™å¯¼å‡ºçš„é›†åˆæ·»åŠ æˆ–åˆ é™¤å¯¼å‡ºçš„å±æ€§ã€‚è¦ä¿®æ”¹å¯¼å‡ºçš„å€¼ï¼Œå¿…é¡»ä½¿ç”¨æœ‰å†…éƒ¨å˜é‡å’Œå±æ€§è®¿é—®æƒé™çš„å¯¼å‡ºæ–¹æ³•ã€‚</p><a href=#å·¥ä½œè€…æ¨¡å—><h4 id=å·¥ä½œè€…æ¨¡å—><span class=hanchor arialabel=Anchor># </span>å·¥ä½œè€…æ¨¡å—</h4></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=c1>// ä¸‹é¢æ˜¯ä¸¤ç§ç±»å‹çš„ Worker çš„å®ä¾‹åŒ–è¡Œä¸ºï¼š
</span></span></span><span class=line><span class=cl><span class=c1>// ç¬¬äºŒä¸ªå‚æ•°é»˜è®¤ä¸º{ type: &#39;classic&#39; }
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>scriptWorker</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Worker</span><span class=p>(</span><span class=s1>&#39;scriptWorker.js&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>moduleWorker</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Worker</span><span class=p>(</span><span class=s1>&#39;moduleWorker.js&#39;</span><span class=p>,</span> <span class=p>{</span> <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;module&#39;</span> <span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><a href=#å…¼å®¹æ€§><h4 id=å…¼å®¹æ€§><span class=hanchor arialabel=Anchor># </span>å…¼å®¹æ€§</h4></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=c1>// æ”¯æŒæ¨¡å—çš„æµè§ˆå™¨ä¼šæ‰§è¡Œè¿™æ®µè„šæœ¬
</span></span></span><span class=line><span class=cl><span class=c1>// ä¸æ”¯æŒæ¨¡å—çš„æµè§ˆå™¨ä¸ä¼šæ‰§è¡Œè¿™æ®µè„šæœ¬
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>&lt;</span><span class=nx>script</span> <span class=nx>type</span><span class=o>=</span><span class=s2>&#34;module&#34;</span> <span class=nx>src</span><span class=o>=</span><span class=s2>&#34;module.js&#34;</span><span class=o>&gt;&lt;</span><span class=err>/script&gt;</span>
</span></span><span class=line><span class=cl><span class=c1>// æ”¯æŒæ¨¡å—çš„æµè§ˆå™¨ä¸ä¼šæ‰§è¡Œè¿™æ®µè„šæœ¬
</span></span></span><span class=line><span class=cl><span class=c1>// ä¸æ”¯æŒæ¨¡å—çš„æµè§ˆå™¨ä¼šæ‰§è¡Œè¿™æ®µè„šæœ¬
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>&lt;</span><span class=nx>script</span> <span class=nx>nomodule</span> <span class=nx>src</span><span class=o>=</span><span class=s2>&#34;script.js&#34;</span><span class=o>&gt;&lt;</span><span class=err>/script&gt;</span>
</span></span></code></pre></td></tr></table></div></div><a href=#web-worker><h2 id=web-worker><span class=hanchor arialabel=Anchor># </span>Web Worker</h2></a><a href=#ç®€ä»‹><h3 id=ç®€ä»‹><span class=hanchor arialabel=Anchor># </span>ç®€ä»‹</h3></a><p>JavaScript ç¯å¢ƒå®é™…ä¸Šæ˜¯è¿è¡Œåœ¨æ‰˜ç®¡æ“ä½œç³»ç»Ÿä¸­çš„è™šæ‹Ÿç¯å¢ƒã€‚åœ¨æµè§ˆå™¨ä¸­æ¯æ‰“å¼€ä¸€ä¸ªé¡µé¢ï¼Œå°±ä¼šåˆ† é…ä¸€ä¸ªå®ƒè‡ªå·±çš„ç¯å¢ƒã€‚è¿™æ ·ï¼Œæ¯ä¸ªé¡µé¢éƒ½æœ‰è‡ªå·±çš„å†…å­˜ã€äº‹ä»¶å¾ªç¯ã€DOMï¼Œç­‰ç­‰ã€‚æ¯ä¸ªé¡µé¢å°±ç›¸å½“äºä¸€ä¸ª<strong>æ²™ç›’</strong>ï¼Œä¸ä¼šå¹²æ‰°å…¶ä»–é¡µé¢ã€‚å¯¹äºæµè§ˆå™¨æ¥è¯´ï¼ŒåŒæ—¶ç®¡ç†å¤šä¸ªç¯å¢ƒæ˜¯éå¸¸ç®€å•çš„ï¼Œå› ä¸ºæ‰€æœ‰è¿™äº›ç¯å¢ƒéƒ½æ˜¯<strong>å¹¶è¡Œæ‰§è¡Œ</strong>çš„ã€‚</p><a href=#workerglobalscope><h4 id=workerglobalscope><span class=hanchor arialabel=Anchor># </span>WorkerGlobalScope</h4></a><p>åœ¨ç½‘é¡µä¸Šï¼Œwindow å¯¹è±¡å¯ä»¥å‘è¿è¡Œåœ¨å…¶ä¸­çš„è„šæœ¬æš´éœ²å„ç§å…¨å±€å˜é‡ã€‚åœ¨å·¥ä½œè€…çº¿ç¨‹å†…éƒ¨ï¼Œæ²¡æœ‰ window çš„æ¦‚å¿µã€‚è¿™é‡Œçš„å…¨å±€å¯¹è±¡æ˜¯ WorkerGlobalScope çš„å®ä¾‹ï¼Œé€šè¿‡ self å…³é”®å­—æš´éœ²å‡ºæ¥ã€‚</p><a href=#ä½¿ç”¨-2><h3 id=ä½¿ç”¨-2><span class=hanchor arialabel=Anchor># </span>ä½¿ç”¨</h3></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=c1>// emptyWorker.js
</span></span></span><span class=line><span class=cl><span class=c1>// ç©ºçš„ JS å·¥ä½œè€…çº¿ç¨‹æ–‡ä»¶
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// main.js
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>location</span><span class=p>.</span><span class=nx>href</span><span class=p>);</span> <span class=c1>// &#34;https://example.com/&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>worker</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Worker</span><span class=p>(</span><span class=nx>location</span><span class=p>.</span><span class=nx>href</span> <span class=o>+</span> <span class=s1>&#39;emptyWorker.js&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>worker</span><span class=p>);</span> <span class=c1>// Worker {}
</span></span></span></code></pre></td></tr></table></div></div><a href=#å®‰å…¨é™åˆ¶><h4 id=å®‰å…¨é™åˆ¶><span class=hanchor arialabel=Anchor># </span>å®‰å…¨é™åˆ¶</h4></a><p>å·¥ä½œè€…çº¿ç¨‹çš„è„šæœ¬æ–‡ä»¶<strong>åªèƒ½ä»ä¸çˆ¶é¡µé¢ç›¸åŒçš„æºåŠ è½½</strong>ã€‚ä»å…¶ä»–æºåŠ è½½å·¥ä½œè€…çº¿ç¨‹çš„è„šæœ¬æ–‡ä»¶ä¼šå¯¼è‡´é”™è¯¯!</p><a href=#æœ€ä½³å®è·µ><h2 id=æœ€ä½³å®è·µ><span class=hanchor arialabel=Anchor># </span>æœ€ä½³å®è·µ</h2></a><p>è¯´ä»£ç â€œå¯ç»´æŠ¤â€å°±æ„å‘³ç€å®ƒå…·å¤‡å¦‚ä¸‹ç‰¹ç‚¹ã€‚</p><ul><li><strong>å®¹æ˜“ç†è§£</strong>ï¼šæ— é¡»æ±‚åŠ©åŸå§‹å¼€å‘è€…ï¼Œä»»ä½•äººä¸€çœ‹ä»£ç å°±çŸ¥é“å®ƒæ˜¯å¹²ä»€ä¹ˆçš„ï¼Œä»¥åŠå®ƒæ˜¯æ€ä¹ˆå®ç°çš„ã€‚</li><li><strong>ç¬¦åˆå¸¸è¯†</strong>ï¼šä»£ç ä¸­çš„ä¸€åˆ‡éƒ½æ˜¾å¾—é¡ºç†æˆç« ï¼Œæ— è®ºæ“ä½œæœ‰å¤šä¹ˆå¤æ‚ã€‚</li><li><strong>å®¹æ˜“é€‚é…</strong>ï¼šå³ä½¿æ•°æ®å‘ç”Ÿå˜åŒ–ä¹Ÿä¸ç”¨å®Œå…¨é‡å†™ã€‚</li><li><strong>å®¹æ˜“æ‰©å±•</strong>ï¼šä»£ç æ¶æ„ç»è¿‡è®¤çœŸè®¾è®¡ï¼Œæ”¯æŒæœªæ¥æ‰©å±•æ ¸å¿ƒåŠŸèƒ½ã€‚</li><li><strong>å®¹æ˜“è°ƒè¯•</strong>ï¼šå‡ºé—®é¢˜æ—¶ï¼Œä»£ç å¯ä»¥ç»™å‡ºæ˜ç¡®çš„ä¿¡æ¯ï¼Œé€šè¿‡å®ƒèƒ½ç›´æ¥å®šä½é—®é¢˜ã€‚</li></ul><a href=#ç¼–ç è§„èŒƒ><h3 id=ç¼–ç è§„èŒƒ><span class=hanchor arialabel=Anchor># </span>ç¼–ç è§„èŒƒ</h3></a><a href=#å¯è¯»æ€§><h4 id=å¯è¯»æ€§><span class=hanchor arialabel=Anchor># </span>å¯è¯»æ€§</h4></a><ul><li><p>ä½¿ç”¨åˆé€‚çš„ä»£ç ç¼©è¿›</p></li><li><p>å†™æ³¨é‡Š</p><ul><li>**å‡½æ•°å’Œæ–¹æ³•ï¼š**æ¯ä¸ªå‡½æ•°å’Œæ–¹æ³•éƒ½åº”è¯¥æœ‰æ³¨é‡Šæ¥æè¿°å…¶ç”¨é€”ï¼Œä»¥åŠå®Œæˆä»»åŠ¡æ‰€ç”¨çš„ç®—æ³•ã€‚</li><li>**å¤§å‹ä»£ç å—ã€‚**å¤šè¡Œä»£ç ä½†ç”¨äºå®Œæˆå•ä¸€ä»»åŠ¡çš„ï¼Œåº”è¯¥åœ¨å‰é¢ç»™å‡ºæ³¨é‡Šï¼ŒæŠŠè¦å®Œæˆçš„ä»»åŠ¡å†™æ¸…æ¥šã€‚</li><li><strong>å¤æ‚çš„ç®—æ³•</strong>: å¦‚æœä½¿ç”¨äº†ç‹¬ç‰¹çš„æ–¹æ³•è§£å†³é—®é¢˜ï¼Œè¦é€šè¿‡æ³¨é‡Šè§£é‡Šæ˜ç™½ã€‚</li><li>**ä½¿ç”¨é»‘ç§‘æŠ€ã€‚**ç”±äºæµè§ˆå™¨ä¹‹é—´çš„å·®å¼‚ï¼ŒJavaScript ä»£ç ä¸­é€šå¸¸åŒ…å«ä¸€äº›é»‘ç§‘æŠ€ã€‚</li></ul></li></ul><a href=#å˜é‡å’Œå‡½æ•°å‘½å><h4 id=å˜é‡å’Œå‡½æ•°å‘½å><span class=hanchor arialabel=Anchor># </span>å˜é‡å’Œå‡½æ•°å‘½å</h4></a><ul><li><strong>å˜é‡ååº”è¯¥æ˜¯åè¯</strong>ï¼Œä¾‹å¦‚ car æˆ– personã€‚</li><li><strong>å‡½æ•°ååº”è¯¥ä»¥åŠ¨è¯å¼€å§‹</strong>ï¼Œä¾‹å¦‚ getName()ã€‚<strong>è¿”å›å¸ƒå°”å€¼çš„å‡½æ•°é€šå¸¸ä»¥ is å¼€å¤´</strong>ï¼Œæ¯”å¦‚ isEnabled()ã€‚</li><li><strong>å˜é‡ã€å‡½æ•°å’Œæ–¹æ³•åº”è¯¥ä»¥å°å†™å­—æ¯å¼€å¤´ï¼Œä½¿ç”¨é©¼å³°å¤§å°å†™ï¼ˆcamelCaseï¼‰å½¢å¼</strong>ï¼Œå¦‚ getName()å’Œ isPersonã€‚<strong>ç±»ååº”è¯¥é¦–å­—æ¯å¤§å†™</strong>ï¼Œå¦‚ Personã€RequestFactoryã€‚<strong>å¸¸é‡å€¼åº”è¯¥å…¨éƒ¨å¤§å†™å¹¶ä»¥ ä¸‹åˆ’çº¿ç›¸æ¥</strong>ï¼Œæ¯”å¦‚ REQUEST_TIMEOUT</li><li>åç§°è¦å°½é‡ç”¨æè¿°æ€§å’Œç›´è§‚çš„è¯æ±‡</li></ul><a href=#ä½¿ç”¨å¸¸é‡><h4 id=ä½¿ç”¨å¸¸é‡><span class=hanchor arialabel=Anchor># </span>ä½¿ç”¨å¸¸é‡</h4></a><p>å…³é”®åœ¨äºæŠŠæ•°æ®ä»ä½¿ç”¨å®ƒä»¬çš„é€»è¾‘ä¸­åˆ†ç¦»å‡ºæ¥ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ ‡å‡†æ£€æŸ¥å“ªäº›æ•°æ®éœ€è¦æå–ã€‚</p><ul><li><strong>é‡å¤å‡ºç°çš„å€¼</strong>ï¼šä»»ä½•ä½¿ç”¨è¶…è¿‡ä¸€æ¬¡çš„å€¼éƒ½åº”è¯¥æå–åˆ°å¸¸é‡ä¸­ï¼Œè¿™æ ·å¯ä»¥æ¶ˆé™¤ä¸€ä¸ªå€¼æ”¹äº†è€Œå¦ä¸€ ä¸ªå€¼æ²¡æ”¹é€ æˆçš„é”™è¯¯ã€‚è¿™é‡Œä¹ŸåŒ…æ‹¬ CSS çš„ç±»åã€‚</li><li><strong>ç”¨æˆ·ç•Œé¢å­—ç¬¦ä¸²</strong>ï¼šä»»ä½•ä¼šæ˜¾ç¤ºç»™ç”¨æˆ·çš„å­—ç¬¦ä¸²éƒ½åº”è¯¥æå–å‡ºæ¥ï¼Œä»¥æ–¹ä¾¿å®ç°å›½é™…åŒ–ã€‚</li><li><strong>URL</strong>ï¼šWeb åº”ç”¨ç¨‹åºä¸­èµ„æºçš„åœ°å€ç»å¸¸ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå› æ­¤å»ºè®®æŠŠæ‰€æœ‰ URL é›†ä¸­æ”¾åœ¨ä¸€ä¸ªåœ°æ–¹ç®¡ç†ã€‚</li><li><strong>ä»»ä½•å¯èƒ½å˜åŒ–çš„å€¼</strong>ï¼šä»»ä½•æ—¶å€™ï¼Œåªè¦åœ¨ä»£ç ä¸­ä½¿ç”¨å­—é¢å€¼ï¼Œå°±é—®é—®è‡ªå·±è¿™ä¸ªå€¼å°†æ¥æ˜¯å¦å¯èƒ½ä¼šå˜ã€‚å¦‚æœç­”æ¡ˆæ˜¯â€œæ˜¯â€ï¼Œé‚£ä¹ˆå°±åº”è¯¥æŠŠå®ƒæå–åˆ°å¸¸é‡ä¸­</li></ul><a href=#æ€§èƒ½><h3 id=æ€§èƒ½><span class=hanchor arialabel=Anchor># </span>æ€§èƒ½</h3></a><a href=#ä½œç”¨åŸŸæ„è¯†><h4 id=ä½œç”¨åŸŸæ„è¯†><span class=hanchor arialabel=Anchor># </span>ä½œç”¨åŸŸæ„è¯†</h4></a><ul><li><p>é¿å…å…¨å±€æŸ¥æ‰¾</p><p><strong>åªè¦å‡½æ•°ä¸­æœ‰å¼•ç”¨è¶…è¿‡ä¸¤æ¬¡çš„å…¨å±€å¯¹è±¡ï¼Œå°±åº”è¯¥æŠŠè¿™ä¸ªå¯¹è±¡ä¿å­˜ä¸ºä¸€ä¸ªå±€éƒ¨å˜é‡ã€‚</strong></p></li><li><p>ä¸ä½¿ç”¨ with è¯­å¥</p></li></ul><a href=#é€‰æ‹©æ­£ç¡®çš„æ–¹æ³•><h4 id=é€‰æ‹©æ­£ç¡®çš„æ–¹æ³•><span class=hanchor arialabel=Anchor># </span>é€‰æ‹©æ­£ç¡®çš„æ–¹æ³•</h4></a><ol><li><p>é¿å…ä¸å¿…è¦çš„å±æ€§æŸ¥æ‰¾</p><p><strong>ä½¿ç”¨å˜é‡å’Œæ•°ç»„ç›¸æ¯”è®¿é—®å¯¹è±¡å±æ€§æ•ˆç‡æ›´é«˜</strong>ï¼Œè®¿é—®å¯¹è±¡å±æ€§çš„ç®—æ³•å¤æ‚åº¦æ˜¯ O(n)ã€‚è®¿é—®å¯¹è±¡çš„æ¯ä¸ªå±æ€§éƒ½æ¯”è®¿é—®å˜é‡æˆ–æ•°ç»„èŠ±è´¹çš„æ—¶é—´é•¿ï¼Œå› ä¸ºæŸ¥æ‰¾å±æ€§åè¦æœç´¢åŸå‹é“¾ã€‚ç®€å•æ¥è¯´ï¼ŒæŸ¥æ‰¾çš„å±æ€§è¶Šå¤šï¼Œ æ‰§è¡Œæ—¶é—´å°±è¶Šé•¿ã€‚</p></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kd>let</span> <span class=nx>query</span> <span class=o>=</span> <span class=nb>window</span><span class=p>.</span><span class=nx>location</span><span class=p>.</span><span class=nx>href</span><span class=p>.</span><span class=nx>substring</span><span class=p>(</span><span class=nb>window</span><span class=p>.</span><span class=nx>location</span><span class=p>.</span><span class=nx>href</span><span class=p>.</span><span class=nx>indexOf</span><span class=p>(</span><span class=s2>&#34;?&#34;</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=c1>//åªè¦ä½¿ç”¨æŸä¸ª object å±æ€§è¶…è¿‡ä¸€æ¬¡ï¼Œå°±åº”è¯¥å°†å…¶ä¿å­˜åœ¨å±€éƒ¨å˜é‡ä¸­ã€‚ç¬¬ä¸€æ¬¡ä»ç„¶è¦ç”¨ O(n)çš„å¤æ‚åº¦å»è®¿é—®è¿™ä¸ªå±æ€§ï¼Œä½†åç»­æ¯æ¬¡è®¿é—®å°±éƒ½æ˜¯ O(1)ï¼Œ
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>let</span> <span class=nx>url</span> <span class=o>=</span> <span class=nb>window</span><span class=p>.</span><span class=nx>location</span><span class=p>.</span><span class=nx>href</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nx>query</span> <span class=o>=</span> <span class=nx>url</span><span class=p>.</span><span class=nx>substring</span><span class=p>(</span><span class=nx>url</span><span class=p>.</span><span class=nx>indexOf</span><span class=p>(</span><span class=s2>&#34;?&#34;</span><span class=p>));</span>
</span></span></code></pre></td></tr></table></div></div><ol start=2><li><p>ä¼˜åŒ–å¾ªç¯</p><ul><li><strong>ç®€åŒ–ç»ˆæ­¢æ¡ä»¶ã€‚</strong></li><li><strong>ç®€åŒ–å¾ªç¯ä½“ã€‚</strong></li><li>**ä½¿ç”¨åæµ‹è¯•å¾ªç¯ã€‚**æœ€å¸¸è§çš„å¾ªç¯å°±æ˜¯ for å’Œ while å¾ªç¯ï¼Œè¿™ä¸¤ç§å¾ªç¯éƒ½å±äºå…ˆæµ‹è¯•å¾ªç¯ã€‚do-while å°±æ˜¯åæµ‹è¯•å¾ªç¯ï¼Œé¿å…äº†å¯¹ç»ˆæ­¢æ¡ä»¶åˆå§‹è¯„ä¼° ï¼Œå› æ­¤åº”è¯¥ä¼šæ›´å¿«ã€‚</li></ul></li><li><p>å±•å¼€å¾ªç¯</p><p>è¾¾å¤«è®¾å¤‡å®ç°ï¼Œ<strong>å±•å¼€å¾ªç¯å¯¹äºå¤§å‹æ•°æ®é›†å¯ä»¥èŠ‚çœå¾ˆå¤šæ—¶é—´ï¼Œä½†å¯¹äºå°å‹æ•°æ®é›†æ¥è¯´ï¼Œåˆ™å¯èƒ½ä¸å€¼å¾—ã€‚å› ä¸ºå®ç°åŒ æ ·çš„ä»»åŠ¡éœ€è¦å¤šå†™å¾ˆå¤šä»£ç ï¼Œæ‰€ä»¥å¦‚æœå¤„ç†çš„æ•°æ®é‡ä¸å¤§ï¼Œé‚£ä¹ˆæ˜¾ç„¶æ²¡æœ‰å¿…è¦ã€‚</strong></p></li><li><p>å…¶ä»–</p><ul><li><strong>åŸç”Ÿæ–¹æ³•å¾ˆå¿«</strong>ï¼Œåº”è¯¥å°½å¯èƒ½ä½¿ç”¨åŸç”Ÿæ–¹æ³•ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ JavaScript å†™çš„æ–¹æ³•ã€‚</li><li><strong>switch è¯­å¥å¾ˆå¿«ã€‚</strong></li><li><strong>ä½æ“ä½œå¾ˆå¿«ã€‚</strong></li></ul></li></ol><a href=#dom-ä¼˜åŒ–><h4 id=dom-ä¼˜åŒ–><span class=hanchor arialabel=Anchor># </span>DOM ä¼˜åŒ–</h4></a><ol><li><p><strong>å®æ—¶æ›´æ–°æœ€å°åŒ–</strong></p><p>**è®¿é—® DOM æ—¶ï¼Œåªè¦è®¿é—®çš„éƒ¨åˆ†æ˜¯æ˜¾ç¤ºé¡µé¢çš„ä¸€éƒ¨åˆ†ï¼Œå°±æ˜¯åœ¨æ‰§è¡Œå®æ—¶æ›´æ–°æ“ä½œã€‚**ä¹‹æ‰€ä»¥ç§°å…¶ä¸ºå®æ—¶æ›´æ–°ï¼Œæ˜¯å› ä¸ºæ¶‰åŠç«‹å³ï¼ˆå®æ—¶ï¼‰æ›´æ–°é¡µé¢çš„æ˜¾ç¤ºï¼Œè®©ç”¨æˆ·çœ‹åˆ°ã€‚æ¯æ¬¡è¿™æ ·çš„æ›´æ–°ï¼Œæ— è®ºæ˜¯æ’å…¥ä¸€ä¸ªå­—ç¬¦è¿˜æ˜¯åˆ é™¤é¡µé¢ä¸Šçš„ä¸€èŠ‚å†…å®¹ï¼Œéƒ½ä¼šå¯¼è‡´æ€§èƒ½æŸå¤±ã€‚è¿™æ˜¯å› ä¸ºæµè§ˆå™¨éœ€è¦ä¸ºæ­¤é‡æ–°è®¡ç®—æ•°åƒé¡¹æŒ‡æ ‡ï¼Œä¹‹åæ‰èƒ½æ‰§è¡Œæ›´æ–°ã€‚å®æ—¶æ›´æ–°çš„æ¬¡æ•°è¶Šå¤šï¼Œæ‰§è¡Œä»£ç æ‰€éœ€çš„æ—¶é—´ä¹Ÿè¶Šé•¿ã€‚åä¹‹ï¼Œå®æ—¶æ›´æ–°çš„æ¬¡æ•°è¶Šå°‘ï¼Œä»£ç æ‰§è¡Œå°±è¶Šå¿«</p><ul><li><p>ä»é¡µé¢ä¸­ç§»é™¤åˆ—è¡¨ï¼Œæ‰§è¡Œæ›´æ–°ï¼Œç„¶åå†æŠŠåˆ—è¡¨æ’å›é¡µé¢ä¸­ç›¸åŒçš„ä½ç½®ã€‚<strong>ä¸å¯å–ï¼Œå› ä¸ºæ¯æ¬¡æ›´æ–°æ—¶é¡µé¢éƒ½ä¼šé—ªçƒã€‚</strong></p></li><li><p>ä½¿ç”¨æ–‡æ¡£ç‰‡æ®µæ„å»º DOM ç»“æ„ï¼Œç„¶åä¸€æ¬¡æ€§å°†å®ƒæ·»åŠ åˆ° list å…ƒç´ ã€‚è¿™ä¸ªåŠæ³•å¯ä»¥å‡å°‘å®æ—¶æ›´æ–°ï¼Œä¹Ÿå¯ä»¥é¿å…é¡µé¢é—ªçƒã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=line><span class=cl><span class=kd>let</span> <span class=nx>list</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>&#34;myList&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>fragment</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>createDocumentFragment</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>  <span class=nx>item</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=p>(</span><span class=kd>let</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=mi>10</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>item</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>createElement</span><span class=p>(</span><span class=s2>&#34;li&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>fragment</span><span class=p>.</span><span class=nx>appendChild</span><span class=p>(</span><span class=nx>item</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>item</span><span class=p>.</span><span class=nx>appendChild</span><span class=p>(</span><span class=nb>document</span><span class=p>.</span><span class=nx>createTextNode</span><span class=p>(</span><span class=s2>&#34;Item &#34;</span> <span class=o>+</span> <span class=nx>i</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>list</span><span class=p>.</span><span class=nx>appendChild</span><span class=p>(</span><span class=nx>fragment</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div></li></ul></li></ol><ol start=2><li><strong>ä½¿ç”¨ innerHTML</strong></li></ol><p>åœ¨é¡µé¢ä¸­åˆ›å»ºæ–° DOM èŠ‚ç‚¹çš„æ–¹å¼æœ‰ä¸¤ç§ï¼šä½¿ç”¨ DOM æ–¹æ³•å¦‚ **createElement()**å’Œ <strong>appendChild()</strong>ï¼Œ ä»¥åŠä½¿ç”¨ <strong>innerHTML</strong>ã€‚</p><ol start=3><li><strong>ä½¿ç”¨äº‹ä»¶å§”æ‰˜</strong></li></ol><a href=#éƒ¨ç½²><h3 id=éƒ¨ç½²><span class=hanchor arialabel=Anchor># </span>éƒ¨ç½²</h3></a><a href=#es2019><h2 id=es2019><span class=hanchor arialabel=Anchor># </span>ES2019</h2></a></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>åå‘é“¾æ¥</h3><ul class=backlinks><li><a href=/%E5%89%8D%E7%AB%AF/ data-ctx=çº¢å®ä¹¦ç¬¬å››ç‰ˆ data-src=/%E5%89%8D%E7%AB%AF class=internal-link></a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>å†…éƒ¨é“¾æ¥å…³ç³»å›¾</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://note.xiaopang.fun/js/graph.abd4bc2af3869a96524d7d23b76152c7.js></script></div></div><hr><script src=https://giscus.app/client.js data-repo=chelseachen007/Obsidian data-repo-id=R_kgDOGmtZxQ data-category=Announcements data-category-id=DIC_kwDOGmtZxc4CVhTv data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=zh-CN crossorigin=anonymous async></script><center><script>var caution=!1,now,visits;function setCookie(e,t,n,s,o,a){var i=e+"="+escape(t)+(n?"; expires="+n.toGMTString():"")+(s?"; path="+s:"")+(o?"; domain="+o:"")+(a?"; secure":"");!caution||(e+"="+escape(t)).length<=4e3?document.cookie=i:confirm("Cookie exceeds 4KB and will be cut!")&&(document.cookie=i)}function getCookie(s){var e=s+"=",n,t=document.cookie.indexOf(e);return t==-1?null:(n=document.cookie.indexOf(";",t+e.length),n==-1&&(n=document.cookie.length),unescape(document.cookie.substring(t+e.length,n)))}function deleteCookie(e,t,n){getCookie(e)&&(document.cookie=e+"="+(t?"; path="+t:"")+(n?"; domain="+n:"")+"; expires=Thu, 01-Jan-70 00:00:01 GMT")}function fixDate(e){var n=new Date(0),t=n.getTime();t>0&&e.setTime(e.getTime()-t)}now=new Date,fixDate(now),now.setTime(now.getTime()+730*24*60*60*1e3),visits=getCookie("counter"),visits?visits=parseInt(visits)+1:visits=1,setCookie("counter",visits,now),document.write("<font size=2>ğŸ‘‹è®¿é—®é‡ï¼š"+visits+"")</script></center></div></body></html>